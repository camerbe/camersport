import{a as Q,b as we,c as Q_,d as z5,f as J_}from"./chunk-EQDQRRRY.js";var H5=z5((TK,ng)=>{(function(){"use strict";var sg=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},eA=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},tA=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},nA=function(e,t){return Sr(function(n,s){return e.eq(t(n),t(s))})},Sr=function(e){return{eq:e}},sA=Sr(function(e,t){return e===t}),oA=sA,og=function(e){return Sr(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},rA=function(e,t){return nA(og(e),function(n){return tA(n,t)})},rg=function(e){return Sr(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!rA(oA).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},wc=Sr(function(e,t){if(e===t)return!0;var n=sg(e),s=sg(t);return n!==s?!1:eA(n)?e===t:n==="array"?og(wc).eq(e,t):n==="object"?rg(wc).eq(e,t):!1});let aA=Object.getPrototypeOf,ag=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},iA=e=>{let t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&ag(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},kc=e=>t=>iA(t)===e,_c=e=>t=>typeof t===e,ig=e=>t=>e===t,ii=(e,t)=>ot(e)&&ag(e,t,(n,s)=>aA(n)===s),ee=kc("string"),ot=kc("object"),li=e=>ii(e,Object),Be=kc("array"),yt=ig(null),Rn=_c("boolean"),rt=ig(void 0),qe=e=>e==null,U=e=>!qe(e),_e=_c("function"),ln=_c("number"),zs=(e,t)=>{if(Be(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},ce=()=>{},Tn=(e,t)=>(...n)=>e(t.apply(null,n)),lg=(e,t)=>n=>e(t(n)),W=e=>()=>e,$t=e=>e,cg=(e,t)=>e===t;function G(e,...t){return(...n)=>{let s=t.concat(n);return e.apply(null,s)}}let wr=e=>t=>!e(t),ug=e=>()=>{throw new Error(e)},Ac=e=>e(),kr=e=>{e()},Oe=W(!1),He=W(!0);class m{constructor(t,n){this.tag=t,this.value=n}static some(t){return new m(!0,t)}static none(){return m.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?m.some(t(this.value)):m.none()}bind(t){return this.tag?t(this.value):m.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:m.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return U(t)?m.some(t):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);let xc=Array.prototype.slice,lA=Array.prototype.indexOf,cA=Array.prototype.push,fg=(e,t)=>lA.call(e,t),uA=(e,t)=>{let n=fg(e,t);return n===-1?m.none():m.some(n)},ke=(e,t)=>fg(e,t)>-1,Ie=(e,t)=>{for(let n=0,s=e.length;n<s;n++){let o=e[n];if(t(o,n))return!0}return!1},be=(e,t)=>{let n=e.length,s=new Array(n);for(let o=0;o<n;o++){let r=e[o];s[o]=t(r,o)}return s},D=(e,t)=>{for(let n=0,s=e.length;n<s;n++){let o=e[n];t(o,n)}},dg=(e,t)=>{for(let n=e.length-1;n>=0;n--){let s=e[n];t(s,n)}},_o=(e,t)=>{let n=[],s=[];for(let o=0,r=e.length;o<r;o++){let a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},se=(e,t)=>{let n=[];for(let s=0,o=e.length;s<o;s++){let r=e[s];t(r,s)&&n.push(r)}return n},_r=(e,t,n)=>(dg(e,(s,o)=>{n=t(n,s,o)}),n),Pt=(e,t,n)=>(D(e,(s,o)=>{n=t(n,s,o)}),n),mg=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){let r=e[s];if(t(r,s))return m.some(r);if(n(r,s))break}return m.none()},Ze=(e,t)=>mg(e,t,Oe),Ar=(e,t)=>{for(let n=0,s=e.length;n<s;n++){let o=e[n];if(t(o,n))return m.some(n)}return m.none()},gg=e=>{let t=[];for(let n=0,s=e.length;n<s;++n){if(!Be(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);cA.apply(t,e[n])}return t},Yt=(e,t)=>gg(be(e,t)),Qn=(e,t)=>{for(let n=0,s=e.length;n<s;++n){let o=e[n];if(t(o,n)!==!0)return!1}return!0},xr=e=>{let t=xc.call(e,0);return t.reverse(),t},ci=(e,t)=>se(e,n=>!ke(t,n)),Nc=(e,t)=>{let n={};for(let s=0,o=e.length;s<o;s++){let r=e[s];n[String(r)]=t(r,s)}return n},Hs=(e,t)=>{let n=xc.call(e,0);return n.sort(t),n},Nr=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),xt=e=>Nr(e,0),ps=e=>Nr(e,e.length-1),Mt=_e(Array.from)?Array.from:e=>xc.call(e),Ao=(e,t)=>{for(let n=0;n<e.length;n++){let s=t(e[n],n);if(s.isSome())return s}return m.none()},pg=(e,t)=>{let n=[],s=_e(t)?o=>Ie(n,r=>t(r,o)):o=>ke(n,o);for(let o=0,r=e.length;o<r;o++){let a=e[o];s(a)||n.push(a)}return n},Ut=Object.keys,fA=Object.hasOwnProperty,Ne=(e,t)=>{let n=Ut(e);for(let s=0,o=n.length;s<o;s++){let r=n[s],a=e[r];t(a,r)}},ui=(e,t)=>dA(e,(n,s)=>({k:s,v:t(n,s)})),dA=(e,t)=>{let n={};return Ne(e,(s,o)=>{let r=t(s,o);n[r.k]=r.v}),n},Rc=e=>(t,n)=>{e[n]=t},hg=(e,t,n,s)=>{Ne(e,(o,r)=>{(t(o,r)?n:s)(o,r)})},mA=(e,t)=>{let n={},s={};return hg(e,t,Rc(n),Rc(s)),{t:n,f:s}},Rr=(e,t)=>{let n={};return hg(e,t,Rc(n),ce),n},fi=(e,t)=>{let n=[];return Ne(e,(s,o)=>{n.push(t(s,o))}),n},Tc=e=>fi(e,$t),Fe=(e,t)=>oe(e,t)?m.from(e[t]):m.none(),oe=(e,t)=>fA.call(e,t),xo=(e,t)=>oe(e,t)&&e[t]!==void 0&&e[t]!==null,gA=(e,t,n=wc)=>rg(n).eq(e,t),Dn={generate:e=>{if(!Be(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");let t=[],n={};return D(e,(s,o)=>{let r=Ut(s);if(r.length!==1)throw new Error("one and only one name per case");let a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Be(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{let c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...f)=>{if(f.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+f.length);return f[o].apply(null,l)},match:f=>{let d=Ut(f);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!Qn(t,h=>ke(d,h)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return f[a].apply(null,l)},log:f=>{console.log(f,{constructors:t,constructor:a,params:l})}}}}),n}},nt=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},bg=e=>{let t=r=>r(e),n=W(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:He,isError:Oe,map:r=>zt.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>m.some(e)};return o},Cg=e=>{let t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:Oe,isError:He,map:t,mapError:s=>zt.error(s(e)),bind:t,exists:Oe,forall:He,getOr:$t,or:$t,getOrThunk:Ac,orThunk:Ac,getOrDie:ug(String(e)),each:ce,toOptional:m.none};return n},zt={value:bg,error:Cg,fromOption:(e,t)=>e.fold(()=>Cg(t),bg)},pA=typeof window<"u"?window:Function("return this;")(),hA=(e,t,n)=>Math.min(Math.max(e,t),n),yg=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295,vg=0,Tr=e=>{let n=new Date().getTime(),s=Math.floor(yg()*1e9);return vg++,e+"_"+s+vg+String(n)},bA=(e,t)=>t,CA=(e,t)=>li(e)&&li(t)?di(e,t):t,Eg=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");let n={};for(let s=0;s<t.length;s++){let o=t[s];for(let r in o)oe(o,r)&&(n[r]=e(n[r],o[r]))}return n},di=Eg(CA),Sg=Eg(bA),No=(e,t,n=cg)=>e.exists(s=>n(s,t)),wg=(e,t,n=cg)=>ct(e,t,n).getOr(e.isNone()&&t.isNone()),yA=e=>{let t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},ct=(e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none(),vA=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?m.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):m.none(),Ro=(e,t)=>e?m.some(t):m.none(),EA=(e,t)=>{let n=t??pA;for(let s=0;s<e.length&&n!==void 0&&n!==null;++s)n=n[e[s]];return n},kg=(e,t)=>{let n=e.split(".");return EA(n,t)};Dn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let SA=e=>{let t=[],n=[];return D(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},wA=e=>{let t=nt(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(i))}}},kA=e=>{let t=nt(m.none()),n=()=>t.get().each(i=>clearInterval(i));return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(setInterval(i,e)))}}},Jn=()=>{let e=wA(ce),t=n=>e.get().each(n);return we(Q({},e),{on:t})},_A=(e,t)=>e.substring(t),_g=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,Ag=(e,t)=>Qe(e,t)?_A(e,t.length):e,ft=(e,t,n=0,s)=>{let o=e.indexOf(t,n);return o!==-1?rt(s)?!0:o+t.length<=s:!1},Qe=(e,t)=>_g(e,t,0),Dc=(e,t)=>_g(e,t,e.length-t.length),Pc=e=>t=>t.replace(e,""),To=Pc(/^\s+|\s+$/g),AA=Pc(/^\s+/g),xg=Pc(/\s+$/g),Pn=e=>e.length>0,Dr=e=>!Pn(e),xA=(e,t)=>t<=0?"":new Array(t+1).join(e),mi=(e,t=10)=>{let n=parseInt(e,t);return isNaN(n)?m.none():m.some(n)},gi=(e,t)=>{let n=null;return{cancel:()=>{yt(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{yt(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},Bc=(e,t)=>{let n=null,s=()=>{yt(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},Bn=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},Pr="\uFEFF",Je="\xA0",Oc=e=>e===Pr,NA=e=>e.replace(/\uFEFF/g,""),Ng=e=>{let t={};return D(e,n=>{t[n]={}}),Ut(t)},Rg=e=>e.length!==void 0,Ic=Array.isArray,RA=e=>{if(Ic(e))return e;{let t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},pi=(e,t,n)=>{if(!e)return!1;if(n=n||e,Rg(e)){for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(let s in e)if(oe(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},Fc=(e,t)=>{let n=[];return pi(e,(s,o)=>{n.push(t(s,o,e))}),n},Br=(e,t)=>{let n=[];return pi(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},TA=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},hi=(e,t,n,s)=>{let o=rt(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},Tg=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},Ws=e=>e[e.length-1],DA=(e,t,n,s)=>{let o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),l=o||!r&&a&&s("(min-device-width:768px)"),c=r||a&&!l,u=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,f=!c&&!l&&!u;return{isiPad:W(o),isiPhone:W(r),isTablet:W(l),isPhone:W(c),isTouch:W(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:W(u),isDesktop:W(f)}},PA=(e,t)=>{for(let n=0;n<e.length;n++){let s=e[n];if(s.test(t))return s}},BA=(e,t)=>{let n=PA(e,t);if(!n)return{major:0,minor:0};let s=o=>Number(t.replace(n,"$"+o));return Lc(s(1),s(2))},OA=(e,t)=>{let n=String(t).toLowerCase();return e.length===0?Dg():BA(e,n)},Dg=()=>Lc(0,0),Lc=(e,t)=>({major:e,minor:t}),Or={nu:Lc,detect:OA,unknown:Dg},IA=(e,t)=>Ao(t.brands,n=>{let s=n.brand.toLowerCase();return Ze(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:Or.nu(parseInt(n.version,10),0)}))}),Pg=(e,t)=>{let n=String(t).toLowerCase();return Ze(e,s=>s.search(n))},FA=(e,t)=>Pg(e,t).map(n=>{let s=Or.detect(n.versionRegexes,t);return{current:n.name,version:s}}),LA=(e,t)=>Pg(e,t).map(n=>{let s=Or.detect(n.versionRegexes,t);return{current:n.name,version:s}}),$c=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,es=e=>t=>ft(t,e),$A=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>ft(e,"edge/")&&ft(e,"chrome")&&ft(e,"safari")&&ft(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,$c],search:e=>ft(e,"chrome")&&!ft(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>ft(e,"msie")||ft(e,"trident")},{name:"Opera",versionRegexes:[$c,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:es("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:es("firefox")},{name:"Safari",versionRegexes:[$c,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(ft(e,"safari")||ft(e,"mobile/"))&&ft(e,"applewebkit")}],MA=[{name:"Windows",search:es("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>ft(e,"iphone")||ft(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:es("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:es("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:es("linux"),versionRegexes:[]},{name:"Solaris",search:es("sunos"),versionRegexes:[]},{name:"FreeBSD",search:es("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:es("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Bg={browsers:W($A),oses:W(MA)},Og="Edge",Ig="Chromium",Fg="IE",Lg="Opera",$g="Firefox",Mg="Safari",UA=()=>Ug({current:void 0,version:Or.unknown()}),Ug=e=>{let t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(Og),isChromium:s(Ig),isIE:s(Fg),isOpera:s(Lg),isFirefox:s($g),isSafari:s(Mg)}},zg={unknown:UA,nu:Ug,edge:W(Og),chromium:W(Ig),ie:W(Fg),opera:W(Lg),firefox:W($g),safari:W(Mg)},Hg="Windows",Wg="iOS",Vg="Android",jg="Linux",qg="macOS",Kg="Solaris",Gg="FreeBSD",Yg="ChromeOS",zA=()=>Xg({current:void 0,version:Or.unknown()}),Xg=e=>{let t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(Hg),isiOS:s(Wg),isAndroid:s(Vg),isMacOS:s(qg),isLinux:s(jg),isSolaris:s(Kg),isFreeBSD:s(Gg),isChromeOS:s(Yg)}},Zg={unknown:zA,nu:Xg,windows:W(Hg),ios:W(Wg),android:W(Vg),linux:W(jg),macos:W(qg),solaris:W(Kg),freebsd:W(Gg),chromeos:W(Yg)},HA={detect:(e,t,n)=>{let s=Bg.browsers(),o=Bg.oses(),r=t.bind(l=>IA(s,l)).orThunk(()=>FA(s,e)).fold(zg.unknown,zg.nu),a=LA(o,e).fold(Zg.unknown,Zg.nu),i=DA(a,r,e,n);return{browser:r,os:a,deviceType:i}}},WA=e=>window.matchMedia(e).matches,VA=Bn(()=>HA.detect(window.navigator.userAgent,m.from(window.navigator.userAgentData),WA)),bn=()=>VA(),jA=(e,t)=>kg(e,t),qA=(e,t)=>{let n=jA(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},KA=Object.getPrototypeOf,GA=e=>qA("HTMLElement",e),YA=e=>{let t=kg("ownerDocument.defaultView",e);return ot(e)&&(GA(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(KA(e).constructor.name))},XA=window.navigator.userAgent,Mc=bn(),On=Mc.browser,In=Mc.os,Vs=Mc.deviceType,ZA=XA.indexOf("Windows Phone")!==-1,ye={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:On.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!On.isIE(),windowsPhone:ZA,browser:{current:On.current,version:On.version,isChromium:On.isChromium,isEdge:On.isEdge,isFirefox:On.isFirefox,isIE:On.isIE,isOpera:On.isOpera,isSafari:On.isSafari},os:{current:In.current,version:In.version,isAndroid:In.isAndroid,isChromeOS:In.isChromeOS,isFreeBSD:In.isFreeBSD,isiOS:In.isiOS,isLinux:In.isLinux,isMacOS:In.isMacOS,isSolaris:In.isSolaris,isWindows:In.isWindows},deviceType:{isDesktop:Vs.isDesktop,isiPad:Vs.isiPad,isiPhone:Vs.isiPhone,isPhone:Vs.isPhone,isTablet:Vs.isTablet,isTouch:Vs.isTouch,isWebView:Vs.isWebView}},QA=/^\s*|\s*$/g,Qg=e=>qe(e)?"":(""+e).replace(QA,""),JA=(e,t)=>t?t==="array"&&Ic(e)?!0:typeof e===t:e!==void 0,ex=(e,t,n={})=>{let s=ee(e)?e.split(t||","):e||[],o=s.length;for(;o--;)n[s[o]]={};return n},tx=oe,nx=(e,...t)=>{for(let n=0;n<t.length;n++){let s=t[n];for(let o in s)if(oe(s,o)){let r=s[o];r!==void 0&&(e[o]=r)}}return e},Jg=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),pi(e,(o,r)=>t.call(s,o,r,n)===!1?!1:(Jg(o,t,n,s),!0)))},L={trim:Qg,isArray:Ic,is:JA,toArray:RA,makeMap:ex,each:pi,map:Fc,grep:Br,inArray:TA,hasOwn:tx,extend:nx,walk:Jg,resolve:(e,t=window)=>{let n=e.split(".");for(let s=0,o=n.length;s<o&&(t=t[n[s]],!!t);s++);return t},explode:(e,t)=>Be(e)?e:e===""?[]:Fc(e.split(t||","),Qg),_addCacheSuffix:e=>{let t=ye.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},sx=(e,t)=>{let s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){let o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return Ir(s.childNodes[0])},ox=(e,t)=>{let s=(t||document).createElement(e);return Ir(s)},rx=(e,t)=>{let s=(t||document).createTextNode(e);return Ir(s)},Ir=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},C={fromHtml:sx,fromTag:ox,fromText:rx,fromDom:Ir,fromPoint:(e,t,n)=>m.from(e.dom.elementFromPoint(t,n)).map(Ir)},ax=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},ix=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},ep=(e,t,n)=>{let s=e.document.createRange();return ax(s,t),ix(s,n),s},Uc=(e,t,n,s,o)=>{let r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},Fr=Dn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),tp=(e,t,n)=>t(C.fromDom(n.startContainer),n.startOffset,C.fromDom(n.endContainer),n.endOffset),lx=(e,t)=>t.match({domRange:n=>({ltr:W(n),rtl:m.none}),relative:(n,s)=>({ltr:Bn(()=>ep(e,n,s)),rtl:Bn(()=>m.some(ep(e,s,n)))}),exact:(n,s,o,r)=>({ltr:Bn(()=>Uc(e,n,s,o,r)),rtl:Bn(()=>m.some(Uc(e,o,r,n,s)))})}),cx=(e,t)=>{let n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>Fr.rtl(C.fromDom(o.endContainer),o.endOffset,C.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>tp(e,Fr.ltr,n)):tp(e,Fr.ltr,n)},ux=(e,t)=>{let n=lx(e,t);return cx(e,n)};Fr.ltr,Fr.rtl;let bi=8,np=9,sp=11,Lr=1,op=3,Cn=(e,t)=>{let n=e.dom;if(n.nodeType!==Lr)return!1;{let s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},rp=e=>e.nodeType!==Lr&&e.nodeType!==np&&e.nodeType!==sp||e.childElementCount===0,fx=(e,t)=>{let n=t===void 0?document:t.dom;return rp(n)?[]:be(n.querySelectorAll(e),C.fromDom)},dx=(e,t)=>{let n=t===void 0?document:t.dom;return rp(n)?m.none():m.from(n.querySelector(e)).map(C.fromDom)},Se=(e,t)=>e.dom===t.dom,yn=(e,t)=>{let n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},ap=(e,t)=>{let n=[],s=r=>(n.push(r),t(r)),o=t(e);do o=o.bind(s);while(o.isSome());return n},Ce=e=>e.dom.nodeName.toLowerCase(),ip=e=>e.dom.nodeType,Ci=e=>t=>ip(t)===e,mx=e=>ip(e)===bi||Ce(e)==="#comment",$r=e=>Ht(e)&&YA(e.dom),Ht=Ci(Lr),Nt=Ci(op),gx=Ci(np),px=Ci(sp),Mr=e=>t=>Ht(t)&&Ce(t)===e,lp=e=>C.fromDom(e.dom.ownerDocument),hs=e=>gx(e)?e:lp(e),hx=e=>C.fromDom(hs(e).dom.documentElement),Ur=e=>C.fromDom(hs(e).dom.defaultView),Fn=e=>m.from(e.dom.parentNode).map(C.fromDom),zr=e=>m.from(e.dom.parentElement).map(C.fromDom),cp=(e,t)=>{let n=_e(t)?t:Oe,s=e.dom,o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){let r=s.parentNode,a=C.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},bx=e=>{let t=n=>se(n,s=>!Se(e,s));return Fn(e).map(dt).map(t).getOr([])},bs=e=>m.from(e.dom.previousSibling).map(C.fromDom),Hr=e=>m.from(e.dom.nextSibling).map(C.fromDom),up=e=>xr(ap(e,bs)),fp=e=>ap(e,Hr),dt=e=>be(e.dom.childNodes,C.fromDom),Do=(e,t)=>{let n=e.dom.childNodes;return m.from(n[t]).map(C.fromDom)},zc=e=>Do(e,0),Hc=e=>Do(e,e.dom.childNodes.length-1),Wc=e=>e.dom.childNodes.length,Cx=e=>{let t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return C.fromDom(t)},Vc=e=>px(e)&&U(e.dom.host),Cs=e=>C.fromDom(e.dom.getRootNode()),jc=e=>Vc(e)?e:Cx(hs(e)),yx=e=>Vc(e)?e:C.fromDom(hs(e).dom.body),vx=e=>{let t=Cs(e);return Vc(t)?m.some(t):m.none()},Ex=e=>C.fromDom(e.dom.host),dp=e=>{if(U(e.target)){let t=C.fromDom(e.target);if(Ht(t)&&Sx(t)&&e.composed&&e.composedPath){let n=e.composedPath();if(n)return xt(n)}}return m.from(e.target)},Sx=e=>U(e.dom.shadowRoot),wx=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),kx=e=>{let t=C.fromDom(dp(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=Tn(s,n);return wx(t,e.clientX,e.clientY,n,s,o,e)},_x=(e,t)=>n=>{e(n)&&t(kx(n))},Ax=(e,t,n,s,o)=>{let r=_x(n,s);return e.dom.addEventListener(t,r,o),{unbind:G(Nx,e,t,r,o)}},xx=(e,t,n,s)=>Ax(e,t,n,s,!1),Nx=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},Rx=He,Tx=(e,t,n)=>xx(e,t,Rx,n),mp=()=>C.fromDom(document),gp=(e,t=!1)=>e.dom.focus({preventScroll:t}),pp=e=>{let t=Cs(e).dom;return e.dom===t.activeElement},qc=(e=mp())=>m.from(e.dom.activeElement).map(C.fromDom),Dx=e=>qc(Cs(e)).filter(t=>e.dom.contains(t.dom)),Bt=(e,t)=>{Fn(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},ts=(e,t)=>{Hr(e).fold(()=>{Fn(e).each(o=>{Ke(o,t)})},s=>{Bt(s,t)})},Kc=(e,t)=>{zc(e).fold(()=>{Ke(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},Ke=(e,t)=>{e.dom.appendChild(t.dom)},hp=(e,t)=>{Bt(e,t),Ke(t,e)},Px=(e,t)=>{D(t,(n,s)=>{let o=s===0?e:t[s-1];ts(o,n)})},js=(e,t)=>{D(t,n=>{Ke(e,n)})},bp=(e,t,n)=>{if(ee(n)||Rn(n)||ln(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},at=(e,t,n)=>{bp(e.dom,t,n)},ns=(e,t)=>{let n=e.dom;Ne(t,(s,o)=>{bp(n,o,s)})},Wt=(e,t)=>{let n=e.dom.getAttribute(t);return n===null?void 0:n},ss=(e,t)=>m.from(Wt(e,t)),Wr=(e,t)=>{let n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},it=(e,t)=>{e.dom.removeAttribute(t)},Bx=e=>{let t=e.dom.attributes;return t==null||t.length===0},Cp=e=>Pt(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Po=e=>{e.dom.textContent="",D(dt(e),t=>{Te(t)})},Te=e=>{let t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},ys=e=>{let t=dt(e);t.length>0&&Px(e,t),Te(e)},yp=(e,t)=>C.fromDom(e.dom.cloneNode(t)),qs=e=>yp(e,!1),vp=e=>yp(e,!0),Ox=(e,t)=>{let n=C.fromTag(t),s=Cp(e);return ns(n,s),n},Ix=(e,t)=>{let n=Ox(e,t);ts(e,n);let s=dt(e);return js(n,s),Te(e),n},Fx=(e,t)=>{let s=(t||document).createElement("div");return s.innerHTML=e,dt(C.fromDom(s))},Gc=e=>be(e,C.fromDom),Ep=e=>e.dom.innerHTML,yi=(e,t)=>{let s=lp(e).dom,o=C.fromDom(s.createDocumentFragment()),r=Fx(t,s);js(o,r),Po(e),Ke(e,o)},Lx=e=>{let t=C.fromTag("div"),n=C.fromDom(e.dom.cloneNode(!0));return Ke(t,n),Ep(t)},Vr=e=>e.style!==void 0&&_e(e.style.getPropertyValue),Bo=e=>{let t=Nt(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;let n=t.ownerDocument;return vx(C.fromDom(t)).fold(()=>n.body.contains(t),lg(Bo,Ex))},Sp=(e,t,n)=>{if(!ee(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Vr(e)&&e.style.setProperty(t,n)},$x=(e,t)=>{Vr(e)&&e.style.removeProperty(t)},wp=(e,t,n)=>{let s=e.dom;Sp(s,t,n)},vi=(e,t)=>{let n=e.dom;Ne(t,(s,o)=>{Sp(n,o,s)})},Ln=(e,t)=>{let n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!Bo(e)?kp(n,t):o},kp=(e,t)=>Vr(e)?e.style.getPropertyValue(t):"",Ei=(e,t)=>{let n=e.dom,s=kp(n,t);return m.from(s).filter(o=>o.length>0)},Yc=e=>{let t={},n=e.dom;if(Vr(n))for(let s=0;s<n.style.length;s++){let o=n.style.item(s);t[o]=n.style[o]}return t},_p=(e,t)=>{let n=e.dom;$x(n,t),No(ss(e,"style").map(To),"")&&it(e,"style")},Mx=e=>e.dom.offsetWidth,Ux=((e,t)=>{let n=(i,l)=>{if(!ln(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);let c=i.dom;Vr(c)&&(c.style[e]=l+"px")},s=i=>{let l=t(i);if(l<=0||l===null){let c=Ln(i,e);return parseFloat(c)||0}return l},o=s,r=(i,l)=>Pt(l,(c,u)=>{let f=Ln(i,u),d=f===void 0?0:parseInt(f,10);return isNaN(d)?c:c+d},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,l,c)=>{let u=r(i,c);return l>u?l-u:0}}})("height",e=>{let t=e.dom;return Bo(e)?t.getBoundingClientRect().height:t.offsetHeight}),zx=e=>Ux.get(e),Ap=(e,t)=>({left:e,top:t,translate:(s,o)=>Ap(e+s,t+o)}),Oo=Ap,Hx=e=>{let t=e.getBoundingClientRect();return Oo(t.left,t.top)},Si=(e,t)=>e!==void 0?e:t!==void 0?t:0,Wx=e=>{let t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return Oo(n.offsetLeft,n.offsetTop);let r=Si(s?.pageYOffset,o.scrollTop),a=Si(s?.pageXOffset,o.scrollLeft),i=Si(o.clientTop,n.clientTop),l=Si(o.clientLeft,n.clientLeft);return Xc(e).translate(a-l,r-i)},Xc=e=>{let t=e.dom,s=t.ownerDocument.body;return s===t?Oo(s.offsetLeft,s.offsetTop):Bo(e)?Hx(t):Oo(0,0)},Zc=e=>{let t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Oo(n,s)},xp=(e,t,n)=>{let o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},Np=(e,t)=>{bn().browser.isSafari()&&_e(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},Vx=(e,t)=>{let n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?m.from(r.dom.nodeValue):m.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}},Qc=(e,t)=>{let s=(t||document).createDocumentFragment();return D(e,o=>{s.appendChild(o.dom)}),C.fromDom(s)},Jc=Vx(Nt,"text"),jr=e=>Jc.get(e),jx=e=>Jc.getOption(e),Rp=(e,t)=>Jc.set(e,t),eu=(e,t)=>{let n=Wt(e,t);return n===void 0||n===""?[]:n.split(" ")},qx=(e,t,n)=>{let o=eu(e,t).concat([n]);return at(e,t,o.join(" ")),!0},Kx=(e,t,n)=>{let s=se(eu(e,t),o=>o!==n);return s.length>0?at(e,t,s.join(" ")):it(e,t),!1};var Tp=(e,t,n,s,o)=>e(n,s)?m.some(n):_e(o)&&o(n)?m.none():t(n,s,o);let os=(e,t,n)=>{let s=e.dom,o=_e(n)?n:Oe;for(;s.parentNode;){s=s.parentNode;let r=C.fromDom(s);if(t(r))return m.some(r);if(o(r))break}return m.none()},vs=(e,t,n)=>Tp((o,r)=>r(o),os,e,t,n),Gx=(e,t)=>{let n=e.dom;return n.parentNode?Yx(C.fromDom(n.parentNode),s=>!Se(e,s)&&t(s)):m.none()},Yx=(e,t)=>{let n=o=>t(C.fromDom(o));return Ze(e.dom.childNodes,n).map(C.fromDom)},tu=(e,t)=>{let n=s=>{for(let o=0;o<s.childNodes.length;o++){let r=C.fromDom(s.childNodes[o]);if(t(r))return m.some(r);let a=n(s.childNodes[o]);if(a.isSome())return a}return m.none()};return n(e.dom)},qr=(e,t,n)=>os(e,s=>Cn(s,t),n),wi=(e,t)=>dx(t,e),Io=(e,t,n)=>Tp((o,r)=>Cn(o,r),qr,e,t,n),Kr=e=>e.dom.classList!==void 0,Dp=e=>eu(e,"class"),Pp=(e,t)=>qx(e,"class",t),Bp=(e,t)=>Kx(e,"class",t),Xx=(e,t)=>ke(Dp(e),t)?Bp(e,t):Pp(e,t),Fo=(e,t)=>{Kr(e)?e.dom.classList.add(t):Pp(e,t)},Op=e=>{(Kr(e)?e.dom.classList:Dp(e)).length===0&&it(e,"class")},Gr=(e,t)=>{Kr(e)?e.dom.classList.remove(t):Bp(e,t),Op(e)},Zx=(e,t)=>{let n=Kr(e)?e.dom.classList.toggle(t):Xx(e,t);return Op(e),n},nu=(e,t)=>Kr(e)&&e.dom.classList.contains(t),Qx=(e,t)=>{D(t,n=>{Fo(e,n)})},Jx=(e,t)=>{D(t,n=>{Gr(e,n)})},eN=e=>Io(e,"[contenteditable]"),Es=(e,t=!1)=>Bo(e)?e.dom.isContentEditable:eN(e).fold(W(t),n=>tN(n)==="true"),tN=e=>e.dom.contentEditable,ki=(e,t)=>{e.dom.contentEditable=t?"true":"false"},nN=(e,t)=>se(dt(e),t),Ip=(e,t)=>{let n=[];return D(dt(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(Ip(s,t))}),n},mt=(e,t)=>fx(t,e),Fp=(e,t,n)=>os(e,t,n).isSome(),sN=(e,t)=>Gx(e,t).isSome(),su=(e,t)=>tu(e,t).isSome(),oN=(e,t,n)=>qr(e,t,n).isSome(),Lp=e=>_e(e)?e:Oe,rN=(e,t,n)=>{let s=e.dom,o=Lp(n);for(;s.parentNode;){s=s.parentNode;let r=C.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return m.none()},ou=(e,t,n)=>{let s=t(e),o=Lp(n);return s.orThunk(()=>o(e)?m.none():rN(e,t,o))},aN=e=>jx(e).filter(t=>t.trim().length!==0||t.indexOf(Je)>-1).isSome(),iN=e=>$r(e)&&Wt(e,"contenteditable")==="false",lN=["img","br"],cN=e=>aN(e)||ke(lN,Ce(e))||iN(e),uN=e=>tu(e,cN),$p={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},ru=Dn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),fN=(e,t,n,s)=>e.fold(t,n,s),dN=e=>e.fold($t,$t,$t),mN=ru.before,gN=ru.on,pN=ru.after,rs={before:mN,on:gN,after:pN,cata:fN,getStart:dN},_i=Dn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),hN=e=>_i.exact(e.start,e.soffset,e.finish,e.foffset),bN=e=>e.match({domRange:t=>C.fromDom(t.startContainer),relative:(t,n)=>rs.getStart(t),exact:(t,n,s,o)=>t}),CN=_i.domRange,yN=_i.relative,vN=_i.exact,EN=e=>{let t=bN(e);return Ur(t)},SN=$p.create,Lo={domRange:CN,relative:yN,exact:vN,exactFromRange:hN,getWin:EN,range:SN},wN=(e,t,n)=>{var s;return m.from((s=e.caretPositionFromPoint)===null||s===void 0?void 0:s.call(e,t,n)).bind(o=>{if(o.offsetNode===null)return m.none();let r=e.createRange();return r.setStart(o.offsetNode,o.offset),r.collapse(),m.some(r)})},kN=(e,t,n)=>{var s;return m.from((s=e.caretRangeFromPoint)===null||s===void 0?void 0:s.call(e,t,n))},_N=(e,t,n)=>e.caretPositionFromPoint?wN(e,t,n):e.caretRangeFromPoint?kN(e,t,n):m.none(),AN=(e,t,n)=>{let s=e.document;return _N(s,t,n).map(o=>$p.create(C.fromDom(o.startContainer),o.startOffset,C.fromDom(o.endContainer),o.endOffset))},Ai=(e,t)=>{let n=Ce(e);return n==="input"?rs.after(e):ke(["br","img"],n)?t===0?rs.before(e):rs.after(e):rs.on(e,t)},xN=(e,t)=>{let n=e.fold(rs.before,Ai,rs.after),s=t.fold(rs.before,Ai,rs.after);return Lo.relative(n,s)},Mp=(e,t,n,s)=>{let o=Ai(e,t),r=Ai(n,s);return Lo.relative(o,r)},NN=e=>e.match({domRange:t=>{let n=C.fromDom(t.startContainer),s=C.fromDom(t.endContainer);return Mp(n,t.startOffset,s,t.endOffset)},relative:xN,exact:Mp}),RN=e=>{let t=Lo.getWin(e).dom,n=(o,r,a,i)=>Uc(t,o,r,a,i),s=NN(e);return ux(t,s).match({ltr:n,rtl:n})},TN=(e,t,n)=>AN(e,t,n),DN=e=>{let t=e===void 0?window:e;return bn().browser.isFirefox()?m.none():m.from(t.visualViewport)},Up=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),au=e=>{let t=e===void 0?window:e,n=t.document,s=Zc(C.fromDom(n));return DN(t).fold(()=>{let o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return Up(s.left,s.top,r,a)},o=>Up(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))};class st{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){let r=t[s];if(r)return r;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){if(t){let s=t.previousSibling;if(this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(let r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}let o=t.parentNode;if(o&&o!==this.rootNode)return o}}}let PN=/^[ \t\r\n]*$/,$o=e=>PN.test(e),BN=e=>{for(let t of e)if(!Oc(t))return!1;return!0},ON=e=>" \f	\v".indexOf(e)!==-1,zp=e=>e===`
`||e==="\r",IN=(e,t)=>t<e.length&&t>=0?zp(e[t]):!1,Hp=(e,t=4,n=!0,s=!0)=>{let o=xA(" ",t),r=e.replace(/\t/g,o);return Pt(r,(i,l)=>ON(l)||l===Je?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||IN(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+Je}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:zp(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},Ks=e=>t=>!!t&&t.nodeType===e,xi=e=>!!e&&!Object.getPrototypeOf(e),q=Ks(1),$n=e=>q(e)&&$r(C.fromDom(e)),FN=e=>q(e)&&e.namespaceURI==="http://www.w3.org/2000/svg",Mo=e=>{let t=e.toLowerCase();return n=>U(n)&&n.nodeName.toLowerCase()===t},vn=e=>{let t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){let s=n.nodeName.toLowerCase();return ke(t,s)}return!1}},Ni=(e,t)=>{let n=t.toLowerCase().split(" ");return s=>{if(q(s)){let o=s.ownerDocument.defaultView;if(o)for(let r=0;r<n.length;r++){let a=o.getComputedStyle(s,null);if((a?a.getPropertyValue(e):null)===n[r])return!0}}return!1}},LN=e=>t=>q(t)&&t.hasAttribute(e),Gs=e=>q(e)&&e.hasAttribute("data-mce-bogus"),$N=e=>q(e)&&e.getAttribute("data-mce-bogus")==="all",Mn=e=>q(e)&&e.tagName==="TABLE",Wp=e=>t=>!!($n(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),iu=vn(["textarea","input"]),F=Ks(3),MN=Ks(4),UN=Ks(7),Ss=Ks(8),Yr=Ks(9),lu=Ks(11),Le=Mo("br"),Vp=Mo("img"),zN=Mo("a"),cn=Wp("true"),Re=Wp("false"),cu=e=>$n(e)&&e.isContentEditable&&U(e.parentElement)&&!e.parentElement.isContentEditable,Ri=vn(["td","th"]),HN=vn(["td","th","caption"]),Un=vn(["video","audio","object","embed"]),WN=Mo("li"),uu=Mo("details"),VN=Mo("summary"),jp={skipBogus:!0,includeZwsp:!1,checkRootAsContent:!1},jN=(e,t,n)=>{let s=C.fromDom(t),o=C.fromDom(e),r=n.getWhitespaceElements();return Fp(o,i=>oe(r,Ce(i)),G(Se,s))},qN=e=>q(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),KN=(e,t)=>q(e)&&oe(t.getNonEmptyElements(),e.nodeName),GN=LN("data-mce-bookmark"),YN=e=>zr(C.fromDom(e)).exists(t=>!Es(t)),XN=(e,t,n)=>$o(e.data)&&!jN(e,t,n),ZN=(e,t,n,s)=>F(e)&&!XN(e,t,n)&&(!s.includeZwsp||!BN(e.data)),fu=(e,t,n,s)=>_e(s.isContent)&&s.isContent(t)||KN(t,e)||GN(t)||qN(t)||ZN(t,n,e,s)||Re(t)||cn(t)&&YN(t),as=(e,t,n)=>{let s=Q(Q({},jp),n);if(s.checkRootAsContent&&fu(e,t,t,s))return!1;let o=t.firstChild,r=0;if(!o)return!0;let a=new st(o,t);do{if(s.skipBogus&&q(o)){let i=o.getAttribute("data-mce-bogus");if(i){o=a.next(i==="all");continue}}if(Ss(o)){o=a.next(!0);continue}if(Le(o)){r++,o=a.next();continue}if(fu(e,o,t,s))return!1;o=a.next()}while(o);return r<=1},gt=(e,t,n)=>as(e,t.dom,Q({checkRootAsContent:!0},n)),qp=(e,t,n)=>fu(e,t,t,Q({includeZwsp:jp.includeZwsp},n)),Kp=e=>{let t=e.toLowerCase();return t==="svg"?"svg":t==="math"?"math":"html"},Ys=e=>Kp(e)!=="html",du=e=>Ys(e.nodeName),Gp=e=>Kp(e.nodeName),QN=["svg","math"],JN=()=>{let e=Jn(),t=()=>e.get().map(Gp).getOr("html");return{track:o=>(du(o)?e.set(o):e.get().exists(r=>!r.contains(o))&&e.clear(),t()),current:t,reset:()=>{e.clear()}}},Ti="data-mce-block",eR=e=>se(Ut(e),t=>!/[A-Z]/.test(t)),mu=e=>be(eR(e),t=>{let n=CSS.escape(t);return`${n}:`+be(QN,s=>`not(${s} ${n})`).join(":")}).join(","),Yp=(e,t)=>U(t.querySelector(e))?(t.setAttribute(Ti,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(Ti),!1),Xp=(e,t)=>{let n=mu(e.getTransparentElements()),s=mu(e.getBlockElements());return se(t.querySelectorAll(n),o=>Yp(s,o))},Zp=(e,t,n)=>{var s;let o=n?"lastChild":"firstChild";for(let r=t[o];r;r=r[o])if(as(e,r,{checkRootAsContent:!0})){(s=r.parentNode)===null||s===void 0||s.removeChild(r);return}},tR=(e,t,n)=>{let s=document.createRange(),o=t.parentNode;if(o){s.setStartBefore(t),s.setEndBefore(n);let r=s.extractContents();Zp(e,r,!0),s.setStartAfter(n),s.setEndAfter(t);let a=s.extractContents();Zp(e,a,!1),as(e,r,{checkRootAsContent:!0})||o.insertBefore(r,t),as(e,n,{checkRootAsContent:!0})||o.insertBefore(n,t),as(e,a,{checkRootAsContent:!0})||o.insertBefore(a,t),o.removeChild(t)}},nR=(e,t,n)=>{let s=e.getBlockElements(),o=C.fromDom(t),r=i=>Ce(i)in s,a=i=>Se(i,o);D(Gc(n),i=>{os(i,r,a).each(l=>{let c=nN(i,u=>r(u)&&!e.isValidChild(Ce(l),Ce(u)));if(c.length>0){let u=zr(l);D(c,f=>{os(f,r,a).each(d=>{tR(e,d.dom,f.dom)})}),u.each(f=>Xp(e,f.dom))}})})},sR=(e,t,n)=>{D([...n,...Xs(e,t)?[t]:[]],s=>D(mt(C.fromDom(s),s.nodeName.toLowerCase()),o=>{aR(e,o.dom)&&ys(o)}))},gu=(e,t)=>{let n=Xp(e,t);nR(e,t,n),sR(e,t,n)},oR=(e,t)=>{if(bu(e,t)){let n=mu(e.getBlockElements());Yp(n,t)}},rR=(e,t,n)=>{let s=r=>Se(r,C.fromDom(t)),o=cp(C.fromDom(n),s);Nr(o,o.length-2).filter(Ht).fold(()=>gu(e,t),r=>gu(e,r.dom))},pu=e=>e.hasAttribute(Ti),hu=(e,t)=>oe(e.getTransparentElements(),t),bu=(e,t)=>q(t)&&hu(e,t.nodeName),Xs=(e,t)=>bu(e,t)&&pu(t),aR=(e,t)=>bu(e,t)&&!pu(t),Cu=(e,t)=>t.type===1&&hu(e,t.name)&&ee(t.attr(Ti)),iR=bn().browser,Qp=e=>Ze(e,Ht),lR=e=>iR.isFirefox()&&Ce(e)==="table"?Qp(dt(e)).filter(t=>Ce(t)==="caption").bind(t=>Qp(fp(t)).map(n=>{let s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,Jp=(e,t)=>e.children&&ke(e.children,t),cR=(e,t,n)=>{let s=0,o=0,r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&Ln(C.fromDom(e),"position")==="static"){let i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!Jp(a,n);){let i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!Jp(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=lR(C.fromDom(t))}return{x:s,y:o}},eh=(e,t={})=>{let n=0,s={},o=C.fromDom(e),r=hs(o),a=y=>{t.referrerPolicy=y},i=y=>{t.contentCssCors=y},l=y=>{Ke(jc(o),y)},c=y=>{let v=jc(o);wi(v,"#"+y).each(Te)},u=y=>Fe(s,y).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),f=y=>new Promise((v,E)=>{let w,T=L._addCacheSuffix(y),B=u(T);s[T]=B,B.count++;let H=(z,X)=>{D(z,kr),B.status=X,B.passed=[],B.failed=[],w&&(w.onload=null,w.onerror=null,w=null)},x=()=>H(B.passed,2),_=()=>H(B.failed,3);if(v&&B.passed.push(v),E&&B.failed.push(E),B.status===1)return;if(B.status===2){x();return}if(B.status===3){_();return}B.status=1;let P=C.fromTag("link",r.dom);ns(P,{rel:"stylesheet",type:"text/css",id:B.id}),t.contentCssCors&&at(P,"crossOrigin","anonymous"),t.referrerPolicy&&at(P,"referrerpolicy",t.referrerPolicy),w=P.dom,w.onload=x,w.onerror=_,l(P),at(P,"href",T)}),d=(y,v)=>{let E=u(y);s[y]=E,E.count++;let w=C.fromTag("style",r.dom);ns(w,{rel:"stylesheet",type:"text/css",id:E.id,"data-mce-key":y}),w.dom.innerHTML=v,l(w)},g=y=>Promise.allSettled(be(y,E=>f(E).then(W(E)))).then(E=>{let w=_o(E,T=>T.status==="fulfilled");return w.fail.length>0?Promise.reject(be(w.fail,T=>T.reason)):be(w.pass,T=>T.value)}),h=y=>{let v=L._addCacheSuffix(y);Fe(s,v).each(E=>{--E.count===0&&(delete s[v],c(E.id))})};return{load:f,loadRawCss:d,loadAll:g,unload:h,unloadRawCss:y=>{Fe(s,y).each(v=>{--v.count===0&&(delete s[y],c(v.id))})},unloadAll:y=>{D(y,v=>{h(v)})},_setReferrerPolicy:a,_setContentCssCors:i}},th=(()=>{let e=new WeakMap;return{forElement:(n,s)=>{let r=Cs(n).dom;return m.from(e.get(r)).getOrThunk(()=>{let a=eh(r,s);return e.set(r,a),a})}}})(),uR=e=>e.nodeName.toLowerCase()==="span",nh=(e,t)=>U(e)&&(qp(t,e)||t.isInline(e.nodeName.toLowerCase())),fR=(e,t,n)=>{let s=new st(e,t).prev(!1),o=new st(e,t).next(!1),r=rt(s)||nh(s,n),a=rt(o)||nh(o,n);return r&&a},sh=e=>uR(e)&&e.getAttribute("data-mce-type")==="bookmark",dR=(e,t,n)=>F(e)&&e.data.length>0&&fR(e,t,n),mR=e=>q(e)?e.childNodes.length>0:!1,gR=e=>lu(e)||Yr(e),yu=(e,t,n,s)=>{var o;let r=s||t;if(q(t)&&sh(t))return t;let a=t.childNodes;for(let i=a.length-1;i>=0;i--)yu(e,a[i],n,r);if(q(t)){let i=t.childNodes;i.length===1&&sh(i[0])&&((o=t.parentNode)===null||o===void 0||o.insertBefore(i[0],t))}return!gR(t)&&!qp(n,t)&&!mR(t)&&!dR(t,r,n)&&e.remove(t),t},pR=L.makeMap,Di=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Pi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,hR=/[<>&\"\']/g,bR=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,CR={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"},Zs={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},yR={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},vR=e=>{let t=C.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},oh=(e,t)=>{let n={};if(e){let s=e.split(",");t=t||10;for(let o=0;o<s.length;o+=2){let r=String.fromCharCode(parseInt(s[o],t));if(!Zs[r]){let a="&"+s[o+1]+";";n[r]=a,n[a]=r}}return n}else return},vu=oh("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),rh=(e,t)=>e.replace(t?Di:Pi,n=>Zs[n]||n),ER=e=>(""+e).replace(hR,t=>Zs[t]||t),ah=(e,t)=>e.replace(t?Di:Pi,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":Zs[n]||"&#"+n.charCodeAt(0)+";"),Eu=(e,t,n)=>{let s=n||vu;return e.replace(t?Di:Pi,o=>Zs[o]||s[o]||o)},Qs={encodeRaw:rh,encodeAllRaw:ER,encodeNumeric:ah,encodeNamed:Eu,getEncodeFunc:(e,t)=>{let n=oh(t)||vu,s=(a,i)=>a.replace(i?Di:Pi,l=>Zs[l]!==void 0?Zs[l]:n[l]!==void 0?n[l]:l.length>1?"&#"+((l.charCodeAt(0)-55296)*1024+(l.charCodeAt(1)-56320)+65536)+";":"&#"+l.charCodeAt(0)+";"),o=(a,i)=>Eu(a,i,n),r=pR(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:Eu:r.numeric?ah:rh},decode:e=>e.replace(bR,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):CR[n]||String.fromCharCode(n)):yR[t]||vu[t]||vR(t))},ut=(e,t)=>(e=L.trim(e),e?e.split(t||" "):[]),ih=e=>new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),SR=e=>ot(e)&&e.source&&Object.prototype.toString.call(e)==="[object RegExp]",wR=e=>{let t=n=>Be(n)?be(n,t):SR(n)?new RegExp(n.source,n.flags):ot(n)?ui(n,t):n;return t(e)},kR=e=>{let t=/^(~)?(.+)$/;return Yt(ut(e,","),n=>{let s=t.exec(n);if(s){let r=s[1]==="~"?"span":"div",a=s[2];return[{cloneName:r,name:a}]}else return[]})},lh=e=>Object.freeze(["id","accesskey","class","dir","lang","style","tabindex","title","role",...e!=="html4"?["contenteditable","contextmenu","draggable","dropzone","hidden","spellcheck","translate","itemprop","itemscope","itemtype"]:[],...e!=="html5-strict"?["xml:lang"]:[]]),ch=e=>{let t,n;t="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",n="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"&&(t+=" article aside details dialog figure main header footer hgroup section nav "+"a ins del canvas map",n+=" audio canvas command data datalist mark meter output picture progress time wbr video ruby bdi keygen svg"),e!=="html5-strict"&&(n=[n,"acronym applet basefont big font strike tt"].join(" "),t=[t,"center dir isindex noframes"].join(" "));let s=[t,n].join(" ");return{blockContent:t,phrasingContent:n,flowContent:s}},Su=e=>{let{blockContent:t,phrasingContent:n,flowContent:s}=ch(e),o=r=>Object.freeze(r.split(" "));return Object.freeze({blockContent:o(t),phrasingContent:o(n),flowContent:o(s)})},_R={html4:Bn(()=>Su("html4")),html5:Bn(()=>Su("html5")),"html5-strict":Bn(()=>Su("html5-strict"))},uh=(e,t)=>{let{blockContent:n,phrasingContent:s,flowContent:o}=_R[e]();return t==="blocks"?m.some(n):t==="phrasing"?m.some(s):t==="flow"?m.some(o):m.none()},AR=e=>{let t=lh(e),{phrasingContent:n,flowContent:s}=ch(e),o={},r=(l,c,u)=>{o[l]={attributes:Nc(c,W({})),attributesOrder:c,children:Nc(u,W({}))}},a=(l,c="",u="")=>{let f=ut(u),d=ut(l),g=d.length,h=[...t,...ut(c)];for(;g--;)r(d[g],h.slice(),f)},i=(l,c)=>{let u=ut(l),f=ut(c),d=u.length;for(;d--;){let g=o[u[d]];for(let h=0,p=f.length;h<p;h++)g.attributes[f[h]]={},g.attributesOrder.push(f[h])}};return e!=="html5-strict"&&(D(ut("acronym applet basefont big font strike tt"),u=>{a(u,"",n)}),D(ut("center dir isindex noframes"),u=>{a(u,"",s)})),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),a("dd div","",s),a("address dt caption","",e==="html4"?n:s),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",n),a("blockquote","cite",s),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",s),a("dl","","dt dd"),a("a","href target rel media hreflang type",e==="html4"?n:s),a("q","cite",n),a("ins del","cite datetime",s),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",s),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),a("param","name value"),a("map","name",[s,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",s),a("th","colspan rowspan headers scope abbr",s),a("form","accept-charset action autocomplete enctype method name novalidate target",s),a("fieldset","disabled form name",[s,"legend"].join(" ")),a("label","form for",n),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?s:n),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[s,"li"].join(" ")),a("noscript","",s),e!=="html4"&&(a("wbr"),a("ruby","",[n,"rt rp"].join(" ")),a("figcaption","",s),a("mark rt rp bdi","",n),a("summary","",[n,"h1 h2 h3 h4 h5 h6"].join(" ")),a("canvas","width height",s),a("data","value",n),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[n,"option"].join(" ")),a("article section nav aside main header footer","",s),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[s,"figcaption"].join(" ")),a("time","datetime",n),a("dialog","open",s),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",n),a("progress","value max",n),a("meter","value min max low high optimum",n),a("details","open",[s,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name"),r("svg","id tabindex lang xml:space class style x y width height viewBox preserveAspectRatio zoomAndPan transform".split(" "),[])),e!=="html5-strict"&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid code codebase codetype archive standby align border hspace vspace"),i("embed","align name hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),e!=="html4"&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("img","loading"),i("iframe","sandbox seamless allow allowfullscreen loading referrerpolicy")),e!=="html4"&&D([o.video,o.audio],l=>{delete l.children.audio,delete l.children.video}),D(ut("a form meter progress dfn"),l=>{o[l]&&delete o[l].children[l]}),delete o.caption.children.table,delete o.script,o},xR=e=>e==="-"?"remove":"add",wu=e=>{let t=/^(@?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)$/;return m.from(t.exec(e)).map(n=>({preset:n[1]==="@",name:n[2]}))},NR=e=>{let t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return Yt(ut(e,","),n=>{let s=t.exec(n);if(s){let o=s[1],r=o?xR(o):"replace",a=s[2],i=Yt(ut(s[3],"|"),l=>wu(l).toArray());return[{operation:r,name:a,validChildren:i}]}else return[]})},RR=(e,t)=>{let n=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,s=/[*?+]/,{attributes:o,attributesOrder:r}=t;return D(ut(e,"|"),a=>{let i=n.exec(a);if(i){let l={},c=i[1],u=i[2].replace(/[\\:]:/g,":"),f=i[3],d=i[4];if(c==="!"&&(t.attributesRequired=t.attributesRequired||[],t.attributesRequired.push(u),l.required=!0),c==="-"){delete o[u],r.splice(L.inArray(r,u),1);return}if(f&&(f==="="?(t.attributesDefault=t.attributesDefault||[],t.attributesDefault.push({name:u,value:d}),l.defaultValue=d):f==="~"?(t.attributesForced=t.attributesForced||[],t.attributesForced.push({name:u,value:d}),l.forcedValue=d):f==="<"&&(l.validValues=L.makeMap(d,"?"))),s.test(u)){let g=l;t.attributePatterns=t.attributePatterns||[],g.pattern=ih(u),t.attributePatterns.push(g)}else o[u]||r.push(u),o[u]=l}})},TR=(e,t)=>{Ne(e.attributes,(n,s)=>{t.attributes[s]=n}),t.attributesOrder.push(...e.attributesOrder)},DR=(e,t)=>{let n=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return Yt(ut(t,","),s=>{let o=n.exec(s);if(o){let r=o[1],a=o[2],i=o[3],l=o[4],c=o[5],u={attributes:{},attributesOrder:[]};if(e.each(f=>TR(f,u)),r==="#"?u.paddEmpty=!0:r==="-"&&(u.removeEmpty=!0),l==="!"&&(u.removeEmptyAttrs=!0),c&&RR(c,u),i&&(u.outputName=a),a==="@")if(e.isNone())e=m.some(u);else return[];return[i?{name:a,element:u,aliasName:i}:{name:a,element:u}]}else return[]})},Bi={},Xr=L.makeMap,En=L.each,fh=L.extend,dh=L.explode,mh=(e,t={})=>{let n=Xr(e," ",Xr(e.toUpperCase()," "));return fh(n,t)},gh=e=>mh("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),ku=(e,t)=>{if(e){let n={};return ee(e)&&(e={"*":e}),En(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?Xr(s,/[, ]/):dh(s,/[, ]/)}),n}else return},ws=(e={})=>{var t;let n={},s={},o=[],r={},a={},i=(J,de,$e)=>{let Ve=e[J];if(Ve)return Xr(Ve,/[, ]/,Xr(Ve.toUpperCase(),/[, ]/));{let Xe=Bi[J];return Xe||(Xe=mh(de,$e),Bi[J]=Xe),Xe}},l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=AR(l);e.verify_html===!1&&(e.valid_elements="*[*]");let u=ku(e.valid_styles),f=ku(e.invalid_styles,"map"),d=ku(e.valid_classes,"map"),g=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),h=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),p=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),y="td th iframe video audio object script code",v=i("non_empty_elements",y+" pre svg textarea summary",p),E=i("move_caret_before_on_enter_elements",y+" table",p),w="h1 h2 h3 h4 h5 h6",T=i("text_block_elements",w+" p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),B=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary html body multicol listing",T),H=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),x=i("transparent_elements","a ins del canvas map"),_=i("wrap_block_elements","pre "+w);En("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),J=>{a[J]=new RegExp("</"+J+"[^>]*>","gi")});let P=J=>{let de=m.from(n["@"]),$e=/[*?+]/;D(DR(de,J??""),({name:Ve,element:Xe,aliasName:ze})=>{if(ze&&(n[ze]=Xe),$e.test(Ve)){let De=Xe;De.pattern=ih(Ve),o.push(De)}else n[Ve]=Xe})},z=J=>{o=[],D(Ut(n),de=>{delete n[de]}),P(J)},X=(J,de)=>{var $e,Ve;delete Bi.text_block_elements,delete Bi.block_elements;let Xe=de.extends?!bt(de.extends):!1,ze=de.extends;if(s[J]=ze?s[ze]:{},r[J]=ze??J,v[J.toUpperCase()]={},v[J]={},Xe||(B[J.toUpperCase()]={},B[J]={}),ze&&!n[J]&&n[ze]){let De=wR(n[ze]);delete De.removeEmptyAttrs,delete De.removeEmpty,n[J]=De}else n[J]={attributesOrder:[],attributes:{}};if(Be(de.attributes)){let De=_t=>{Pe.attributesOrder.push(_t),Pe.attributes[_t]={}},Pe=($e=n[J])!==null&&$e!==void 0?$e:{};delete Pe.attributesDefault,delete Pe.attributesForced,delete Pe.attributePatterns,delete Pe.attributesRequired,Pe.attributesOrder=[],Pe.attributes={},D(de.attributes,_t=>{let gn=lh(l);wu(_t).each(({preset:Xn,name:xn})=>{Xn?xn==="global"&&D(gn,De):De(xn)})}),n[J]=Pe}if(Rn(de.padEmpty)){let De=(Ve=n[J])!==null&&Ve!==void 0?Ve:{};De.paddEmpty=de.padEmpty,n[J]=De}if(Be(de.children)){let De={},Pe=gn=>{De[gn]={}},_t=gn=>{uh(l,gn).each(Xn=>{D(Xn,Pe)})};D(de.children,gn=>{wu(gn).each(({preset:Xn,name:xn})=>{Xn?_t(xn):Pe(xn)})}),s[J]=De}ze&&Ne(s,(De,Pe)=>{De[ze]&&(s[Pe]=De=fh({},s[Pe]),De[J]=De[ze])})},re=J=>{D(kR(J??""),({name:de,cloneName:$e})=>{X(de,{extends:$e})})},ie=J=>{ot(J)?Ne(J,(de,$e)=>X($e,de)):ee(J)&&re(J)},pe=J=>{D(NR(J??""),({operation:de,name:$e,validChildren:Ve})=>{let Xe=de==="replace"?{"#comment":{}}:s[$e],ze=Pe=>{de==="remove"?delete Xe[Pe]:Xe[Pe]={}},De=Pe=>{uh(l,Pe).each(_t=>{D(_t,ze)})};D(Ve,({preset:Pe,name:_t})=>{Pe?De(_t):ze(_t)}),s[$e]=Xe})},Ee=J=>{let de=n[J];if(de)return de;let $e=o.length;for(;$e--;){let Ve=o[$e];if(Ve.pattern.test(J))return Ve}},Ue=()=>{e.valid_elements?(z(e.valid_elements),En(c,(J,de)=>{s[de]=J.children})):(En(c,(J,de)=>{n[de]={attributes:J.attributes,attributesOrder:J.attributesOrder},s[de]=J.children}),En(ut("strong/b em/i"),J=>{let de=ut(J,"/");n[de[1]].outputName=de[0]}),En(H,(J,de)=>{n[de]&&(e.padd_empty_block_inline_children&&(n[de].paddInEmptyBlock=!0),n[de].removeEmpty=!0)}),En(ut("ol ul blockquote a table tbody"),J=>{n[J]&&(n[J].removeEmpty=!0)}),En(ut("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),J=>{n[J]&&(n[J].paddEmpty=!0)}),En(ut("span"),J=>{n[J].removeEmptyAttrs=!0})),delete n.svg,ie(e.custom_elements),pe(e.valid_children),P(e.extended_valid_elements),pe("+ol[ul|ol],+ul[ul|ol]"),En({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(J,de)=>{n[de]&&(n[de].parentsRequired=ut(J))}),e.invalid_elements&&En(dh(e.invalid_elements),J=>{n[J]&&delete n[J]}),Ee("span")||P("span[!data-mce-type|*]")},We=W(u),Ye=W(f),M=W(d),Y=W(b),ge=W(B),he=W(T),R=W(H),O=W(Object.seal(p)),K=W(h),le=W(v),ue=W(E),ve=W(g),rn=W(x),Yn=W(_),wt=W(Object.seal(a)),mn=(J,de)=>{let $e=s[J.toLowerCase()];return!!($e&&$e[de.toLowerCase()])},Kt=(J,de)=>{let $e=Ee(J);if($e)if(de){if($e.attributes[de])return!0;let Ve=$e.attributePatterns;if(Ve){let Xe=Ve.length;for(;Xe--;)if(Ve[Xe].pattern.test(de))return!0}}else return!0;return!1},bt=J=>oe(ge(),J),kt=J=>!Qe(J,"#")&&Kt(J)&&!bt(J),an=J=>oe(Yn(),J)||kt(J),$s=W(r);return Ue(),{type:l,children:s,elements:n,getValidStyles:We,getValidClasses:M,getBlockElements:ge,getInvalidStyles:Ye,getVoidElements:O,getTextBlockElements:he,getTextInlineElements:R,getBoolAttrs:Y,getElementRule:Ee,getSelfClosingElements:K,getNonEmptyElements:le,getMoveCaretBeforeOnEnterElements:ue,getWhitespaceElements:ve,getTransparentElements:rn,getSpecialElements:wt,isValidChild:mn,isValid:Kt,isBlock:bt,isInline:kt,isWrapper:an,getCustomElements:$s,addValidElements:P,setValidElements:z,addCustomElements:ie,addValidChildren:pe}},PR=e=>({value:BR(e)}),BR=e=>Ag(e,"#").toUpperCase(),_u=e=>{let t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},OR=e=>{let t=_u(e.red)+_u(e.green)+_u(e.blue);return PR(t)},ph=/^\s*rgb\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*\)\s*$/i,hh=/^\s*rgba\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*((?:\d?\.\d+|\d+)%?)\s*\)\s*$/i,IR=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),bh=(e,t,n,s)=>{let o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return IR(o,r,a,i)},FR=e=>ph.test(e)?"rgb":hh.test(e)?"rgba":"other",Ch=e=>{let t=ph.exec(e);if(t!==null)return m.some(bh(t[1],t[2],t[3],"1"));let n=hh.exec(e);return n!==null?m.some(bh(n[1],n[2],n[3],n[4])):m.none()},LR=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,Zr=e=>Ch(e).map(OR).map(t=>"#"+t.value).getOr(e),Au=(e={},t)=>{let n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,r={},a,i,l=Pr;t&&(a=t.getValidStyles(),i=t.getInvalidStyles());let c=(`\\" \\' \\; \\: ; : `+l).split(" ");for(let f=0;f<c.length;f++)r[c[f]]=l+f,r[l+f]=c[f];let u={parse:f=>{let d={},g=!1,h=e.url_converter,p=e.url_converter_scope||u,b=(x,_,P)=>{let z=d[x+"-top"+_];if(!z)return;let X=d[x+"-right"+_];if(!X)return;let re=d[x+"-bottom"+_];if(!re)return;let ie=d[x+"-left"+_];if(!ie)return;let pe=[z,X,re,ie],Ee=pe.length-1;for(;Ee--&&pe[Ee]===pe[Ee+1];);Ee>-1&&P||(d[x+_]=Ee===-1?pe[0]:pe.join(" "),delete d[x+"-top"+_],delete d[x+"-right"+_],delete d[x+"-bottom"+_],delete d[x+"-left"+_])},y=x=>{let _=d[x];if(!_)return;let P=_.indexOf(",")>-1?[_]:_.split(" "),z=P.length;for(;z--;)if(P[z]!==P[0])return!1;return d[x]=P[0],!0},v=(x,_,P,z)=>{y(_)&&y(P)&&y(z)&&(d[x]=d[_]+" "+d[P]+" "+d[z],delete d[_],delete d[P],delete d[z])},E=x=>(g=!0,r[x]),w=(x,_)=>(g&&(x=x.replace(/\uFEFF[0-9]/g,P=>r[P])),_||(x=x.replace(/\\([\'\";:])/g,"$1")),x),T=x=>String.fromCharCode(parseInt(x.slice(1),16)),B=x=>x.replace(/\\[0-9a-f]+/gi,T),H=(x,_,P,z,X,re)=>{if(X=X||re,X)return X=w(X),"'"+X.replace(/\'/g,"\\'")+"'";if(_=w(_||P||z||""),!e.allow_script_urls){let ie=_.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(ie)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(ie))return""}return h&&(_=h.call(p,_,"style")),"url('"+_.replace(/\'/g,"\\'")+"')"};if(f){f=f.replace(/[\u0000-\u001F]/g,""),f=f.replace(/\\[\"\';:\uFEFF]/g,E).replace(/\"[^\"]+\"|\'[^\']+\'/g,_=>_.replace(/[;:]/g,E));let x;for(;x=s.exec(f);){s.lastIndex=x.index+x[0].length;let _=x[1].replace(o,"").toLowerCase(),P=x[2].replace(o,"");if(_&&P){if(_=B(_),P=B(P),_.indexOf(l)!==-1||_.indexOf('"')!==-1||!e.allow_script_urls&&(_==="behavior"||/expression\s*\(|\/\*|\*\//.test(P)))continue;_==="font-weight"&&P==="700"?P="bold":(_==="color"||_==="background-color")&&(P=P.toLowerCase()),FR(P)==="rgb"&&Ch(P).each(z=>{P=Zr(LR(z)).toLowerCase()}),P=P.replace(n,H),d[_]=g?w(P,!0):P}}b("border","",!0),b("border","-width"),b("border","-color"),b("border","-style"),b("padding",""),b("margin",""),v("border","border-width","border-style","border-color"),d.border==="medium none"&&delete d.border,d["border-image"]==="none"&&delete d["border-image"]}return d},serialize:(f,d)=>{let g="",h=(b,y)=>{let v=y[b];if(v)for(let E=0,w=v.length;E<w;E++){let T=v[E],B=f[T];B&&(g+=(g.length>0?" ":"")+T+": "+B+";")}},p=(b,y)=>{if(!i||!y)return!0;let v=i["*"];return v&&v[b]?!1:(v=i[y],!(v&&v[b]))};return d&&a?(h("*",a),h(d,a)):Ne(f,(b,y)=>{b&&p(y,d)&&(g+=(g.length>0?" ":"")+y+": "+b+";")}),g}};return u},$R={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},MR=e=>e instanceof Event||_e(e.initEvent),UR=e=>e.isDefaultPrevented===He||e.isDefaultPrevented===Oe,zR=e=>qe(e.preventDefault)||MR(e),yh=(e,t)=>{let n=t??{};for(let s in e)oe($R,s)||(n[s]=e[s]);return U(e.composedPath)&&(n.composedPath=()=>e.composedPath()),U(e.getModifierState)&&(n.getModifierState=s=>e.getModifierState(s)),U(e.getTargetRanges)&&(n.getTargetRanges=()=>e.getTargetRanges()),n},xu=(e,t,n,s)=>{var o;let r=yh(t,s);return r.type=e,qe(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),zR(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=He,_e(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=He,_e(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=He,r.stopPropagation()},UR(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?He:Oe,r.isPropagationStopped=r.cancelBubble===!0?He:Oe,r.isImmediatePropagationStopped=Oe)),r},HR="mce-data-",WR=/^(?:mouse|contextmenu)|click/,Nu=(e,t,n,s)=>{e.addEventListener(t,n,s||!1)},Oi=(e,t,n,s)=>{e.removeEventListener(t,n,s||!1)},VR=e=>U(e)&&WR.test(e.type),Qr=(e,t)=>{let n=xu(e.type,e,document,t);if(VR(e)&&rt(e.pageX)&&!rt(e.clientX)){let s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},jR=(e,t,n)=>{let s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}let r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{Oi(e,"DOMContentLoaded",a),Oi(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():Nu(e,"DOMContentLoaded",a),n.domLoaded||Nu(e,"load",a)};class Js{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=HR+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){let r=this,a,i=window,l=d=>{r.executeHandlers(Qr(d||i.event),c)};if(!t||F(t)||Ss(t))return s;let c;t[r.expando]?c=t[r.expando]:(c=r.count++,t[r.expando]=c,r.events[c]={}),o=o||t;let u=n.split(" "),f=u.length;for(;f--;){let d=u[f],g=l,h=!1,p=!1;if(d==="DOMContentLoaded"&&(d="ready"),r.domLoaded&&d==="ready"&&t.readyState==="complete"){s.call(o,Qr({type:d}));continue}!r.hasFocusIn&&(d==="focusin"||d==="focusout")&&(h=!0,p=d==="focusin"?"focus":"blur",g=b=>{let y=Qr(b||i.event);y.type=y.type==="focus"?"focusin":"focusout",r.executeHandlers(y,c)}),a=r.events[c][d],a?d==="ready"&&r.domLoaded?s(Qr({type:d})):a.push({func:s,scope:o}):(r.events[c][d]=a=[{func:s,scope:o}],a.fakeName=p,a.capture=h,a.nativeHandler=g,d==="ready"?jR(t,g,r):Nu(t,p||d,g,h))}return t=a=null,s}unbind(t,n,s){if(!t||F(t)||Ss(t))return this;let o=t[this.expando];if(o){let r=this.events[o];if(n){let a=n.split(" "),i=a.length;for(;i--;){let l=a[i],c=r[l];if(c){if(s){let u=c.length;for(;u--;)if(c[u].func===s){let f=c.nativeHandler,d=c.fakeName,g=c.capture,h=c.slice(0,u).concat(c.slice(u+1));h.nativeHandler=f,h.fakeName=d,h.capture=g,r[l]=h}}(!s||c.length===0)&&(delete r[l],Oi(t,c.fakeName||l,c.nativeHandler,c.capture))}}}else Ne(r,(a,i)=>{Oi(t,a.fakeName||i,a.nativeHandler,a.capture)}),r={};for(let a in r)if(oe(r,a))return this;delete this.events[o];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){if(!t||F(t)||Ss(t))return this;let o=Qr({type:n,target:t},s);do{let r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||F(t)||Ss(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);let n=t.getElementsByTagName("*"),s=n.length;for(;s--;)t=n[s],t[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){let s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){let i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}Js.Event=new Js;let Ru=L.each,qR=L.grep,Tu="data-mce-style",KR=L.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Jr=(e,t,n)=>{qe(n)||n===""?it(e,t):at(e,t,n)},vh=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Uo=(e,t)=>{let n=0;if(e)for(let s=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){let r=o.nodeType;t&&F(o)&&(r===s||!o.data.length)||(n++,s=r)}return n},Eh=(e,t)=>{let n=Wt(t,"style"),s=e.serialize(e.parse(n),Ce(t));Jr(t,Tu,s)},GR=(e,t)=>ln(e)?oe(KR,t)?e+"":e+"px":e,Sh=(e,t,n)=>{let s=vh(t);qe(n)||n===""?_p(e,s):wp(e,s,GR(n,s))},YR=(e,t,n)=>{let s=t.keep_values,o={set:(a,i,l)=>{let c=C.fromDom(a);_e(t.url_converter)&&U(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),String(i),l,a));let u="data-mce-"+l;Jr(c,u,i),Jr(c,l,i)},get:(a,i)=>{let l=C.fromDom(a);return Wt(l,"data-mce-"+i)||Wt(l,i)}},r={style:{set:(a,i)=>{let l=C.fromDom(a);s&&Jr(l,Tu,i),it(l,"style"),ee(i)&&vi(l,e.parse(i))},get:a=>{let i=C.fromDom(a),l=Wt(i,Tu)||Wt(i,"style");return e.serialize(e.parse(l),Ce(i))}}};return s&&(r.href=r.src=o),r},xe=(e,t={})=>{let n={},s=window,o={},r=0,a=!0,i=!0,l=th.forElement(C.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],u=t.schema?t.schema:ws({}),f=Au({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new Js:Js.Event,g=u.getBlockElements(),h=S=>ee(S)?oe(g,S):q(S)&&(oe(g,S.nodeName)||Xs(u,S)),p=S=>S&&e&&ee(S)?e.getElementById(S):S,b=S=>{let k=p(S);return U(k)?C.fromDom(k):null},y=(S,k,$="")=>{let I,te=b(S);if(U(te)&&Ht(te)){let me=Sc[k];me&&me.get?I=me.get(te.dom,k):I=Wt(te,k)}return U(I)?I:$},v=S=>{let k=p(S);return qe(k)?[]:k.attributes},E=(S,k,$)=>{Y(S,I=>{if(q(I)){let te=C.fromDom(I),me=$===""?null:$,Me=Wt(te,k),Nn=Sc[k];Nn&&Nn.set?Nn.set(te.dom,me,k):Jr(te,k,me),Me!==me&&t.onSetAttrib&&t.onSetAttrib({attrElm:te.dom,attrName:k,attrValue:me})}})},w=(S,k)=>S.cloneNode(k),T=()=>t.root_element||e.body,B=S=>{let k=au(S);return{x:k.x,y:k.y,w:k.width,h:k.height}},H=(S,k)=>cR(e.body,p(S),k),x=(S,k,$)=>{Y(S,I=>{let te=C.fromDom(I);Sh(te,k,$),t.update_styles&&Eh(f,te)})},_=(S,k)=>{Y(S,$=>{let I=C.fromDom($);Ne(k,(te,me)=>{Sh(I,me,te)}),t.update_styles&&Eh(f,I)})},P=(S,k,$)=>{let I=p(S);if(!(qe(I)||!$n(I)&&!FN(I)))return $?Ln(C.fromDom(I),vh(k)):(k=k.replace(/-(\D)/g,(te,me)=>me.toUpperCase()),k==="float"&&(k="cssFloat"),I.style?I.style[k]:void 0)},z=S=>{let k=p(S);if(!k)return{w:0,h:0};let $=P(k,"width"),I=P(k,"height");return(!$||$.indexOf("px")===-1)&&($="0"),(!I||I.indexOf("px")===-1)&&(I="0"),{w:parseInt($,10)||k.offsetWidth||k.clientWidth,h:parseInt(I,10)||k.offsetHeight||k.clientHeight}},X=S=>{let k=p(S),$=H(k),I=z(k);return{x:$.x,y:$.y,w:I.w,h:I.h}},re=(S,k)=>{if(!S)return!1;let $=Be(S)?S:[S];return Ie($,I=>Cn(C.fromDom(I),k))},ie=(S,k,$,I)=>{let te=[],me=p(S);I=I===void 0;let Me=$||(T().nodeName!=="BODY"?T().parentNode:null);if(ee(k))if(k==="*")k=q;else{let Nn=k;k=hn=>re(hn,Nn)}for(;me&&!(me===Me||qe(me.nodeType)||Yr(me)||lu(me));){if(!k||k(me))if(I)te.push(me);else return[me];me=me.parentNode}return I?te:null},pe=(S,k,$)=>{let I=ie(S,k,$,!1);return I&&I.length>0?I[0]:null},Ee=(S,k,$)=>{let I=k;if(S){ee(k)&&(I=te=>re(te,k));for(let te=S[$];te;te=te[$])if(_e(I)&&I(te))return te}return null},Ue=(S,k)=>Ee(S,k,"nextSibling"),We=(S,k)=>Ee(S,k,"previousSibling"),Ye=S=>_e(S.querySelectorAll),M=(S,k)=>{var $,I;let te=(I=($=p(k))!==null&&$!==void 0?$:t.root_element)!==null&&I!==void 0?I:e;return Ye(te)?Mt(te.querySelectorAll(S)):[]},Y=function(S,k,$){let I=$??this;if(Be(S)){let te=[];return Ru(S,(me,Me)=>{let Nn=p(me);Nn&&te.push(k.call(I,Nn,Me))}),te}else{let te=p(S);return te?k.call(I,te):!1}},ge=(S,k)=>{Y(S,$=>{Ne(k,(I,te)=>{E($,te,I)})})},he=(S,k)=>{Y(S,$=>{let I=C.fromDom($);yi(I,k)})},R=(S,k,$,I,te)=>Y(S,me=>{let Me=ee(k)?e.createElement(k):k;return U($)&&ge(Me,$),I&&(!ee(I)&&I.nodeType?Me.appendChild(I):ee(I)&&he(Me,I)),te?Me:me.appendChild(Me)}),O=(S,k,$)=>R(e.createElement(S),S,k,$,!0),K=Qs.decode,le=Qs.encodeAllRaw,ue=(S,k,$="")=>{let I="<"+S;for(let te in k)xo(k,te)&&(I+=" "+te+'="'+le(k[te])+'"');return Dr($)&&oe(u.getVoidElements(),S)?I+" />":I+">"+$+"</"+S+">"},ve=S=>{let k=e.createElement("div"),$=e.createDocumentFragment();$.appendChild(k),S&&(k.innerHTML=S);let I;for(;I=k.firstChild;)$.appendChild(I);return $.removeChild(k),$},rn=(S,k)=>Y(S,$=>{let I=C.fromDom($);return k&&D(dt(I),te=>{Nt(te)&&te.dom.length===0?Te(te):Bt(I,te)}),Te(I),I.dom}),Yn=S=>Y(S,k=>{let $=k.attributes;for(let I=$.length-1;I>=0;I--)k.removeAttributeNode($.item(I))}),wt=S=>f.parse(S),mn=(S,k)=>f.serialize(S,k),Kt=S=>{if(Us!==xe.DOM&&e===document){if(n[S])return;n[S]=!0}let k=e.getElementById("mceDefaultStyles");if(!k){k=e.createElement("style"),k.id="mceDefaultStyles",k.type="text/css";let $=e.head;$.firstChild?$.insertBefore(k,$.firstChild):$.appendChild(k)}k.styleSheet?k.styleSheet.cssText+=S:k.appendChild(e.createTextNode(S))},bt=S=>{S||(S=""),D(S.split(","),k=>{o[k]=!0,l.load(k).catch(ce)})},kt=(S,k,$)=>{Y(S,I=>{if(q(I)){let te=C.fromDom(I),me=k.split(" ");D(me,Me=>{U($)?($?Fo:Gr)(te,Me):Zx(te,Me)})}})},an=(S,k)=>{kt(S,k,!0)},$s=(S,k)=>{kt(S,k,!1)},J=(S,k)=>{let $=b(S),I=k.split(" ");return U($)&&Qn(I,te=>nu($,te))},de=S=>{Y(S,k=>_p(C.fromDom(k),"display"))},$e=S=>{Y(S,k=>wp(C.fromDom(k),"display","none"))},Ve=S=>{let k=b(S);return U(k)&&No(Ei(k,"display"),"none")},Xe=S=>(S||"mce_")+r++,ze=S=>{let k=b(S);return U(k)?q(k.dom)?k.dom.outerHTML:Lx(k):""},De=(S,k)=>{Y(S,$=>{q($)&&($.outerHTML=k)})},Pe=(S,k)=>{let $=p(k);return Y(S,I=>{let te=$?.parentNode,me=$?.nextSibling;return te&&(me?te.insertBefore(I,me):te.appendChild(I)),I})},_t=(S,k,$)=>Y(k,I=>{var te;let me=Be(k)?S.cloneNode(!0):S;return $&&Ru(qR(I.childNodes),Me=>{me.appendChild(Me)}),(te=I.parentNode)===null||te===void 0||te.replaceChild(me,I),I}),gn=(S,k)=>{if(S.nodeName!==k.toUpperCase()){let $=O(k);return Ru(v(S),I=>{E($,I.nodeName,y(S,I.nodeName))}),_t($,S,!0),$}else return S},Xn=(S,k)=>{let $=S;for(;$;){let I=k;for(;I&&$!==I;)I=I.parentNode;if($===I)break;$=$.parentNode}return!$&&S.ownerDocument?S.ownerDocument.documentElement:$},xn=(S,k,$)=>{if(li(k)){let I=te=>{let me=te.nodeName.toLowerCase();return!!k[me]};return as(u,S,we(Q({},$),{isContent:I}))}else return as(u,S,$)},Cr=()=>e.createRange(),yr=(S,k,$)=>{let I=Cr(),te,me;if(S&&k&&S.parentNode&&k.parentNode){let Me=S.parentNode;return I.setStart(Me,Uo(S)),I.setEnd(k.parentNode,Uo(k)),te=I.extractContents(),I=Cr(),I.setStart(k.parentNode,Uo(k)+1),I.setEnd(Me,Uo(S)+1),me=I.extractContents(),Me.insertBefore(yu(Us,te,u),S),$?Me.insertBefore($,S):Me.insertBefore(k,S),Me.insertBefore(yu(Us,me,u),S),rn(S),$||k}else return},ko=(S,k,$,I)=>{if(Be(S)){let te=S.length,me=[];for(;te--;)me[te]=ko(S[te],k,$,I);return me}else return t.collect&&(S===e||S===s)&&c.push([S,k,$,I]),d.bind(S,k,$,I||Us)},pn=(S,k,$)=>{if(Be(S)){let I=S.length,te=[];for(;I--;)te[I]=pn(S[I],k,$);return te}else{if(c.length>0&&(S===e||S===s)){let I=c.length;for(;I--;){let[te,me,Me]=c[I];S===te&&(!k||k===me)&&(!$||$===Me)&&d.unbind(te,me,Me)}}return d.unbind(S,k,$)}},Ms=(S,k,$)=>d.dispatch(S,k,$),ni=(S,k,$)=>d.dispatch(S,k,$),vr=S=>{if(S&&$n(S)){let k=S.getAttribute("data-mce-contenteditable");return k&&k!=="inherit"?k:S.contentEditable!=="inherit"?S.contentEditable:null}else return null},Us={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:c,styles:f,schema:u,events:d,isBlock:h,root:null,clone:w,getRoot:T,getViewPort:B,getRect:X,getSize:z,getParent:pe,getParents:ie,get:p,getNext:Ue,getPrev:We,select:M,is:re,add:R,create:O,createHTML:ue,createFragment:ve,remove:rn,setStyle:x,getStyle:P,setStyles:_,removeAllAttribs:Yn,setAttrib:E,setAttribs:ge,getAttrib:y,getPos:H,parseStyle:wt,serializeStyle:mn,addStyle:Kt,loadCSS:bt,addClass:an,removeClass:$s,hasClass:J,toggleClass:kt,show:de,hide:$e,isHidden:Ve,uniqueId:Xe,setHTML:he,getOuterHTML:ze,setOuterHTML:De,decode:K,encode:le,insertAfter:Pe,replace:_t,rename:gn,findCommonAncestor:Xn,run:Y,getAttribs:v,isEmpty:xn,createRng:Cr,nodeIndex:Uo,split:yr,bind:ko,unbind:pn,fire:ni,dispatch:Ms,getContentEditable:vr,getContentEditableParent:S=>{let k=T(),$=null;for(let I=S;I&&I!==k&&($=vr(I),$===null);I=I.parentNode);return $},isEditable:S=>{if(U(S)){let k=q(S)?S:S.parentElement;return U(k)&&$n(k)&&Es(C.fromDom(k))}else return!1},destroy:()=>{if(c.length>0){let S=c.length;for(;S--;){let[k,$,I]=c[S];d.unbind(k,$,I)}}Ne(o,(S,k)=>{l.unload(k),delete o[k]})},isChildOf:(S,k)=>S===k||k.contains(S),dumpRng:S=>"startContainer: "+S.startContainer.nodeName+", startOffset: "+S.startOffset+", endContainer: "+S.endContainer.nodeName+", endOffset: "+S.endOffset},Sc=YR(f,t,W(Us));return Us};xe.DOM=xe(document),xe.nodeIndex=Uo;let XR=xe.DOM,ZR=0,QR=1,Ii=2,wh=3;class is{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{let o=XR,r,a=()=>{o.remove(c),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},l=()=>{a(),s("Failed to load script: "+t)},c=o.uniqueId();r=document.createElement("script"),r.id=c,r.type="text/javascript",r.src=L._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=l,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Ii}markDone(t){this.states[t]=Ii}add(t){let n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=ZR),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){let t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){let n=this,s=(l,c)=>{Fe(n.scriptLoadedCallbacks,c).each(u=>{D(u,f=>f[l](c))}),delete n.scriptLoadedCallbacks[c]},o=l=>{let c=se(l,u=>u.status==="rejected");return c.length>0?Promise.reject(Yt(c,({reason:u})=>Be(u)?u:[u])):Promise.resolve()},r=l=>Promise.allSettled(be(l,c=>n.states[c]===Ii?(s("resolve",c),Promise.resolve()):n.states[c]===wh?(s("reject",c),Promise.reject(c)):(n.states[c]=QR,n.loadScript(c).then(()=>{n.states[c]=Ii,s("resolve",c);let u=n.queue;return u.length>0?(n.queue=[],r(u).then(o)):Promise.resolve()},()=>(n.states[c]=wh,s("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,r(l).then(c=>{n.loading=!1;let u=n.queueLoadedCallbacks.shift();return m.from(u).each(kr),o(c)})),i=Ng(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(l,c)})}):a(i)}}is.ScriptLoader=new is;let JR=(e,t)=>{let n=e.indexOf(t);return n!==-1&&e.indexOf(t,n+1)>n},eT=e=>ot(e)&&oe(e,"raw"),tT=e=>Be(e)&&e.length>1,ea={},Du=nt("en"),kh=()=>Fe(ea,Du.get()),Sn={getData:()=>ui(ea,e=>Q({},e)),setCode:e=>{e&&Du.set(e)},getCode:()=>Du.get(),add:(e,t)=>{let n=ea[e];n||(ea[e]=n={});let s=be(Ut(t),o=>o.toLowerCase());Ne(t,(o,r)=>{let a=r.toLowerCase();a!==r&&JR(s,a)?(oe(t,a)||(n[a]=o),n[r]=o):n[a]=o})},translate:e=>{let t=kh().getOr({}),n=a=>_e(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{let i=n(a);return oe(t,i)?n(t[i]):Fe(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(eT(e))return n(e.raw);if(tT(e)){let a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>oe(a,c)?n(a[c]):l);return r(i)}return r(o(e))},isRtl:()=>kh().bind(e=>Fe(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>oe(ea,e)},vt=()=>{let e=[],t={},n={},s=[],o=(p,b)=>{let y=se(s,v=>v.name===p&&v.state===b);D(y,v=>v.resolve())},r=p=>oe(t,p),a=p=>oe(n,p),i=p=>{if(n[p])return n[p].instance},l=(p,b)=>{let y=Sn.getCode(),v=","+(b||"")+",";!y||b&&v.indexOf(","+y+",")===-1||is.ScriptLoader.add(t[p]+"/langs/"+y+".js")},c=(p,b)=>{vt.languageLoad!==!1&&(r(p)?l(p,b):h(p,"loaded").then(()=>l(p,b)))},u=(p,b)=>(e.push(b),n[p]={instance:b},o(p,"added"),b),f=p=>{delete t[p],delete n[p]},d=(p,b)=>ee(b)?ee(p)?{prefix:"",resource:b,suffix:""}:{prefix:p.prefix,resource:b,suffix:p.suffix}:b,g=(p,b)=>{if(t[p])return Promise.resolve();let y=ee(b)?b:b.prefix+b.resource+b.suffix;y.indexOf("/")!==0&&y.indexOf("://")===-1&&(y=vt.baseURL+"/"+y),t[p]=y.substring(0,y.lastIndexOf("/"));let v=()=>(o(p,"loaded"),Promise.resolve());return n[p]?v():is.ScriptLoader.add(y).then(v)},h=(p,b="added")=>b==="added"&&a(p)||b==="loaded"&&r(p)?Promise.resolve():new Promise(y=>{s.push({name:p,state:b,resolve:y})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:c,add:u,remove:f,createUrl:d,load:g,waitFor:h}};vt.languageLoad=!0,vt.baseURL="",vt.PluginManager=vt(),vt.ThemeManager=vt(),vt.ModelManager=vt();let ta=W("mce-annotation"),eo=W("data-mce-annotation"),zo=W("data-mce-annotation-uid"),na=W("data-mce-annotation-active"),sa=W("data-mce-annotation-classes"),oa=W("data-mce-annotation-attrs"),_h=e=>t=>Se(t,e),Ah=(e,t)=>{let n=e.selection.getRng(),s=C.fromDom(n.startContainer),o=C.fromDom(e.getBody()),r=t.fold(()=>"."+ta(),l=>`[${eo()}="${l}"]`),a=Do(s,n.startOffset).getOr(s);return Io(a,r,_h(o)).bind(l=>ss(l,`${zo()}`).bind(c=>ss(l,`${eo()}`).map(u=>{let f=Nh(e,c);return{uid:c,name:u,elements:f}})))},nT=e=>Ht(e)&&nu(e,ta()),xh=(e,t)=>Wr(e,"data-mce-bogus")||oN(e,'[data-mce-bogus="all"]',_h(t)),Nh=(e,t)=>{let n=C.fromDom(e.getBody()),s=mt(n,`[${zo()}="${t}"]`);return se(s,o=>!xh(o,n))},Rh=(e,t)=>{let n=C.fromDom(e.getBody()),s=mt(n,`[${eo()}="${t}"]`),o={};return D(s,r=>{if(!xh(r,n)){let a=Wt(r,zo()),i=Fe(o,a).getOr([]);o[a]=i.concat([r])}}),o},sT=(e,t)=>{let n=nt({}),s=()=>({listeners:[],previous:Jn()}),o=(f,d)=>{r(f,g=>(d(g),g))},r=(f,d)=>{let g=n.get(),h=Fe(g,f).getOrThunk(s),p=d(h);g[f]=p,n.set(g)},a=(f,d,g)=>{o(f,h=>{D(h.listeners,p=>p(!0,f,{uid:d,nodes:be(g,b=>b.dom)}))})},i=f=>{o(f,d=>{D(d.listeners,g=>g(!1,f))})},l=(f,d)=>{D(Nh(e,f),g=>{d?at(g,na(),"true"):it(g,na())})},c=Bc(()=>{let f=Hs(t.getNames());D(f,d=>{r(d,g=>{let h=g.previous.get();return Ah(e,m.some(d)).fold(()=>{h.each(p=>{i(d),g.previous.clear(),l(p,!1)})},({uid:p,name:b,elements:y})=>{No(h,p)||(h.each(v=>l(v,!1)),a(b,p,y),g.previous.set(p),l(p,!0))}),{previous:g.previous,listeners:g.listeners}})})},30);return e.on("remove",()=>{c.cancel()}),e.on("NodeChange",()=>{c.throttle()}),{addListener:(f,d)=>{r(f,g=>({previous:g.previous,listeners:g.listeners.concat([d])}))}}},oT=(e,t)=>{let n=eo(),s=r=>m.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr(zo(),null),r.attr(eo(),null),r.attr(na(),null);let l=m.from(r.attr(oa())).map(d=>d.split(",")).getOr([]),c=m.from(r.attr(sa())).map(d=>d.split(",")).getOr([]);D(l,d=>r.attr(d,null));let u=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],f=ci(u,[ta()].concat(c));r.attr("class",f.length>0?f.join(" "):null),r.attr(sa(),null),r.attr(oa(),null)};e.serializer.addTempAttr(na()),e.serializer.addAttributeFilter(n,r=>{for(let a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},rT=()=>{let e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>Fe(e,o).map(r=>r.settings),getNames:()=>Ut(e)}},Th=(e,t,n=Oe)=>{let s=new st(e,t),o=r=>{let a;do a=s[r]();while(a&&!F(a)&&!n(a));return m.from(a).filter(F)};return{current:()=>m.from(s.current()).filter(F),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},to=(e,t)=>{let n=t||(a=>e.isBlock(a)||Le(a)||Re(a)),s=(a,i,l,c)=>{if(F(a)){let u=c(a,i,a.data);if(u!==-1)return m.some({container:a,offset:u})}return l().bind(u=>s(u.container,u.offset,l,c))};return{backwards:(a,i,l,c)=>{let u=Th(a,c??e.getRoot(),n);return s(a,i,()=>u.prev().map(f=>({container:f,offset:f.length})),l).getOrNull()},forwards:(a,i,l,c)=>{let u=Th(a,c??e.getRoot(),n);return s(a,i,()=>u.next().map(f=>({container:f,offset:0})),l).getOrNull()}}},aT=["td","th"],iT=["thead","tbody","tfoot"],lT=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],cT=["li","dd","dt"],uT=["ul","ol","dl"],fT=["pre","script","textarea","style"],Ho=e=>{let t;return n=>(t=t||Nc(e,He),oe(t,Ce(n)))},dT=e=>Ce(e)==="table",no=e=>Ht(e)&&Ce(e)==="br",Dh=Ho(lT),Pu=Ho(uT),Wo=Ho(cT),mT=Ho(iT),ra=Ho(aT),Fi=Ho(fT),gT=e=>{let t=[],n=e.dom;for(;n;)t.push(C.fromDom(n)),n=n.lastChild;return t},pT=e=>{let t=mt(e,"br"),n=se(gT(e).slice(-1),no);t.length===n.length&&D(n,Te)},Vo=()=>{let e=C.fromTag("br");return at(e,"data-mce-bogus","1"),e},ks=e=>{Po(e),Ke(e,Vo())},hT=(e,t)=>{Hc(e).each(n=>{bs(n).each(s=>{t.isBlock(Ce(e))&&no(n)&&t.isBlock(Ce(s))&&Te(n)})})},et=Pr,Li=Oc,Vt=NA,bT=e=>e.insertContent(et,{preserve_zwsp:!0}),CT=q,jo=F,qo=e=>(jo(e)&&(e=e.parentNode),CT(e)&&e.hasAttribute("data-mce-caret")),_s=e=>jo(e)&&Li(e.data),Xt=e=>qo(e)||_s(e),Ph=e=>e.firstChild!==e.lastChild||!Le(e.firstChild),yT=(e,t)=>{var n;let o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(et),r=e.parentNode;if(t){let a=e.previousSibling;if(jo(a)){if(Xt(a))return a;if(Mi(a))return a.splitText(a.data.length-1)}r?.insertBefore(o,e)}else{let a=e.nextSibling;if(jo(a)){if(Xt(a))return a;if($i(a))return a.splitText(1),a}e.nextSibling?r?.insertBefore(o,e.nextSibling):r?.appendChild(o)}return o},Bu=e=>{let t=e.container();return F(t)?t.data.charAt(e.offset())===et||e.isAtStart()&&_s(t.previousSibling):!1},Ou=e=>{let t=e.container();return F(t)?t.data.charAt(e.offset()-1)===et||e.isAtEnd()&&_s(t.nextSibling):!1},vT=(e,t,n)=>{var s;let r=((s=t.ownerDocument)!==null&&s!==void 0?s:document).createElement(e);r.setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(Vo().dom);let a=t.parentNode;return n?a?.insertBefore(r,t):t.nextSibling?a?.insertBefore(r,t.nextSibling):a?.appendChild(r),r},$i=e=>jo(e)&&e.data[0]===et,Mi=e=>jo(e)&&e.data[e.data.length-1]===et,ET=e=>{var t;let n=e.getElementsByTagName("br"),s=n[n.length-1];Gs(s)&&((t=s.parentNode)===null||t===void 0||t.removeChild(s))},Iu=e=>e&&e.hasAttribute("data-mce-caret")?(ET(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,Bh=e=>qo(e.startContainer),Ko=Math.round,so=e=>e?{left:Ko(e.left),top:Ko(e.top),bottom:Ko(e.bottom),right:Ko(e.right),width:Ko(e.width),height:Ko(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},Oh=(e,t)=>(e=so(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),ST=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,Ih=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,aa=(e,t)=>{let n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:Ih(t.top-e.bottom,e,t)},ia=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:Ih(t.bottom-e.top,e,t),wT=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,kT=e=>Pt(e,(t,n)=>t.fold(()=>m.some(n),s=>{let o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return m.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),m.none()),Fh=(e,t,n)=>{let s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},_T=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),Ui=e=>{let t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},As=(e,t)=>{if(q(e)&&e.hasChildNodes()){let n=e.childNodes,s=hA(t,0,n.length-1);return n[s]}else return e},AT=(e,t)=>{if(!(t<0&&q(e)&&e.hasChildNodes()))return As(e,t)},xT=new RegExp("[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B57\u0B62-\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC-\u0CCD\u0CD5-\u0CD6\u0CE2-\u0CE3\u0D01\u0D3E\u0D41-\u0D44\u0D4D\u0D57\u0D62-\u0D63\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u200C-\u200D\u20D0-\u20DC\u20DD-\u20E0\u20E1\u20E2-\u20E4\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u302E-\u302F\u3099-\u309A\uA66F\uA670-\uA672\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E-\uFF9F]"),Lh=e=>ee(e)&&e.charCodeAt(0)>=768&&xT.test(e),NT=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},RT=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},$h=cn,TT=Re,DT=Le,PT=F,BT=vn(["script","style","textarea"]),Mh=vn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),OT=vn(["table"]),IT=Xt,wn=e=>IT(e)?!1:PT(e)?!BT(e.parentNode):Mh(e)||DT(e)||OT(e)||Fu(e),FT=e=>q(e)&&e.getAttribute("unselectable")==="true",Fu=e=>!FT(e)&&TT(e),LT=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(Fu(n))return!1;if($h(n))return!0}return!0},$T=e=>Fu(e)?!Pt(Mt(e.getElementsByTagName("*")),(t,n)=>t||$h(n),!1):!1,MT=e=>Mh(e)||$T(e),Uh=(e,t)=>wn(e)&&LT(e,t),zh=q,UT=wn,Hh=Ni("display","block table"),zT=Ni("float","left right"),la=RT(zh,UT,wr(zT)),HT=wr(Ni("white-space","pre pre-line pre-wrap")),ca=F,Lu=Le,Wh=xe.nodeIndex,zi=AT,$u=e=>e?e.createRange():xe.DOM.createRng(),Mu=e=>ee(e)&&/[\r\n\t ]/.test(e),Vh=e=>!!e.setStart&&!!e.setEnd,Uu=e=>{let t=e.startContainer,n=e.startOffset;if(Mu(e.toString())&&HT(t.parentNode)&&F(t)){let s=t.data;if(Mu(s[n-1])||Mu(s[n+1]))return!0}return!1},WT=e=>{let t=e.ownerDocument,n=$u(t),s=t.createTextNode(Je),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);let r=so(n.getBoundingClientRect());return o.removeChild(s),r},VT=e=>{let t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&F(n)&&s===0&&o===1){let r=e.cloneRange();return r.setEndAfter(n),xs(r)}else return null},jh=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,xs=e=>{var t;let n,s=e.getClientRects();return s.length>0?n=so(s[0]):n=so(e.getBoundingClientRect()),!Vh(e)&&Lu(e)&&jh(n)?WT(e):jh(n)&&Vh(e)&&(t=VT(e))!==null&&t!==void 0?t:n},oo=(e,t)=>{let n=Oh(e,t);return n.width=1,n.right=n.left+1,n},jT=e=>{let t=[],n=a=>{a.height!==0&&(t.length>0&&ST(a,t[t.length-1])||t.push(a))},s=(a,i)=>{let l=$u(a.ownerDocument);if(i<a.data.length){if(Lh(a.data[i]))return;if(Lh(a.data[i-1])&&(l.setStart(a,i),l.setEnd(a,i+1),!Uu(l))){n(oo(xs(l),!1));return}}i>0&&(l.setStart(a,i-1),l.setEnd(a,i),Uu(l)||n(oo(xs(l),!1))),i<a.data.length&&(l.setStart(a,i),l.setEnd(a,i+1),Uu(l)||n(oo(xs(l),!0)))},o=e.container(),r=e.offset();if(ca(o))return s(o,r),t;if(zh(o))if(e.isAtEnd()){let a=zi(o,r);ca(a)&&s(a,a.data.length),la(a)&&!Lu(a)&&n(oo(xs(a),!1))}else{let a=zi(o,r);if(ca(a)&&s(a,0),la(a)&&e.isAtEnd())return n(oo(xs(a),!1)),t;let i=zi(e.container(),e.offset()-1);la(i)&&!Lu(i)&&(Hh(i)||Hh(a)||!la(a))&&n(oo(xs(i),!1)),la(a)&&n(oo(xs(a),!0))}return t},N=(e,t,n)=>{let s=()=>(ca(e),t===0),o=()=>ca(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{let u=$u(e.ownerDocument);return u.setStart(e,t),u.setEnd(e,t),u},a=()=>(n||(n=jT(N(e,t))),n),i=()=>a().length>0,l=u=>u&&e===u.container()&&t===u.offset(),c=u=>zi(e,u?t-1:t);return{container:W(e),offset:W(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:l,getNode:c}};N.fromRangeStart=e=>N(e.startContainer,e.startOffset),N.fromRangeEnd=e=>N(e.endContainer,e.endOffset),N.after=e=>N(e.parentNode,Wh(e)+1),N.before=e=>N(e.parentNode,Wh(e)),N.isAbove=(e,t)=>ct(xt(t.getClientRects()),ps(e.getClientRects()),aa).getOr(!1),N.isBelow=(e,t)=>ct(ps(t.getClientRects()),xt(e.getClientRects()),ia).getOr(!1),N.isAtStart=e=>e?e.isAtStart():!1,N.isAtEnd=e=>e?e.isAtEnd():!1,N.isTextPosition=e=>e?F(e.container()):!1,N.isElementPosition=e=>!N.isTextPosition(e);let Hi=(e,t)=>{F(t)&&t.data.length===0&&e.remove(t)},qT=(e,t,n)=>{t.insertNode(n),Hi(e,n.previousSibling),Hi(e,n.nextSibling)},KT=(e,t,n)=>{let s=m.from(n.firstChild),o=m.from(n.lastChild);t.insertNode(n),s.each(r=>Hi(e,r.previousSibling)),o.each(r=>Hi(e,r.nextSibling))},zu=(e,t,n)=>{lu(n)?KT(e,t,n):qT(e,t,n)},kn=F,qh=Gs,Kh=xe.nodeIndex,Gh=e=>{let t=e.parentNode;return qh(t)?Gh(t):t},Hu=e=>e?hi(e.childNodes,(t,n)=>(qh(n)&&n.nodeName!=="BR"?t=t.concat(Hu(n)):t.push(n),t),[]):[],GT=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&kn(n);)t+=n.data.length;return t},Yh=e=>t=>e===t,YT=e=>{let t,n;t=Hu(Gh(e)),n=Tg(t,Yh(e),e),t=t.slice(0,n+1);let s=hi(t,(o,r,a)=>(kn(r)&&kn(t[a-1])&&o++,o),0);return t=Br(t,vn([e.nodeName])),n=Tg(t,Yh(e),e),n-s},Xh=e=>(kn(e)?"text()":e.nodeName.toLowerCase())+"["+YT(e)+"]",XT=(e,t,n)=>{let s=[];for(let o=t.parentNode;o&&o!==e&&!(n&&n(o));o=o.parentNode)s.push(o);return s},Zh=(e,t)=>{let n=[],s=t.container(),o=t.offset(),r;if(kn(s))r=GT(s,o);else{let i=s.childNodes;o>=i.length?(r="after",o=i.length-1):r="before",s=i[o]}n.push(Xh(s));let a=XT(e,s);return a=Br(a,wr(Gs)),n=n.concat(Fc(a,i=>Xh(i))),n.reverse().join("/")+","+r},ZT=(e,t,n)=>{let s=Hu(e);return s=Br(s,(o,r)=>!kn(o)||!kn(s[r-1])),s=Br(s,vn([t])),s[n]},QT=(e,t)=>{let n=e,s=0;for(;kn(n);){let o=n.data.length;if(t>=s&&t<=s+o){e=n,t=t-s;break}if(!kn(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return kn(e)&&t>e.data.length&&(t=e.data.length),N(e,t)},Qh=(e,t)=>{if(!t)return null;let n=t.split(","),s=n[0].split("/"),o=n.length>1?n[1]:"before",r=hi(s,(a,i)=>{let l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),ZT(a,l[1],parseInt(l[2],10))):null},e);if(!r)return null;if(!kn(r)&&r.parentNode){let a;return o==="after"?a=Kh(r)+1:a=Kh(r),N(r.parentNode,a)}return QT(r,parseInt(o,10))},Wi=Re,JT=(e,t,n)=>{let s=e(t.data.slice(0,n)).length;for(let o=t.previousSibling;o&&F(o);o=o.previousSibling)s+=e(o.data).length;return s},Jh=(e,t,n,s,o)=>{let r=o?s.startContainer:s.endContainer,a=o?s.startOffset:s.endOffset,i=[],l=e.getRoot();if(F(r))i.push(n?JT(t,r,a):a);else{let c=0,u=r.childNodes;a>=u.length&&u.length&&(c=1,a=Math.max(0,u.length-1)),i.push(e.nodeIndex(u[a],n)+c)}for(let c=r;c&&c!==l;c=c.parentNode)i.push(e.nodeIndex(c,n));return i},eD=(e,t,n,s)=>{let o=t.dom,r=Jh(o,e,n,s,!0),a=t.isForward(),i=Bh(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return Q({start:r,forward:a},i);{let l=Jh(o,e,n,s,!1);return Q({start:r,end:l,forward:a},i)}},Wu=(e,t,n)=>{let s=0;return L.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++;return}}),s},eb=(e,t)=>{let n=t?e.startContainer:e.endContainer,s=t?e.startOffset:e.endOffset;if(q(n)&&n.nodeName==="TR"){let o=n.childNodes;n=o[Math.min(t?s:s-1,o.length-1)],n&&(s=t?0:n.childNodes.length,t?e.setStart(n,s):e.setEnd(n,s))}},tb=e=>(eb(e,!0),eb(e,!1),e),nb=(e,t)=>{if(q(e)&&(e=As(e,t),Wi(e)))return e;if(Xt(e)){F(e)&&qo(e)&&(e=e.parentNode);let n=e.previousSibling;if(Wi(n)||(n=e.nextSibling,Wi(n)))return n}},tD=e=>nb(e.startContainer,e.startOffset)||nb(e.endContainer,e.endOffset),sb=(e,t,n)=>{let s=n.getNode(),o=n.getRng();if(s.nodeName==="IMG"||Wi(s)){let a=s.nodeName;return{name:a,index:Wu(n.dom,a,s)}}let r=tD(o);if(r){let a=r.tagName;return{name:a,index:Wu(n.dom,a,r)}}return eD(e,n,t,o)},nD=e=>{let t=e.getRng();return{start:Zh(e.dom.getRoot(),N.fromRangeStart(t)),end:Zh(e.dom.getRoot(),N.fromRangeEnd(t)),forward:e.isForward()}},sD=e=>({rng:e.getRng(),forward:e.isForward()}),ob=(e,t,n)=>{let s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},rb=(e,t)=>{let n=e.dom,s=e.getRng(),o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:Wu(n,i,a)};let c=tb(s.cloneRange());if(!r){c.collapse(!1);let f=ob(n,o+"_end",t);zu(n,c,f)}s=tb(s),s.collapse(!0);let u=ob(n,o+"_start",t);return zu(n,s,u),e.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},oD=(e,t,n=!1)=>t===2?sb(Vt,n,e):t===3?nD(e):t?sD(e):rb(e,!1),Vu=G(sb,$t,!0),rD=e=>e.type==="inline-command"||e.type==="inline-format",aD=e=>e.type==="block-command"||e.type==="block-format",iD=(e,t)=>(e.type==="block-command"||e.type==="block-format")&&e.trigger===t,lD=e=>{var t;let n=o=>zt.error({message:o,pattern:e}),s=(o,r,a)=>{if(e.format!==void 0){let i;if(Be(e.format)){if(!Qn(e.format,ee))return n(o+" pattern has non-string items in the `format` array");i=e.format}else if(ee(e.format))i=[e.format];else return n(o+" pattern has non-string `format` parameter");return zt.value(r(i))}else return e.cmd!==void 0?ee(e.cmd)?zt.value(a(e.cmd,e.value)):n(o+" pattern has non-string `cmd` parameter"):n(o+" pattern is missing both `format` and `cmd` parameters")};if(!ot(e))return n("Raw pattern is not an object");if(!ee(e.start))return n("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!ee(e.end))return n("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return n("Inline pattern has empty `start` and `end` parameters");let o=e.start,r=e.end;return r.length===0&&(r=o,o=""),s("Inline",a=>({type:"inline-format",start:o,end:r,format:a}),(a,i)=>({type:"inline-command",start:o,end:r,cmd:a,value:i}))}else{if(e.replacement!==void 0)return ee(e.replacement)?e.start.length===0?n("Replacement pattern has empty `start` parameter"):zt.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):n("Replacement pattern has non-string `replacement` parameter");{let o=(t=e.trigger)!==null&&t!==void 0?t:"space";return e.start.length===0?n("Block pattern has empty `start` parameter"):s("Block",r=>({type:"block-format",start:e.start,format:r[0],trigger:o}),(r,a)=>({type:"block-command",start:e.start,cmd:r,value:a,trigger:o}))}}},ab=e=>se(e,aD),ib=e=>se(e,rD),cD=(e,t)=>({inlinePatterns:ib(e),blockPatterns:ab(e),dynamicPatternsLookup:t}),ju=(e,t)=>we(Q({},e),{blockPatterns:se(e.blockPatterns,n=>iD(n,t))}),lb=e=>{let t=SA(be(e,lD));return D(t.errors,n=>console.error(n.message,n.pattern)),t.values},uD=e=>t=>{let n=e(t);return lb(n)},fD=(e,t)=>e.dispatch("PreProcess",t),dD=(e,t)=>e.dispatch("PostProcess",t),mD=e=>{e.dispatch("remove")},gD=e=>{e.dispatch("detach")},pD=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},hD=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},bD=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},CD=e=>{e.dispatch("PreInit")},yD=e=>{e.dispatch("PostRender")},vD=e=>{e.dispatch("Init")},ED=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},cb=(e,t,n)=>{e.dispatch(t,n)},ub=(e,t,n,s)=>{e.dispatch("FormatApply",{format:t,node:n,vars:s})},fb=(e,t,n,s)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:s})},SD=(e,t)=>e.dispatch("BeforeSetContent",t),db=(e,t)=>e.dispatch("SetContent",t),wD=(e,t)=>e.dispatch("BeforeGetContent",t),mb=(e,t)=>e.dispatch("GetContent",t),kD=(e,t)=>{e.dispatch("AutocompleterStart",t)},_D=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},qu=(e,t)=>{e.dispatch("AutocompleterUpdateActiveRange",t)},AD=e=>{e.dispatch("AutocompleterEnd")},xD=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),ND=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),gb=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),RD=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),TD=(e,t)=>e.dispatch("DisabledStateChange",{state:t}),Ku=bn().deviceType,DD=Ku.isTouch(),PD=xe.DOM,BD=e=>{let t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return Pt(t,(n,s)=>{let o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[To(r)]=To(a),n},{})},pb=e=>ii(e,RegExp),V=e=>t=>t.options.get(e),Vi=e=>ee(e)||ot(e),hb=(e,t="")=>n=>{let s=ee(n);if(s)if(n.indexOf("=")!==-1){let o=BD(n);return{value:Fe(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},OD=e=>{let t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:hb(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:hb(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{let s=ee(n)&&Pn(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{let s=ke(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>Rn(n)?{valid:!0,value:n}:ee(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{let s=n===!1||ee(n)||zs(n,ee);return s?ee(n)?{value:be(n.split(","),To),valid:s}:Be(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Xu(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{let s=ee(n)||zs(n,ee);return s?{value:Be(n)?n:be(n.split(","),To),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("extended_mathml_attributes",{processor:"string[]"}),t("extended_mathml_elements",{processor:"string[]"}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{let s=Rn(n)||ee(n);return s?n===!1||Ku.isiPhone()||Ku.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!DD}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"string"}),t("service_message",{processor:"string"}),t("onboarding",{processor:"boolean",default:!0}),t("tiny_cloud_entry_url",{processor:"string"}),t("theme",{processor:n=>n===!1||ee(n)||_e(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:n=>{let s=n===!1||ee(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("disabled",{processor:n=>Rn(n)?(e.initialized&&Ki(e)!==n&&Promise.resolve().then(()=>{TD(e,n)}),{valid:!0,value:n}):{valid:!1,message:"The value must be a boolean."},default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area".concat(e.hasPlugin("help")?". Press ALT-0 for help.":"")}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("allow_mathml_annotation_encodings",{processor:n=>{let s=zs(n,ee);return s?{value:n,valid:s}:{valid:!1,message:"Must be an array of strings."}},default:[]}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("pad_empty_with_br",{processor:"boolean",default:!1}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:Vi}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:Vi}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:Vi}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:Vi}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>ee(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("license_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>zs(n,ot)||n===!1?{value:lb(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1",trigger:"space"},{start:"##",format:"h2",trigger:"space"},{start:"###",format:"h3",trigger:"space"},{start:"####",format:"h4",trigger:"space"},{start:"#####",format:"h5",trigger:"space"},{start:"######",format:"h6",trigger:"space"},{start:"1.",cmd:"InsertOrderedList",trigger:"space"},{start:"*",cmd:"InsertUnorderedList",trigger:"space"},{start:"-",cmd:"InsertUnorderedList",trigger:"space"},{start:">",cmd:"mceBlockQuote",trigger:"space"},{start:"---",cmd:"InsertHorizontalRule",trigger:"space"}]}),t("text_patterns_lookup",{processor:n=>_e(n)?{value:uD(n),valid:!0}:{valid:!1,message:"Must be a single function"},default:n=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>zs(n,pb)?{value:n,valid:!0}:pb(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!0}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:n=>{let s=ke(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:n=>{let s=ke(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),t("sandbox_iframes",{processor:"boolean",default:!0}),t("sandbox_iframes_exclusions",{processor:"string[]",default:["youtube.com","youtu.be","vimeo.com","player.vimeo.com","dailymotion.com","embed.music.apple.com","open.spotify.com","giphy.com","dai.ly","codepen.io"]}),t("convert_unsafe_embeds",{processor:"boolean",default:!0}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:Sn.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:PD.getAttrib(e.getElement(),"placeholder")})})},ID=V("iframe_attrs"),FD=V("doctype"),bb=V("document_base_url"),LD=V("body_id"),$D=V("body_class"),Cb=V("content_security_policy"),MD=V("br_in_pre"),pt=V("forced_root_block"),ua=V("forced_root_block_attrs"),UD=V("newline_behavior"),zD=V("br_newline_selector"),HD=V("no_newline_selector"),WD=V("keep_styles"),VD=V("end_container_on_empty_block"),yb=V("automatic_uploads"),vb=V("images_reuse_filename"),jD=V("images_replace_blob_uris"),Eb=V("icons"),qD=V("icons_url"),KD=V("images_upload_url"),GD=V("images_upload_base_path"),YD=V("images_upload_credentials"),XD=V("images_upload_handler"),ZD=V("content_css_cors"),Gu=V("referrer_policy"),Sb=V("language"),QD=V("language_url"),wb=V("indent_use_margin"),JD=V("indentation"),eP=V("content_css"),tP=V("content_style"),kb=V("font_css"),nP=V("directionality"),sP=V("inline_boundaries_selector"),_b=V("object_resizing"),oP=V("resize_img_proportional"),rP=V("placeholder"),Ab=V("event_root"),aP=V("service_message"),Go=V("theme"),iP=V("theme_url"),Yu=V("model"),lP=V("model_url"),fa=V("inline_boundaries"),cP=V("formats"),uP=V("preview_styles"),fP=V("format_empty_lines"),dP=V("format_noneditable_selector"),mP=V("custom_ui_selector"),Xu=V("inline"),gP=V("hidden_input"),pP=V("submit_patch"),hP=V("add_form_submit_trigger"),bP=V("add_unload_trigger"),CP=V("custom_undo_redo_levels"),yP=V("disable_nodechange"),xb=V("readonly"),vP=V("editable_root"),Nb=V("content_css_cors"),ji=V("plugins"),EP=V("external_plugins"),SP=V("block_unsupported_drop"),wP=V("visual"),kP=V("visual_table_class"),Rb=V("visual_anchor_class"),Tb=V("iframe_aria_text"),_P=V("setup"),AP=V("init_instance_callback"),xP=V("urlconverter_callback"),NP=V("auto_focus"),RP=V("browser_spellcheck"),TP=V("protect"),DP=V("paste_block_drop"),qi=V("paste_data_images"),PP=V("paste_preprocess"),BP=V("paste_postprocess"),OP=V("newdocument_content"),IP=V("paste_webkit_styles"),FP=V("paste_remove_styles_if_webkit"),LP=V("paste_merge_formats"),$P=V("smart_paste"),MP=V("paste_as_text"),UP=V("paste_tab_spaces"),zP=V("allow_html_data_urls"),HP=V("text_patterns"),WP=V("text_patterns_lookup"),Db=V("noneditable_class"),VP=V("editable_class"),jP=V("noneditable_regexp"),qP=V("preserve_cdata"),KP=V("highlight_on_focus"),Pb=V("xss_sanitization"),GP=V("init_content_sync"),YP=e=>e.options.isSet("text_patterns_lookup"),XP=e=>L.explode(e.options.get("font_size_style_values")),ZP=e=>L.explode(e.options.get("font_size_classes")),QP=e=>e.options.get("encoding")==="xml",Bb=e=>L.explode(e.options.get("images_file_types")),JP=V("table_tab_navigation"),eB=V("details_initial_state"),tB=V("details_serialized_state"),Ob=V("sandbox_iframes"),Zu=e=>e.options.get("sandbox_iframes_exclusions"),nB=V("convert_unsafe_embeds"),sB=V("license_key"),oB=V("api_key"),Ki=V("disabled"),rB=q,Ib=F,Fb=e=>{let t=e.parentNode;t&&t.removeChild(e)},Lb=e=>{let t=Vt(e);return{count:e.length-t.length,text:t}},$b=e=>{let t;for(;(t=e.data.lastIndexOf(et))!==-1;)e.deleteData(t,1)},Mb=(e,t)=>(ro(e),t),aB=(e,t)=>{let n=Lb(e.data.substr(0,t.offset())),s=Lb(e.data.substr(t.offset()));return(n.text+s.text).length>0?($b(e),N(e,t.offset()-n.count)):t},iB=(e,t)=>{let n=t.container(),s=uA(Mt(n.childNodes),e).map(o=>o<t.offset()?N(n,t.offset()-1):t).getOr(t);return ro(e),s},lB=(e,t)=>Ib(e)&&t.container()===e?aB(e,t):Mb(e,t),cB=(e,t)=>t.container()===e.parentNode?iB(e,t):Mb(e,t),uB=(e,t)=>N.isTextPosition(t)?lB(e,t):cB(e,t),ro=e=>{rB(e)&&Xt(e)&&(Ph(e)?e.removeAttribute("data-mce-caret"):Fb(e)),Ib(e)&&($b(e),e.data.length===0&&Fb(e))},fB=Re,dB=Un,mB=Ri,gB="*[contentEditable=false],video,audio,embed,object",Ub=(e,t,n)=>{let s=Oh(t.getBoundingClientRect(),n),o,r;if(e.tagName==="BODY"){let i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{let i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},pB=e=>{var t,n;let s=mt(C.fromDom(e),gB);for(let o=0;o<s.length;o++){let r=s[o].dom,a=r.previousSibling;if(Mi(a)){let i=a.data;i.length===1?(t=a.parentNode)===null||t===void 0||t.removeChild(a):a.deleteData(i.length-1,1)}a=r.nextSibling,$i(a)&&(a.data.length===1?(n=a.parentNode)===null||n===void 0||n.removeChild(a):a.deleteData(0,1))}},hB=(e,t,n,s)=>{let o=Jn(),r,a,i=pt(e),l=e.dom,c=(p,b)=>{let y;if(u(),mB(b))return null;if(n(b)){let v=vT(i,b,p),E=Ub(t,b,p);l.setStyle(v,"top",E.top),l.setStyle(v,"caret-color","transparent"),a=v;let w=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(w,Q({},E)),l.add(t,w),o.set({caret:w,element:b,before:p}),p&&l.addClass(w,"mce-visual-caret-before"),f(),y=b.ownerDocument.createRange(),y.setStart(v,0),y.setEnd(v,0)}else return a=yT(b,p),y=b.ownerDocument.createRange(),da(a.nextSibling)?(y.setStart(a,0),y.setEnd(a,0)):(y.setStart(a,1),y.setEnd(a,1)),y;return y},u=()=>{pB(t),a&&(ro(a),a=null),o.on(p=>{l.remove(p.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},f=()=>{r=window.setInterval(()=>{o.on(p=>{s()?l.toggleClass(p.caret,"mce-visual-caret-hidden"):l.addClass(p.caret,"mce-visual-caret-hidden")})},500)},d=()=>{o.on(p=>{let b=Ub(t,p.element,p.before);l.setStyles(p.caret,Q({},b))})},g=()=>clearInterval(r),h=()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}";return{isShowing:o.isSet,show:c,hide:u,getCss:h,reposition:d,destroy:g}},zb=()=>ye.browser.isFirefox(),da=e=>fB(e)||dB(e),ma=e=>(da(e)||Mn(e)&&zb())&&zr(C.fromDom(e)).exists(Es),bB=cn,Qu=Re,CB=Un,Hb=Ni("display","block table table-cell table-row table-caption list-item"),Wb=Xt,Vb=qo,yB=q,vB=F,EB=wn,Yo=e=>e===1,ao=e=>e===-1,Gi=(e,t)=>{let n;for(;n=e(t);)if(!Vb(n))return n;return null},ga=(e,t,n,s,o)=>{let r=new st(e,s),a=Qu(e)||Vb(e),i;if(ao(t)){if(a&&(i=Gi(r.prev.bind(r),!0),n(i)))return i;for(;i=Gi(r.prev.bind(r),o);)if(n(i))return i}if(Yo(t)){if(a&&(i=Gi(r.next.bind(r),!0),n(i)))return i;for(;i=Gi(r.next.bind(r),o);)if(n(i))return i}return null},SB=(e,t)=>{let n=o=>bB(o.dom),s=o=>o.dom===t;return os(C.fromDom(e),n,s).map(o=>o.dom).getOr(t)},Ns=(e,t)=>{for(;e&&e!==t;){if(Hb(e))return e;e=e.parentNode}return null},zn=(e,t,n)=>Ns(e.container(),n)===Ns(t.container(),n),Ju=(e,t)=>{if(!t)return m.none();let n=t.container(),s=t.offset();return yB(n)?m.from(n.childNodes[s+e]):m.none()},jb=(e,t)=>{var n;let o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},wB=(e,t,n)=>Ns(t,e)===Ns(n,e),qb=(e,t,n)=>{let s=e?"previousSibling":"nextSibling",o=n;for(;o&&o!==t;){let r=o[s];if(r&&Wb(r)&&(r=r[s]),Qu(r)||CB(r)){if(wB(t,r,o))return r;break}if(EB(r))break;o=o.parentNode}return null},pa=G(jb,!0),ha=G(jb,!1),ef=(e,t,n)=>{let s,o=G(qb,!0,t),r=G(qb,!1,t),a=n.startContainer,i=n.startOffset;if(qo(a)){let l=vB(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(s=l.nextSibling,ma(s)))return pa(s);if(c==="after"&&(s=l.previousSibling,ma(s)))return ha(s)}if(!n.collapsed)return n;if(F(a)){if(Wb(a)){if(e===1){if(s=r(a),s)return pa(s);if(s=o(a),s)return ha(s)}if(e===-1){if(s=o(a),s)return ha(s);if(s=r(a),s)return pa(s)}return n}if(Mi(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?pa(s):n;if($i(a)&&i<=1)return e===-1&&(s=o(a),s)?ha(s):n;if(i===a.data.length)return s=r(a),s?pa(s):n;if(i===0)return s=o(a),s?ha(s):n}return n},Kb=(e,t)=>Ju(e?0:-1,t).filter(Qu),ba=(e,t,n)=>{let s=ef(e,t,n);return e===-1?N.fromRangeStart(s):N.fromRangeEnd(s)},Yi=e=>m.from(e.getNode()).map(C.fromDom),kB=e=>m.from(e.getNode(!0)).map(C.fromDom),tf=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},Xi=(e,t)=>{let n=zn(e,t);return!n&&Le(e.getNode())?!0:n},_B=Re,Hn=F,Gb=q,nf=Le,Xo=wn,Yb=MT,Zi=Uh,AB=(e,t)=>{let n=[],s=e;for(;s&&s!==t;)n.push(s),s=s.parentNode;return n},Xb=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,Zb=(e,t)=>{if(Yo(e)){if(Xo(t.previousSibling)&&!Hn(t.previousSibling))return N.before(t);if(Hn(t))return N(t,0)}if(ao(e)){if(Xo(t.nextSibling)&&!Hn(t.nextSibling))return N.after(t);if(Hn(t))return N(t,t.data.length)}return ao(e)?nf(t)?N.before(t):N.after(t):N.before(t)},xB=(e,t)=>{let n=t.nextSibling;return n&&Xo(n)?Hn(n)?N(n,0):N.before(n):sf(1,N.after(t),e)},sf=(e,t,n)=>{let s,o,r,a;if(!Gb(n)||!t)return null;if(t.isEqual(N.after(n))&&n.lastChild){if(a=N.after(n.lastChild),ao(e)&&Xo(n.lastChild)&&Gb(n.lastChild))return nf(n.lastChild)?N.before(n.lastChild):a}else a=t;let i=a.container(),l=a.offset();if(Hn(i)){if(ao(e)&&l>0)return N(i,--l);if(Yo(e)&&l<i.length)return N(i,++l);s=i}else{if(ao(e)&&l>0&&(o=Xb(i,l-1),Xo(o)))return!Yb(o)&&(r=ga(o,e,Zi,o),r)?Hn(r)?N(r,r.data.length):N.after(r):Hn(o)?N(o,o.data.length):N.before(o);if(Yo(e)&&l<i.childNodes.length&&(o=Xb(i,l),Xo(o)))return nf(o)?xB(n,o):!Yb(o)&&(r=ga(o,e,Zi,o),r)?Hn(r)?N(r,0):N.before(r):Hn(o)?N(o,0):N.after(o);s=o||a.getNode()}if(s&&(Yo(e)&&a.isAtEnd()||ao(e)&&a.isAtStart())&&(s=ga(s,e,He,n,!0),Zi(s,n)))return Zb(e,s);o=s&&ga(s,e,Zi,n);let c=Ws(se(AB(i,n),_B));return c&&(!o||!c.contains(o))?(Yo(e)?a=N.after(c):a=N.before(c),a):o?Zb(e,o):null},Wn=e=>({next:t=>sf(1,t,e),prev:t=>sf(-1,t,e)}),NB=(e,t,n)=>{let s=e?N.before(n):N.after(n);return Zt(e,t,s)},RB=e=>Le(e)?N.before(e):N.after(e),Qb=e=>N.isTextPosition(e)?e.offset()===0:wn(e.getNode()),Jb=e=>{if(N.isTextPosition(e)){let t=e.container();return e.offset()===t.data.length}else return wn(e.getNode(!0))},eC=(e,t)=>!N.isTextPosition(e)&&!N.isTextPosition(t)&&e.getNode()===t.getNode(!0),TB=e=>!N.isTextPosition(e)&&Le(e.getNode()),DB=(e,t,n)=>e?!eC(t,n)&&!TB(t)&&Jb(t)&&Qb(n):!eC(n,t)&&Qb(t)&&Jb(n),Zt=(e,t,n)=>{let s=Wn(t);return m.from(e?s.next(n):s.prev(n))},Zo=(e,t,n)=>Zt(e,t,n).bind(s=>zn(n,s,t)&&DB(e,n,s)?Zt(e,t,s):m.some(s)),tC=(e,t,n,s)=>Zo(e,t,n).bind(o=>s(o)?tC(e,t,o,s):m.some(o)),Qo=(e,t)=>{let n=e?t.firstChild:t.lastChild;return F(n)?m.some(N(n,e?0:n.data.length)):n?wn(n)?m.some(e?N.before(n):RB(n)):NB(e,t,n):m.none()},Rt=G(Zt,!0),Ot=G(Zt,!1),ht=G(Qo,!0),un=G(Qo,!1),of="_mce_caret",Qt=e=>q(e)&&e.id===of,io=(e,t)=>{let n=t;for(;n&&n!==e;){if(Qt(n))return n;n=n.parentNode}return null},PB=e=>ee(e.start),BB=e=>oe(e,"rng"),OB=e=>oe(e,"id"),nC=e=>oe(e,"name"),sC=e=>L.isArray(e.start),Qi=e=>!nC(e)&&Rn(e.forward)?e.forward:!0,oC=(e,t)=>(q(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),IB=(e,t)=>{let n=m.from(Qh(e.getRoot(),t.start)),s=m.from(Qh(e.getRoot(),t.end));return ct(n,s,(o,r)=>{let a=e.createRng();return a.setStart(o.container(),o.offset()),a.setEnd(r.container(),r.offset()),{range:a,forward:Qi(t)}})},FB=(e,t)=>{var n;let o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(et);e.appendChild(o),t.setStart(o,0),t.setEnd(o,0)},LB=e=>!e.hasChildNodes(),$B=(e,t)=>un(e).fold(Oe,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),rC=(e,t,n)=>LB(t)&&io(e,t)?(FB(t,n),!0):!1,aC=(e,t,n,s)=>{let o=n[t?"start":"end"],r=e.getRoot();if(o){let a=r,i=o[0];for(let l=o.length-1;a&&l>=1;l--){let c=a.childNodes;if(rC(r,a,s))return!0;if(o[l]>c.length-1)return rC(r,a,s)?!0:$B(a,s);a=c[o[l]]}F(a)&&(i=Math.min(o[0],a.data.length)),q(a)&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},rf=e=>F(e)&&e.data.length>0,iC=(e,t,n)=>{let s=e.get(n.id+"_"+t),o=s?.parentNode,r=n.keep;if(s&&o){let a,i;if(t==="start"?r?s.hasChildNodes()?(a=s.firstChild,i=1):rf(s.nextSibling)?(a=s.nextSibling,i=0):rf(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)+1):(a=o,i=e.nodeIndex(s)):r?s.hasChildNodes()?(a=s.firstChild,i=1):rf(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)):(a=o,i=e.nodeIndex(s)),!r){let l=s.previousSibling,c=s.nextSibling;L.each(L.grep(s.childNodes),f=>{F(f)&&(f.data=f.data.replace(/\uFEFF/g,""))});let u;for(;u=e.get(n.id+"_"+t);)e.remove(u,!0);if(F(c)&&F(l)&&!ye.browser.isOpera()){let f=l.data.length;l.appendData(c.data),e.remove(c),a=l,i=f}}return m.some(N(a,i))}else return m.none()},MB=(e,t)=>{let n=e.createRng();return aC(e,!0,t,n)&&aC(e,!1,t,n)?m.some({range:n,forward:Qi(t)}):m.none()},UB=(e,t)=>{let n=iC(e,"start",t),s=iC(e,"end",t);return ct(n,s.or(n),(o,r)=>{let a=e.createRng();return a.setStart(oC(e,o.container()),o.offset()),a.setEnd(oC(e,r.container()),r.offset()),{range:a,forward:Qi(t)}})},zB=(e,t)=>m.from(e.select(t.name)[t.index]).map(n=>{let s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),HB=(e,t)=>{let n=e.dom;if(t){if(sC(t))return MB(n,t);if(PB(t))return IB(n,t);if(OB(t))return UB(n,t);if(nC(t))return zB(n,t);if(BB(t))return m.some({range:t.rng,forward:Qi(t)})}return m.none()},WB=(e,t,n)=>oD(e,t,n),VB=(e,t)=>{HB(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},Jt=e=>q(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",Ji=(e=>t=>e===t)(Je),lo=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,af=e=>!lo(e)&&!Ji(e)&&!Oc(e),lf=e=>{let t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},jB=e=>Yt(e,t=>{let n=Ui(t);return n?[C.fromDom(n)]:[]}),qB=e=>lf(e).length>1,KB=e=>se(jB(e),ra),GB=e=>mt(e,"td[data-mce-selected],th[data-mce-selected]"),lC=(e,t)=>{let n=GB(t);return n.length>0?n:KB(e)},Jo=e=>lC(lf(e.selection.getSel()),C.fromDom(e.getBody())),Ca=(e,t)=>qr(e,"table",t),YB=e=>{let t=e.startContainer,n=e.startOffset;return F(t)?n===0?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n]).map(C.fromDom)},XB=e=>{let t=e.endContainer,n=e.endOffset;return F(t)?n===t.data.length?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n-1]).map(C.fromDom)},cC=e=>zc(e).fold(W([e]),t=>[e].concat(cC(t))),cf=e=>Hc(e).fold(W([e]),t=>Ce(t)==="br"?bs(t).map(n=>[e].concat(cf(n))).getOr([]):[e].concat(cf(t))),uf=(e,t)=>ct(YB(t),XB(t),(n,s)=>{let o=Ze(cC(e),G(Se,n)),r=Ze(cf(e),G(Se,s));return o.isSome()&&r.isSome()}).getOr(!1),ff=(e,t,n,s)=>{let o=n,r=new st(n,o),a=Rr(e.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!ke(["td","th","table"],c.toLowerCase())),i=n;do{if(F(i)&&L.trim(i.data).length!==0){s?t.setStart(i,0):t.setEnd(i,i.data.length);return}if(a[i.nodeName]){s?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i);return}}while(i=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},el=e=>{let t=e.selection.getSel();return U(t)&&t.rangeCount>0},df=(e,t)=>{let n=Jo(e);n.length>0?D(n,s=>{let o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},uC=(e,t,n)=>{let s=rb(e,t);n(s),e.moveToBookmark(s)},ya=e=>ln(e?.nodeType),mf=e=>q(e)&&!Jt(e)&&!Qt(e)&&!Gs(e),ZB=(e,t)=>{if(mf(t)&&!/^(TD|TH)$/.test(t.nodeName)){let n=e.getAttrib(t,"data-mce-selected"),s=parseInt(n,10);return!isNaN(s)&&s>0}else return!1},fC=(e,t,n)=>{let{selection:s,dom:o}=e,r=s.getNode(),a=Re(r);uC(s,!0,()=>{t()}),a&&Re(r)&&o.isChildOf(r,e.getBody())?e.selection.select(r):n(s.getStart())&&QB(o,s)},QB=(e,t)=>{var n,s;let o=t.getRng(),{startContainer:r,startOffset:a}=o,i=t.getNode();if(!ZB(e,i)&&q(r)){let l=r.childNodes,c=e.getRoot(),u;if(a<l.length){let f=l[a];u=new st(f,(n=e.getParent(f,e.isBlock))!==null&&n!==void 0?n:c)}else{let f=l[l.length-1];u=new st(f,(s=e.getParent(f,e.isBlock))!==null&&s!==void 0?s:c),u.next(!0)}for(let f=u.current();f;f=u.next()){if(e.getContentEditable(f)==="false")return;if(F(f)&&!pf(f)){o.setStart(f,0),t.setRng(o);return}}}},dC=(e,t,n)=>{if(e){let s=t?"nextSibling":"previousSibling";for(e=n?e:e[s];e;e=e[s])if(q(e)||!pf(e))return e}},gf=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||Xs(e,t),er=(e,t,n)=>e.schema.isValidChild(t,n),pf=(e,t=!1)=>{if(U(e)&&F(e)){let n=t?e.data.replace(/ /g,"\xA0"):e.data;return $o(n)}else return!1},JB=e=>U(e)&&F(e)&&e.length===0,e1=(e,t)=>{let n="[data-mce-cef-wrappable]",s=dP(e),o=Dr(s)?n:`${n},${s}`;return Cn(C.fromDom(t),o)},mC=(e,t)=>{let n=e.dom;return mf(t)&&n.getContentEditable(t)==="false"&&e1(e,t)&&n.select('[contenteditable="true"]',t).length===0},Rs=(e,t)=>_e(e)?e(t):(U(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),hf=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),bf=(e,t)=>{if(qe(e))return null;{let n=String(e);return(t==="color"||t==="backgroundColor")&&(n=Zr(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},tl=(e,t,n)=>{let s=e.getStyle(t,n);return bf(s,n)},gC=(e,t)=>{let n;return e.getParent(t,s=>q(s)?(n=e.getStyle(s,"text-decoration"),!!n&&n!=="none"):!1),n},nl=(e,t,n)=>e.getParents(t,n,e.getRoot()),Cf=(e,t,n)=>{let s=e.formatter.get(t);return U(s)&&Ie(s,n)},t1=(e,t)=>Cf(e,t,s=>{let o=r=>_e(r)||r.length>1&&r.charAt(0)==="%";return Ie(["styles","attributes"],r=>Fe(s,r).exists(a=>{let i=Be(a)?a:Tc(a);return Ie(i,o)}))}),n1=(e,t,n)=>{let s=["inline","block","selector","attributes","styles","classes"],o=r=>Rr(r,(a,i)=>Ie(s,l=>l===i));return Cf(e,t,r=>{let a=o(r);return Cf(e,n,i=>{let l=o(i);return gA(a,l)})})},Vn=e=>xo(e,"block"),s1=e=>Vn(e)&&e.wrapper===!0,o1=e=>Vn(e)&&e.wrapper!==!0,en=e=>xo(e,"selector"),tt=e=>xo(e,"inline"),r1=e=>en(e)&&tt(e)&&No(Fe(e,"mixed"),!0),yf=e=>en(e)&&e.expand!==!1&&!tt(e),a1=e=>{let t=[],n=e;for(;n;){if(F(n)&&n.data!==et||n.childNodes.length>1)return[];q(n)&&t.push(n),n=n.firstChild}return t},pC=e=>a1(e).length>0,vf=e=>Qt(e.dom)&&pC(e.dom),tr=Jt,hC=nl,bC=pf,i1=gf,l1=e=>Le(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,CC=(e,t)=>{let n=t;for(;n;){if(q(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},yC=(e,t,n,s)=>{let o=t.data;if(e){for(let r=n;r>0;r--)if(s(o.charAt(r-1)))return r}else for(let r=n;r<o.length;r++)if(s(o.charAt(r)))return r;return-1},c1=(e,t,n)=>yC(e,t,n,s=>Ji(s)||lo(s)),u1=(e,t,n)=>yC(e,t,n,af),vC=(e,t,n,s,o,r)=>{let a,i=e.getParent(n,f=>cu(f)||e.isBlock(f)),l=U(i)?i:t,c=(f,d,g)=>{let h=to(e),p=o?h.backwards:h.forwards;return m.from(p(f,d,(b,y)=>tr(b.parentNode)?-1:(a=b,g(o,b,y)),l))};return c(n,s,c1).bind(f=>r?c(f.container,f.offset+(o?-1:0),u1):m.some(f)).orThunk(()=>a?m.some({container:a,offset:o?0:a.length}):m.none())},EC=(e,t,n,s,o)=>{let r=s[o];F(s)&&Dr(s.data)&&r&&(s=r);let a=hC(e,s);for(let i=0;i<a.length;i++)for(let l=0;l<t.length;l++){let c=t[l];if(!(U(c.collapsed)&&c.collapsed!==n.collapsed)&&en(c)&&e.is(a[i],c.selector))return a[i]}return s},SC=(e,t,n,s)=>{var o;let r=n,a=e.getRoot(),i=t[0];if(Vn(i)&&(r=i.wrapper?null:e.getParent(n,i.block,a)),!r){let l=(o=e.getParent(n,"LI,TD,TH,SUMMARY"))!==null&&o!==void 0?o:a;r=e.getParent(F(n)?n.parentNode:n,c=>c!==a&&i1(e.schema,c),l)}if(r&&Vn(i)&&i.wrapper&&(r=hC(e,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r&&r[s]&&!e.isBlock(r[s])&&(r=r[s],!hf(r,"br")););return r||n},wC=(e,t,n,s)=>{let o=n.parentNode;return U(n[s])?!1:o===t||qe(o)||e.isBlock(o)?!0:wC(e,t,o,s)},sl=(e,t,n,s,o,r)=>{let a=n,i=o?"previousSibling":"nextSibling",l=e.getRoot();if(F(n)&&!bC(n)&&(o?s>0:s<n.data.length))return n;for(;a;){if(cu(a))return n;if(!t[0].block_expand&&e.isBlock(a))return r?a:n;for(let c=a[i];c;c=c[i]){let u=F(c)&&!wC(e,l,c,i);if(!tr(c)&&!l1(c)&&!bC(c,u))return a}if(a===l||a.parentNode===l){n=a;break}a=a.parentNode}return n},kC=e=>tr(e.parentNode)||tr(e),co=(e,t,n,s={})=>{let{includeTrailingSpace:o=!1,expandToBlock:r=!0}=s,a=e.getParent(t.commonAncestorContainer,g=>cu(g)),i=U(a)?a:e.getRoot(),{startContainer:l,startOffset:c,endContainer:u,endOffset:f}=t,d=n[0];return q(l)&&l.hasChildNodes()&&(l=As(l,c),F(l)&&(c=0)),q(u)&&u.hasChildNodes()&&(u=As(u,t.collapsed?f:f-1),F(u)&&(f=u.data.length)),l=CC(e,l),u=CC(e,u),kC(l)&&(l=tr(l)?l:l.parentNode,t.collapsed?l=l.previousSibling||l:l=l.nextSibling||l,F(l)&&(c=t.collapsed?l.length:0)),kC(u)&&(u=tr(u)?u:u.parentNode,t.collapsed?u=u.nextSibling||u:u=u.previousSibling||u,F(u)&&(f=t.collapsed?0:u.length)),t.collapsed&&(vC(e,i,l,c,!0,o).each(({container:p,offset:b})=>{l=p,c=b}),vC(e,i,u,f,!1,o).each(({container:p,offset:b})=>{u=p,f=b})),(tt(d)||d.block_expand)&&((!tt(d)||!F(l)||c===0)&&(l=sl(e,n,l,c,!0,r)),(!tt(d)||!F(u)||f===u.data.length)&&(u=sl(e,n,u,f,!1,r))),yf(d)&&(l=EC(e,n,t,l,"previousSibling"),u=EC(e,n,t,u,"nextSibling")),(Vn(d)||en(d))&&(l=SC(e,n,l,"previousSibling"),u=SC(e,n,u,"nextSibling"),Vn(d)&&(e.isBlock(l)||(l=sl(e,n,l,c,!0,r),F(l)&&(c=0)),e.isBlock(u)||(u=sl(e,n,u,f,!1,r),F(u)&&(f=u.data.length)))),q(l)&&l.parentNode&&(c=e.nodeIndex(l),l=l.parentNode),q(u)&&u.parentNode&&(f=e.nodeIndex(u)+1,u=u.parentNode),{startContainer:l,startOffset:c,endContainer:u,endOffset:f}},va=(e,t,n)=>{var s;let o=t.startOffset,r=As(t.startContainer,o),a=t.endOffset,i=As(t.endContainer,a-1),l=b=>{let y=b[0];F(y)&&y===r&&o>=y.data.length&&b.splice(0,1);let v=b[b.length-1];return a===0&&b.length>0&&v===i&&F(v)&&b.splice(b.length-1,1),b},c=(b,y,v)=>{let E=[];for(;b&&b!==v;b=b[y])E.push(b);return E},u=(b,y)=>e.getParent(b,v=>v.parentNode===y,y),f=(b,y,v)=>{let E=v?"nextSibling":"previousSibling";for(let w=b,T=w.parentNode;w&&w!==y;w=T){T=w.parentNode;let B=c(w===b?w:w[E],E);B.length&&(v||B.reverse(),n(l(B)))}};if(r===i)return n(l([r]));let d=(s=e.findCommonAncestor(r,i))!==null&&s!==void 0?s:e.getRoot();if(e.isChildOf(r,i))return f(r,d,!0);if(e.isChildOf(i,r))return f(i,d);let g=u(r,d)||r,h=u(i,d)||i;f(r,g,!0);let p=c(g===r?g:g.nextSibling,"nextSibling",h===i?h.nextSibling:h);p.length&&n(l(p)),f(i,h)},f1=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]","div.mce-footnotes"],d1=e=>Nt(e)&&jr(e)===et,m1=(e,t,n,s)=>zr(t).fold(()=>"skipping",o=>s==="br"||d1(t)?"valid":nT(t)?"existing":Qt(t.dom)?"caret":Ie(f1,r=>Cn(t,r))?"valid-block":!er(e,n,s)||!er(e,Ce(o),n)?"invalid-child":"valid"),g1=(e,t)=>{let n=co(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},_C=(e,t,n,s,o,r)=>{let u=n,{uid:a=t}=u,i=Q_(u,["uid"]);Fo(e,ta()),at(e,`${zo()}`,a),at(e,`${eo()}`,s);let{attributes:l={},classes:c=[]}=o(a,i);if(ns(e,l),Qx(e,c),r){c.length>0&&at(e,`${sa()}`,c.join(","));let f=Ut(l);f.length>0&&at(e,`${oa()}`,f.join(","))}},p1=e=>{Gr(e,ta()),it(e,`${zo()}`),it(e,`${eo()}`),it(e,`${na()}`);let t=ss(e,`${oa()}`).map(s=>s.split(",")).getOr([]),n=ss(e,`${sa()}`).map(s=>s.split(",")).getOr([]);D(t,s=>it(e,s)),Jx(e,n),it(e,`${sa()}`),it(e,`${oa()}`)},AC=(e,t,n,s,o)=>{let r=C.fromTag("span",e);return _C(r,t,n,s,o,!1),r},h1=(e,t,n,s,o,r)=>{let a=[],i=AC(e.getDoc(),n,r,s,o),l=Jn(),c=()=>{l.clear()},u=()=>l.get().getOrThunk(()=>{let h=qs(i);return a.push(h),l.set(h),h}),f=h=>{D(h,d)},d=h=>{switch(m1(e,h,"span",Ce(h))){case"invalid-child":{c();let b=dt(h);f(b),c();break}case"valid-block":{c(),_C(h,n,r,s,o,!0);break}case"valid":{let b=u();hp(h,b);break}}},g=h=>{let p=be(h,C.fromDom);f(p)};return va(e.dom,t,h=>{c(),g(h)}),a},b1=(e,t,n,s)=>{e.undoManager.transact(()=>{let o=e.selection,r=o.getRng(),a=Jo(e).length>0,i=Tr("mce-annotation");if(r.collapsed&&!a&&g1(e,r),o.getRng().collapsed&&!a){let l=AC(e.getDoc(),i,s,t,n.decorate);yi(l,Je),o.getRng().insertNode(l.dom),o.select(l.dom)}else uC(o,!1,()=>{df(e,l=>{h1(e,l,i,t,n.decorate,s)})})})},xC=e=>{let t=rT();oT(e,t);let n=sT(e,t),s=Mr("span"),o=r=>{D(r,a=>{s(a)?ys(a):p1(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{b1(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{Ah(e,m.some(r)).each(({elements:a})=>{let i=e.selection.getBookmark();o(a),e.selection.moveToBookmark(i)})},removeAll:r=>{let a=e.selection.getBookmark();Ne(Rh(e,r),(i,l)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{let a=Rh(e,r);return ui(a,i=>be(i,l=>l.dom))}}},Ea=e=>({getBookmark:G(WB,e),moveToBookmark:G(VB,e)});Ea.isBookmarkNode=Jt;let NC=(e,t,n)=>n.collapsed?!1:Ie(n.getClientRects(),s=>wT(s,e,t)),RC=(e,t)=>{let n=Nt(t)?jr(t).length:dt(t).length+1;return e>n?n:e<0?0:e},C1=e=>Lo.range(e.start,RC(e.soffset,e.start),e.finish,RC(e.foffset,e.finish)),TC=(e,t)=>!xi(t.dom)&&(yn(e,t)||Se(e,t)),DC=e=>t=>TC(e,t.start)&&TC(e,t.finish),y1=e=>e.inline||ye.browser.isFirefox(),v1=e=>Lo.range(C.fromDom(e.startContainer),e.startOffset,C.fromDom(e.endContainer),e.endOffset),E1=e=>{let t=e.getSelection();return(!t||t.rangeCount===0?m.none():m.from(t.getRangeAt(0))).map(v1)},S1=e=>{let t=Ur(e);return E1(t.dom).filter(DC(e))},w1=(e,t)=>m.from(t).filter(DC(e)).map(C1),k1=e=>{let t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),m.some(t)}catch{return m.none()}},ol=e=>{let t=y1(e)?S1(C.fromDom(e.getBody())):m.none();e.bookmark=t.isSome()?t:e.bookmark},Ef=e=>(e.bookmark?e.bookmark:m.none()).bind(n=>w1(C.fromDom(e.getBody()),n)).bind(k1),_1=e=>{Ef(e).each(t=>e.selection.setRng(t))},PC={isEditorUIElement:e=>{let t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},A1=(e,t)=>(ln(t)||(t=0),window.setTimeout(e,t)),x1=(e,t)=>(ln(t)||(t=0),window.setInterval(e,t)),tn={setEditorTimeout:(e,t,n)=>A1(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{let s=x1(()=>{e.removed?window.clearInterval(s):t()},n);return s}},BC=(e,t)=>e.view(t).fold(W([]),s=>{let o=e.owner(s),r=BC(e,o);return[s].concat(r)}),N1=(e,t)=>{let n=t.owner(e);return BC(t,n)};var R1=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?m.none():m.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(C.fromDom)},owner:e=>hs(e)});let OC=e=>{let t=mp(),n=Zc(t),s=N1(e,R1),o=Xc(e),r=_r(s,(a,i)=>{let l=Xc(i);return{left:a.left+l.left,top:a.top+l.top}},{left:0,top:0});return Oo(r.left+o.left+n.left,r.top+o.top+n.top)},T1=e=>e.type==="nodechange"&&e.selectionChange,D1=(e,t)=>{let n=()=>{t.throttle()};xe.DOM.bind(document,"mouseup",n),e.on("remove",()=>{xe.DOM.unbind(document,"mouseup",n)})},P1=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},B1=(e,t)=>{P1(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{T1(n)||ol(e)})},O1=e=>{let t=gi(()=>{ol(e)},0);e.on("init",()=>{e.inline&&D1(e,t),B1(e,t)}),e.on("remove",()=>{t.cancel()})},nr,Sf=xe.DOM,I1=e=>q(e)&&PC.isEditorUIElement(e),wf=e=>{let t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},rl=(e,t)=>{let n=mP(e);return Sf.getParent(t,o=>I1(o)||(n?e.dom.is(o,n):!1))!==null},kf=e=>{try{let t=Cs(C.fromDom(e.getElement()));return qc(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},F1=(e,t)=>{let n=t.editor;O1(n);let s=(r,a)=>{if(KP(r)&&r.inline!==!0){let i=C.fromDom(r.getContainer());a(i,"tox-edit-focus")}},o=r=>{if(!r.iframeElement)return;let i=C.fromDom(r.iframeElement),l=OC(i),c=au(window);(l.top<c.y||l.top>c.bottom-25)&&i.dom.scrollIntoView({block:"center"})};n.on("focusin",()=>{let r=e.focusedEditor;if(wf(kf(n))&&s(n,Fo),r!==n){r&&r.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:r}),n.focus(!0);let a=bn().browser;n.inline!==!0&&(a.isSafari()||a.isChromium())&&o(n)}}),n.on("focusout",()=>{tn.setEditorTimeout(n,()=>{let r=e.focusedEditor;(!wf(kf(n))||r!==n)&&s(n,Gr),!rl(n,kf(n))&&r===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),nr||(nr=r=>{let a=e.activeEditor;a&&dp(r).each(i=>{let l=i;l.ownerDocument===document&&l!==document.body&&!rl(a,l)&&e.focusedEditor===a&&(a.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},Sf.bind(document,"focusin",nr))},L1=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&nr&&(Sf.unbind(document,"focusin",nr),nr=null)},$1=e=>{e.on("AddEditor",G(F1,e)),e.on("RemoveEditor",G(L1,e))},M1=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),U1=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="false")!==null,z1=e=>e.collapsed?m.from(As(e.startContainer,e.startOffset)).map(C.fromDom):m.none(),H1=(e,t)=>z1(t).bind(n=>mT(n)?m.some(n):yn(e,n)?m.none():m.some(e)),IC=(e,t)=>{H1(C.fromDom(e.getBody()),t).bind(n=>ht(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},al=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},W1=e=>pp(e)||Dx(e).isSome(),V1=e=>U(e.iframeElement)&&pp(C.fromDom(e.iframeElement)),j1=e=>{let t=e.getBody();return t&&W1(C.fromDom(t))},q1=e=>{let t=Cs(C.fromDom(e.getElement()));return qc(t).filter(n=>!wf(n.dom)&&rl(e,n.dom)).isSome()},sr=e=>e.inline?j1(e):V1(e),_f=e=>sr(e)||q1(e),K1=e=>{let t=e.selection,n=e.getBody(),s=t.getRng();e.quirks.refreshContentEditable();let o=a=>{Ef(a).each(i=>{a.selection.setRng(i),s=i})};!sr(e)&&e.hasEditableRoot()&&o(e);let r=M1(e,t.getNode());if(r&&e.dom.isChildOf(r,n)){U1(e,r)||al(n),al(r),e.hasEditableRoot()||o(e),IC(e,s),Af(e);return}e.inline||(ye.browser.isOpera()||al(n),e.getWin().focus()),(ye.browser.isFirefox()||e.inline)&&(al(n),IC(e,s)),Af(e)},Af=e=>e.editorManager.setActive(e),G1=(e,t)=>{e.removed||(t?Af(e):K1(e))},j={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||j.metaKeyPressed(e),metaKeyPressed:e=>ye.os.isMacOS()||ye.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},uo="data-mce-selected",Y1="table,img,figure.image,hr,video,span.mce-preview-object,details",FC=Math.abs,il=Math.round,xf={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},X1=e=>e.type==="longpress"||e.type.indexOf("touch")===0,LC=(e,t)=>{let n=t.dom,s=t.getDoc(),o=document,r=t.getBody(),a,i,l,c,u,f,d,g,h,p,b,y,v,E,w,T=R=>U(R)&&(Vp(R)||n.is(R,"figure.image")),B=R=>Un(R)||n.hasClass(R,"mce-preview-object"),H=(R,O)=>{if(X1(R)){let K=R.touches[0];return T(R.target)&&!NC(K.clientX,K.clientY,O)}else return T(R.target)&&!NC(R.clientX,R.clientY,O)},x=R=>{let O=R.target;H(R,t.selection.getRng())&&!R.isDefaultPrevented()&&t.selection.select(O)},_=R=>n.hasClass(R,"mce-preview-object")&&U(R.firstElementChild)?[R,R.firstElementChild]:n.is(R,"figure.image")?[R.querySelector("img")]:[R],P=R=>{let O=_b(t);return!O||t.mode.isReadOnly()||R.getAttribute("data-mce-resize")==="false"||R===t.getBody()?!1:n.hasClass(R,"mce-preview-object")&&U(R.firstElementChild)?Cn(C.fromDom(R.firstElementChild),O):Cn(C.fromDom(R),O)},z=(R,O)=>{if(B(O))return R.create("img",{src:ye.transparentSrc});if(Mn(O)){let le=Qe(c.name,"n")?xt:ps,ue=O.cloneNode(!0);return le(R.select("tr",ue)).each(ve=>{let rn=R.select("td,th",ve);R.setStyle(ve,"height",null),D(rn,Yn=>R.setStyle(Yn,"height",null))}),ue}else return O.cloneNode(!0)},X=(R,O,K)=>{if(U(K)){let le=_(R);D(le,ue=>{ue.style[O]||!t.schema.isValid(ue.nodeName.toLowerCase(),O)?n.setStyle(ue,O,K):n.setAttrib(ue,O,""+K)})}},re=(R,O,K)=>{X(R,"width",O),X(R,"height",K)},ie=R=>{let O,K,le,ue,ve;O=R.screenX-f,K=R.screenY-d,y=O*c[2]+g,v=K*c[3]+h,y=y<5?5:y,v=v<5?5:v,(T(a)||B(a))&&oP(t)!==!1?le=!j.modifierPressed(R):le=j.modifierPressed(R),le&&(FC(O)>FC(K)?(v=il(y*p),y=il(v/p)):(y=il(v/p),v=il(y*p))),re(i,y,v),ue=c.startPos.x+O,ve=c.startPos.y+K,ue=ue>0?ue:0,ve=ve>0?ve:0,n.setStyles(l,{left:ue,top:ve,display:"block"}),l.innerHTML=y+" &times; "+v,O=r.scrollWidth-E,K=r.scrollHeight-w,O+K!==0&&n.setStyles(l,{left:ue-O,top:ve-K}),b||(hD(t,a,g,h,"corner-"+c.name),b=!0)},pe=()=>{let R=b;b=!1,R&&(X(a,"width",y),X(a,"height",v)),n.unbind(s,"mousemove",ie),n.unbind(s,"mouseup",pe),o!==s&&(n.unbind(o,"mousemove",ie),n.unbind(o,"mouseup",pe)),n.remove(i),n.remove(l),n.remove(u),Ee(a),R&&(bD(t,a,y,v,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},Ee=R=>{Y();let O=n.getPos(R,r),K=O.x,le=O.y,ue=R.getBoundingClientRect(),ve=ue.width||ue.right-ue.left,rn=ue.height||ue.bottom-ue.top;a!==R&&(We(),a=R,y=v=0);let Yn=t.dispatch("ObjectSelected",{target:R});P(R)&&!Yn.isDefaultPrevented()?Ne(xf,(wt,mn)=>{let Kt=kt=>{let an=_(a)[0];f=kt.screenX,d=kt.screenY,g=an.clientWidth,h=an.clientHeight,p=h/g,c=wt,c.name=mn,c.startPos={x:ve*wt[0]+K,y:rn*wt[1]+le},E=r.scrollWidth,w=r.scrollHeight,u=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=z(n,a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:K,top:le,margin:0}),re(i,ve,rn),i.removeAttribute(uo),r.appendChild(i),n.bind(s,"mousemove",ie),n.bind(s,"mouseup",pe),o!==s&&(n.bind(o,"mousemove",ie),n.bind(o,"mouseup",pe)),l=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+h)},bt=n.get("mceResizeHandle"+mn);bt&&n.remove(bt),bt=n.add(r,"div",{id:"mceResizeHandle"+mn,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+mn+"-resize; margin:0; padding:0"}),n.bind(bt,"mousedown",kt=>{kt.stopImmediatePropagation(),kt.preventDefault(),Kt(kt)}),wt.elm=bt,n.setStyles(bt,{left:ve*wt[0]+K-bt.offsetWidth/2,top:rn*wt[1]+le-bt.offsetHeight/2})}):We(!1)},Ue=gi(Ee,0),We=(R=!0)=>{Ue.cancel(),Y(),a&&R&&a.removeAttribute(uo),Ne(xf,(O,K)=>{let le=n.get("mceResizeHandle"+K);le&&(n.unbind(le),n.remove(le))})},Ye=(R,O)=>n.isChildOf(R,O),M=R=>{if(b||t.removed||t.composing)return;let O=R.type==="mousedown"?R.target:e.getNode(),K=Io(C.fromDom(O),Y1).map(ue=>ue.dom).filter(ue=>n.isEditable(ue.parentElement)||ue.nodeName==="IMG"&&n.isEditable(ue)).getOrUndefined(),le=U(K)?n.getAttrib(K,uo,"1"):"1";if(D(n.select(`img[${uo}],hr[${uo}]`),ue=>{ue.removeAttribute(uo)}),U(K)&&Ye(K,r)&&_f(t)){ge();let ue=e.getStart(!0);if(Ye(ue,K)&&Ye(e.getEnd(!0),K)){n.setAttrib(K,uo,le),Ue.throttle(K);return}}We()},Y=()=>{Ne(xf,R=>{R.elm&&(n.unbind(R.elm),delete R.elm)})},ge=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{ge(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",M),t.on("keyup compositionend",R=>{a&&a.nodeName==="TABLE"&&M(R)}),t.on("hide blur",We),t.on("contextmenu longpress",x,!0)}),t.on("remove",Y),{isResizable:P,showResizeRect:Ee,hideResizeRect:We,updateResizeRect:M,destroy:()=>{Ue.cancel(),a=i=u=null}}},$C=(e,t,n)=>{let s=Ur(C.fromDom(n));return TN(s.dom,e,t).map(o=>{let r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined()},Nf=(e,t)=>U(e)&&U(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,Z1=(e,t,n)=>{let s=e;for(;s&&s!==t;){if(n(s))return s;s=s.parentNode}return null},MC=(e,t,n)=>Z1(e,t,n)!==null,Q1=(e,t,n)=>MC(e,t,s=>s.nodeName===n),J1=(e,t)=>Xt(e)&&!MC(e,t,Qt),UC=(e,t,n)=>{let s=t.parentNode;if(s){let o=new st(t,e.getParent(s,e.isBlock)||e.getRoot()),r;for(;r=o[n?"prev":"next"]();)if(Le(r))return!0}return!1},eO=(e,t)=>{var n;return((n=e.previousSibling)===null||n===void 0?void 0:n.nodeName)===t},tO=(e,t)=>{let n=t;for(;n&&n!==e;){if(Re(n))return!0;n=n.parentNode}return!1},Rf=(e,t,n,s,o)=>{let r=e.getRoot(),a=e.schema.getNonEmptyElements(),i=o.parentNode,l,c;if(!i)return m.none();let u=e.getParent(i,e.isBlock)||r;if(s&&Le(o)&&t&&e.isEmpty(u))return m.some(N(i,e.nodeIndex(o)));let f=new st(o,u);for(;c=f[s?"prev":"next"]();){if(e.getContentEditableParent(c)==="false"||J1(c,r))return m.none();if(F(c)&&c.data.length>0)return Q1(c,r,"A")?m.none():m.some(N(c,s?c.data.length:0));if(e.isBlock(c)||a[c.nodeName.toLowerCase()])return m.none();l=c}return Ss(l)?m.none():n&&l?m.some(N(l,0)):m.none()},zC=(e,t,n,s)=>{let o=e.getRoot(),r,a=!1,i=n?s.startContainer:s.endContainer,l=n?s.startOffset:s.endOffset,c=q(i)&&l===i.childNodes.length,u=e.schema.getNonEmptyElements(),f=n;if(Xt(i))return m.none();if(q(i)&&l>i.childNodes.length-1&&(f=!1),Yr(i)&&(i=o,l=0),i===o){if(f&&(r=i.childNodes[l>0?l-1:0],r&&(Xt(r)||u[r.nodeName]||Mn(r))))return m.none();if(i.hasChildNodes()){if(l=Math.min(!f&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=F(i)&&c?i.data.length:0,!t&&i===o.lastChild&&Mn(i)||tO(o,i)||Xt(i)||uu(i))return m.none();if(i.hasChildNodes()&&!Mn(i)){r=i;let d=new st(i,o);do{if(Re(r)||Xt(r)){a=!1;break}if(F(r)&&r.data.length>0){l=f?0:r.data.length,i=r,a=!0;break}if(u[r.nodeName.toLowerCase()]&&!HN(r)){l=e.nodeIndex(r),i=r.parentNode,f||l++,a=!0;break}}while(r=f?d.next():d.prev())}}}return t&&(F(i)&&l===0&&Rf(e,c,t,!0,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),q(i)&&(r=i.childNodes[l],r||(r=i.childNodes[l-1]),r&&Le(r)&&!eO(r,"A")&&!UC(e,r,!1)&&!UC(e,r,!0)&&Rf(e,c,t,!0,r).each(d=>{i=d.container(),l=d.offset(),a=!0}))),f&&!t&&F(i)&&l===i.data.length&&Rf(e,c,t,!1,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),a&&i?m.some(N(i,l)):m.none()},ll=(e,t)=>{let n=t.collapsed,s=t.cloneRange(),o=N.fromRangeStart(t);return zC(e,n,!0,s).each(r=>{(!n||!N.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||zC(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),Nf(t,s)?m.none():m.some(s)},cl=(e,t)=>e.splitText(t),ul=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;if(t===s&&F(t)){if(n>0&&n<t.data.length)if(s=cl(t,n),t=s.previousSibling,o>n){o=o-n;let r=cl(s,o).previousSibling;t=s=r,o=r.data.length,n=0}else o=0}else if(F(t)&&n>0&&n<t.data.length&&(t=cl(t,n),n=0),F(s)&&o>0&&o<s.data.length){let r=cl(s,o).previousSibling;s=r,o=r.data.length}return{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},fo=e=>({walk:(r,a)=>va(e,r,a),split:ul,expand:(r,a={type:"word"})=>{if(a.type==="word"){let i=co(e,r,[{inline:"span"}],{includeTrailingSpace:!1,expandToBlock:!1}),l=e.createRng();return l.setStart(i.startContainer,i.startOffset),l.setEnd(i.endContainer,i.endOffset),l}return r},normalize:r=>ll(e,r).fold(Oe,a=>(r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),!0))});fo.compareRanges=Nf,fo.getCaretRangeFromPoint=$C,fo.getSelectedNode=Ui,fo.getNode=As;let Tf=e=>Ce(e)==="textarea",nO=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),sO=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},oO=(e,t)=>{let n=dt(e);if(n.length===0||Tf(e))return{element:e,offset:t};if(t<n.length&&!Tf(n[t]))return{element:n[t],offset:0};{let s=n[n.length-1];return Tf(s)?{element:e,offset:t}:Ce(s)==="img"?{element:s,offset:1}:Nt(s)?{element:s,offset:jr(s).length}:{element:s,offset:dt(s).length}}},HC=(e,t)=>{let n=Wx(e),s=zx(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},rO=(e,t)=>{let n=oO(e,t),s=C.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+et+"</span>");return Bt(n.element,s),HC(s,()=>Te(s))},aO=e=>HC(C.fromDom(e),ce),WC=(e,t,n,s)=>{lO(e,(o,r)=>iO(e,t,n,s),n)},VC=(e,t,n,s,o)=>{let r={elm:s.element.dom,alignToTop:o};if(nO(e,r))return;let a=Zc(t).top;n(e,t,a,s,o),sO(e,r)},iO=(e,t,n,s)=>{let o=C.fromDom(e.getBody()),r=C.fromDom(e.getDoc());Mx(o);let a=rO(C.fromDom(n.startContainer),n.startOffset);VC(e,r,t,a,s),a.cleanup()},jC=(e,t,n,s)=>{let o=C.fromDom(e.getDoc());VC(e,o,n,aO(t),s)},lO=(e,t,n)=>{let s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(C.fromDom(s),C.fromDom(r));let i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},Df=(e,t,n,s,o)=>{let r=t.pos,a=30;if(s)xp(r.left,Math.max(0,r.top-a),o);else{let i=r.top-n+t.height+a;xp(-e.getBody().getBoundingClientRect().left,i,o)}},qC=(e,t,n,s,o,r)=>{let a=s+n,i=o.pos.top,l=o.bottom,c=l-i>=s;i<n?Df(e,o,s,r!==!1,t):i>a?Df(e,o,s,c?r!==!1:r===!0,t):l>a&&!c&&Df(e,o,s,r===!0,t)},KC=(e,t,n,s,o)=>{let r=Ur(t).dom.innerHeight;qC(e,t,n,r,s,o)},GC=(e,t,n,s,o)=>{let r=Ur(t).dom.innerHeight;qC(e,t,n,r,s,o);let a=OC(s.element),i=au(window);a.top<i.y?Np(s.element,o!==!1):a.top>i.bottom&&Np(s.element,o===!0)},cO=(e,t,n)=>WC(e,KC,t,n),uO=(e,t,n)=>jC(e,t,KC,n),fO=(e,t,n)=>WC(e,GC,t,n),dO=(e,t,n)=>jC(e,t,GC,n),mO=(e,t,n)=>{(e.inline?uO:dO)(e,t,n)},Sa=(e,t,n)=>{(e.inline?cO:fO)(e,t,n)},YC=(e,t)=>t.collapsed?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer),XC=(e,t,n,s,o)=>{let r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return m.from(r).map(C.fromDom).map(i=>!s||!t.collapsed?Do(i,o(i,a)).getOr(i):i).bind(i=>Ht(i)?m.some(i):Fn(i).filter(Ht)).map(i=>i.dom).getOr(e)},ZC=(e,t,n=!1)=>XC(e,t,!0,n,(s,o)=>Math.min(Wc(s),o)),QC=(e,t,n=!1)=>XC(e,t,!1,n,(s,o)=>o>0?o-1:o),JC=(e,t)=>{let n=e;for(;e&&F(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},gO=(e,t)=>{if(!t)return e;let n=t.startContainer,s=t.endContainer,o=t.startOffset,r=t.endOffset,a=t.commonAncestorContainer;t.collapsed||(n===s&&r-o<2&&n.hasChildNodes()&&(a=n.childNodes[o]),F(n)&&F(s)&&(n.length===o?n=JC(n.nextSibling,!0):n=n.parentNode,r===0?s=JC(s.previousSibling,!1):s=s.parentNode,n&&n===s&&(a=n)));let i=F(a)?a.parentNode:a;return $n(i)?i:e},pO=(e,t,n,s)=>{let o=[],r=e.getRoot(),a=e.getParent(n||ZC(r,t,t.collapsed),e.isBlock),i=e.getParent(s||QC(r,t,t.collapsed),e.isBlock);if(a&&a!==r&&o.push(a),a&&i&&a!==i){let l,c=new st(a,r);for(;(l=c.next())&&l!==i;)e.isBlock(l)&&o.push(l)}return i&&a!==i&&i!==r&&o.push(i),o},hO=(e,t,n)=>m.from(t).bind(s=>m.from(s.parentNode).map(o=>{let r=e.nodeIndex(s),a=e.createRng();return a.setStart(o,r),a.setEnd(o,r+1),n&&(ff(e,a,s,!0),ff(e,a,s,!1)),a})),Pf=(e,t)=>be(t,n=>{let s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),bO={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},fl=(e,t,n)=>{let s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},CO=e=>{var t;let n=(t=e.value)!==null&&t!==void 0?t:"";if(!$o(n))return!1;let s=e.parent;return!(s&&(s.name!=="span"||s.attr("style"))&&/^[ ]+$/.test(n))},ey=e=>{let t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class Et{static create(t,n){let s=new Et(t,bO[t]||1);return n&&Ne(n,(o,r)=>{s.attr(r,o)}),s}constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(t){let n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){let s=this;if(!ee(t))return U(t)&&Ne(t,(r,a)=>{s.attr(a,r)}),s;let o=s.attributes;if(o){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){let t=this,n=new Et(t.name,t.type),s=t.attributes;if(s){let o=[];o.map={};for(let r=0,a=s.length;r<a;r++){let i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){let n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){let t=this;for(let n=t.firstChild;n;){let s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){let t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o&&(o.next=s),n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s&&(s.prev=o),t.parent=t.next=t.prev=null),t}append(t){let n=this;t.parent&&t.remove();let s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();let o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){let n=this,s=[];for(let o=n.firstChild;o;o=fl(o,n))o.name===t&&s.push(o);return s}children(){let t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){let t=this;if(t.firstChild){let n=[];for(let o=t.firstChild;o;o=fl(o,t))n.push(o);let s=n.length;for(;s--;){let o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){var o;let r=this,a=r.firstChild;if(ey(r))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||ey(a))return!1}if(a.type===8||a.type===3&&!CO(a)||a.type===3&&a.parent&&n[a.parent.name]&&$o((o=a.value)!==null&&o!==void 0?o:"")||s&&s(a))return!1}while(a=fl(a,r));return!0}walk(t){return fl(this,null,t)}}let yO=L.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),ty=e=>ee(e.nodeValue)&&e.nodeValue.includes(et),ny=e=>`${e.length===0?"":`${be(e,t=>`[${t}]`).join(",")},`}[data-mce-bogus="all"]`,vO=(e,t)=>t.querySelectorAll(ny(e)),sy=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,t=>ty(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),oy=e=>document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t=>{if(ty(t)){let n=t.parentNode;return n&&oe(yO,n.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}else return NodeFilter.FILTER_SKIP}),EO=e=>sy(e).nextNode()!==null,SO=e=>oy(e).nextNode()!==null,wO=(e,t)=>t.querySelector(ny(e))!==null,kO=(e,t)=>{D(vO(e,t),n=>{let s=C.fromDom(n);Wt(s,"data-mce-bogus")==="all"?Te(s):D(e,o=>{Wr(s,o)&&it(s,o)})})},ry=e=>{let t=e.nextNode();for(;t!==null;)t.nodeValue=null,t=e.nextNode()},_O=Tn(ry,sy),AO=Tn(ry,oy),ay=(e,t)=>{let n=[{condition:G(wO,t),action:G(kO,t)},{condition:EO,action:_O},{condition:SO,action:AO}],s=e,o=!1;return D(n,({condition:r,action:a})=>{r(s)&&(o||(s=e.cloneNode(!0),o=!0),a(s))}),s},iy=e=>{let t=mt(e,"[data-mce-bogus]");D(t,n=>{Wt(n,"data-mce-bogus")==="all"?Te(n):no(n)?(Bt(n,C.fromText(Pr)),Te(n)):ys(n)})},ly=e=>{let t=mt(e,"input");D(t,n=>{it(n,"name")})},xO=(e,t)=>{let n=pt(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s|\xA0|<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},NO=(e,t)=>{let n=e.getDoc(),s=Cs(C.fromDom(e.getBody())),o=C.fromTag("div",n);at(o,"data-mce-bogus","all"),vi(o,{position:"fixed",left:"-9999999px",top:"0"}),yi(o,t.innerHTML),iy(o),ly(o);let r=yx(s);Ke(r,o);let a=Vt(o.dom.innerText);return Te(o),a},RO=(e,t,n)=>{let s;return t.format==="raw"?s=L.trim(Vt(ay(n,e.serializer.getTempAttrs()).innerHTML)):t.format==="text"?s=NO(e,n):t.format==="tree"?s=e.serializer.serialize(n,t):s=xO(e,e.serializer.serialize(n,t)),t.format!=="text"&&!Fi(C.fromDom(n))&&ee(s)?L.trim(s):s},TO=(e,t)=>m.from(e.getBody()).fold(W(t.format==="tree"?new Et("body",11):""),n=>RO(e,t,n)),cy=L.makeMap,uy=e=>{let t=[];e=e||{};let n=e.indent,s=cy(e.indent_before||""),o=cy(e.indent_after||""),r=Qs.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&s[i]&&t.length>0){let u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}if(t.push("<",i),l)for(let u=0,f=l.length;u<f;u++){let d=l[u];t.push(" ",d.name,'="',r(d.value,!0),'"')}if(!c||a?t[t.length]=">":t[t.length]=" />",c&&n&&o[i]&&t.length>0){let u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}},end:i=>{let l;t.push("</",i,">"),n&&o[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",r(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},Ts=(e={},t=ws())=>{let n=uy(e);return e.validate="validate"in e?e.validate:!0,{serialize:o=>{let r=e.validate,a={3:l=>{var c;n.text((c=l.value)!==null&&c!==void 0?c:"",l.raw)},8:l=>{var c;n.comment((c=l.value)!==null&&c!==void 0?c:"")},7:l=>{n.pi(l.name,l.value)},10:l=>{var c;n.doctype((c=l.value)!==null&&c!==void 0?c:"")},4:l=>{var c;n.cdata((c=l.value)!==null&&c!==void 0?c:"")},11:l=>{let c=l;if(c=c.firstChild)do i(c);while(c=c.next)}};n.reset();let i=l=>{var c;let u=a[l.type];if(u)u(l);else{let f=l.name,d=f in t.getVoidElements(),g=l.attributes;if(r&&g&&g.length>1){let h=[];h.map={};let p=t.getElementRule(l.name);if(p){for(let b=0,y=p.attributesOrder.length;b<y;b++){let v=p.attributesOrder[b];if(v in g.map){let E=g.map[v];h.map[v]=E,h.push({name:v,value:E})}}for(let b=0,y=g.length;b<y;b++){let v=g[b].name;if(!(v in h.map)){let E=g.map[v];h.map[v]=E,h.push({name:v,value:E})}}g=h}}if(n.start(f,g,d),Ys(f))ee(l.value)&&n.text(l.value,!0),n.end(f);else if(!d){let h=l.firstChild;if(h){(f==="pre"||f==="textarea")&&h.type===3&&((c=h.value)===null||c===void 0?void 0:c[0])===`
`&&n.text(`
`,!0);do i(h);while(h=h.next)}n.end(f)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},fy=new Set;D(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{fy.add(t)});let dy=new Set;D(["background-color"],t=>{dy.add(t)});let my=["font","text-decoration","text-emphasis"],DO=(e,t)=>e.parseStyle(e.getAttrib(t,"style")),or=(e,t)=>Ut(DO(e,t)),PO=e=>fy.has(e),BO=e=>dy.has(e),gy=(e,t)=>Ie(or(e,t),n=>PO(n)),OO=(e,t)=>gy(e,t)&&Ie(or(e,t),n=>BO(n)),IO=e=>se(e,t=>Ie(my,n=>Qe(t,n))),FO=(e,t,n)=>{let s=or(e,t),o=or(e,n),r=a=>{var i,l;let c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",u=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return Pn(c)&&Pn(u)&&c!==u};return Ie(s,a=>{let i=l=>Ie(l,c=>c===a);if(!i(o)&&i(my)){let l=IO(o);return Ie(l,r)}else return r(a)})},py=(e,t,n)=>m.from(n.container()).filter(F).exists(s=>{let o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),Bf=G(py,!0,lo),Of=G(py,!1,lo),LO=e=>{let t=e.container();return F(t)&&(t.data.length===0||Li(t.data)&&Ea.isBookmarkNode(t.parentNode))},Ds=(e,t)=>n=>Ju(e?0:-1,n).filter(t).isSome(),hy=e=>Vp(e)&&Ln(C.fromDom(e),"display")==="block",by=e=>Re(e)&&!$N(e),$O=Ds(!0,hy),MO=Ds(!1,hy),wa=Ds(!0,Un),ka=Ds(!1,Un),Cy=Ds(!0,Mn),If=Ds(!1,Mn),Ps=Ds(!0,by),Bs=Ds(!1,by),UO=e=>e.slice(0,-1),zO=(e,t,n)=>yn(t,e)?UO(cp(e,s=>n(s)||Se(s,t))):[],yy=(e,t)=>zO(e,t,Oe),ls=(e,t)=>[e].concat(yy(e,t)),Ff=(e,t,n)=>tC(e,t,n,LO),HO=e=>t=>e.isBlock(Ce(t)),vy=(e,t,n)=>Ze(ls(C.fromDom(t.container()),e),HO(n)),Ey=(e,t,n,s)=>Ff(e,t.dom,n).forall(o=>vy(t,n,s).fold(()=>!zn(o,n,t.dom),r=>!zn(o,n,t.dom)&&yn(r,C.fromDom(o.container())))),Sy=(e,t,n,s)=>vy(t,n,s).fold(()=>Ff(e,t.dom,n).forall(o=>!zn(o,n,t.dom)),o=>Ff(e,o.dom,n).isNone()),Lf=G(Sy,!1),wy=G(Sy,!0),WO=G(Ey,!1),VO=G(Ey,!0),jO=e=>Yi(e).exists(no),dl=(e,t,n,s)=>{let o=se(ls(C.fromDom(n.container()),t),a=>s.isBlock(Ce(a))),r=xt(o).getOr(t);return Zt(e,r.dom,n).filter(jO)},$f=(e,t,n)=>Yi(t).exists(no)||dl(!0,e,t,n).isSome(),ml=(e,t,n)=>kB(t).exists(no)||dl(!1,e,t,n).isSome(),ky=G(dl,!1),qO=G(dl,!0),_y=e=>N.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),Ay=(e,t,n)=>{let s=se(ls(C.fromDom(t.container()),e),o=>n.isBlock(Ce(o)));return xt(s).getOr(e)},xy=(e,t,n)=>_y(t)?Of(t):Of(t)||Ot(Ay(e,t,n).dom,t).exists(Of),Ny=(e,t,n)=>_y(t)?Bf(t):Bf(t)||Rt(Ay(e,t,n).dom,t).exists(Bf),KO=e=>ke(["pre","pre-wrap"],e),Mf=e=>Yi(e).bind(t=>vs(t,Ht)).exists(t=>KO(Ln(t,"white-space"))),GO=(e,t)=>Ot(e.dom,t).isNone(),YO=(e,t)=>Rt(e.dom,t).isNone(),XO=(e,t,n)=>GO(e,t)||YO(e,t)||Lf(e,t,n)||wy(e,t,n)||ml(e,t,n)||$f(e,t,n),ZO=e=>U(e)&&Re(e)&&Hb(e),Ry=(e,t)=>n=>ZO(new st(n,e)[t]()),QO=(e,t)=>{let n=Rt(e.dom,t).getOr(t),s=Ry(e.dom,"next");return t.isAtEnd()&&(s(t.container())||s(n.container()))},JO=(e,t)=>{let n=Ot(e.dom,t).getOr(t),s=Ry(e.dom,"prev");return t.isAtStart()&&(s(t.container())||s(n.container()))},Ty=(e,t,n)=>Mf(t)?!1:XO(e,t,n)||xy(e,t,n)||Ny(e,t,n),_a=(e,t,n)=>Mf(t)?!1:Lf(e,t,n)||WO(e,t,n)||ml(e,t,n)||xy(e,t,n)||JO(e,t),eI=e=>{let t=e.container(),n=e.offset();return F(t)&&n<t.data.length?N(t,n+1):e},Aa=(e,t,n)=>Mf(t)?!1:wy(e,t,n)||VO(e,t,n)||$f(e,t,n)||Ny(e,t,n)||QO(e,t),Uf=(e,t,n)=>_a(e,t,n)||Aa(e,eI(t),n),Dy=(e,t)=>Ji(e.charAt(t)),Py=(e,t)=>lo(e.charAt(t)),tI=e=>{let t=e.container();return F(t)&&ft(t.data,Je)},nI=e=>{let t=e.split("");return be(t,(n,s)=>Ji(n)&&s>0&&s<t.length-1&&af(t[s-1])&&af(t[s+1])?" ":n).join("")},By=(e,t,n,s)=>{let o=t.data,r=N(t,0);return!n&&Dy(o,0)&&!Uf(e,r,s)?(t.data=" "+o.slice(1),!0):n&&Py(o,0)&&_a(e,r,s)?(t.data=Je+o.slice(1),!0):!1},sI=e=>{let t=e.data,n=nI(t);return n!==t?(e.data=n,!0):!1},Oy=(e,t,n,s)=>{let o=t.data,r=N(t,o.length-1);return!n&&Dy(o,o.length-1)&&!Uf(e,r,s)?(t.data=o.slice(0,-1)+" ",!0):n&&Py(o,o.length-1)&&Aa(e,r,s)?(t.data=o.slice(0,-1)+Je,!0):!1},oI=(e,t,n)=>{let s=t.container();if(!F(s))return m.none();if(tI(t)){let o=By(e,s,!1,n)||sI(s)||Oy(e,s,!1,n);return Ro(o,t)}else if(Uf(e,t,n)){let o=By(e,s,!0,n)||Oy(e,s,!0,n);return Ro(o,t)}else return m.none()},rI=e=>{let t=C.fromDom(e.getBody());e.selection.isCollapsed()&&oI(t,N.fromRangeStart(e.selection.getRng()),e.schema).each(n=>{e.selection.setRng(n.toRange())})},Iy=(e,t,n,s)=>{if(n===0)return;let o=C.fromDom(e),r=os(o,c=>s.isBlock(Ce(c))).getOr(o),a=e.data.slice(t,t+n),i=t+n>=e.data.length&&Aa(r,N(e,e.data.length),s),l=t===0&&_a(r,N(e,0),s);e.replaceData(t,n,Hp(a,4,l,i))},gl=(e,t,n)=>{let s=e.data.slice(t),o=s.length-AA(s).length;Iy(e,t,o,n)},zf=(e,t,n)=>{let s=e.data.slice(0,t),o=s.length-xg(s).length;Iy(e,t-o,o,n)},Hf=(e,t,n,s,o=!0)=>{let r=xg(e.data).length,a=o?e:t,i=o?t:e;return o?a.appendData(i.data):a.insertData(0,i.data),Te(C.fromDom(i)),s&&gl(a,r,n),a},aI=(e,t)=>{let n=e.container(),s=e.offset();return!N.isTextPosition(e)&&n===t.parentNode&&s>N.before(t).offset()},iI=(e,t)=>aI(t,e)?N(t.container(),t.offset()-1):t,lI=e=>F(e)?N(e,0):N.before(e),cI=e=>F(e)?N(e,e.data.length):N.after(e),Fy=e=>wn(e.previousSibling)?m.some(cI(e.previousSibling)):e.previousSibling?un(e.previousSibling):m.none(),Ly=e=>wn(e.nextSibling)?m.some(lI(e.nextSibling)):e.nextSibling?ht(e.nextSibling):m.none(),uI=(e,t)=>m.from(t.previousSibling?t.previousSibling:t.parentNode).bind(n=>Ot(e,N.before(n))).orThunk(()=>Rt(e,N.after(t))),fI=(e,t)=>Rt(e,N.after(t)).orThunk(()=>Ot(e,N.before(t))),dI=(e,t)=>Fy(t).orThunk(()=>Ly(t)).orThunk(()=>uI(e,t)),mI=(e,t)=>Ly(t).orThunk(()=>Fy(t)).orThunk(()=>fI(e,t)),gI=(e,t,n)=>e?mI(t,n):dI(t,n),pI=(e,t,n)=>gI(e,t,n).map(G(iI,n)),$y=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},hI=e=>t=>t.dom===e,bI=(e,t)=>t&&oe(e.schema.getBlockElements(),Ce(t)),CI=(e,t,n)=>{if(gt(e,t)){let s=C.fromHtml('<br data-mce-bogus="1">');return n?D(dt(t),o=>{vf(o)||Te(o)}):Po(t),Ke(t,s),m.some(N.before(s.dom))}else return m.none()},yI=(e,t,n,s)=>{let o=bs(e).filter(Nt),r=Hr(e).filter(Nt);return Te(e),vA(o,r,t,(a,i,l)=>{let c=a.dom,u=i.dom,f=c.data.length;return Hf(c,u,n,s),l.container()===u?N(c,f):l}).orThunk(()=>(s&&(o.each(a=>zf(a.dom,a.dom.length,n)),r.each(a=>gl(a.dom,0,n))),t))},vI=(e,t)=>oe(e.schema.getTextInlineElements(),Ce(t)),mo=(e,t,n,s=!0,o=!1)=>{let r=pI(t,e.getBody(),n.dom),a=os(n,G(bI,e),hI(e.getBody())),i=yI(n,r,e.schema,vI(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(l=>CI(e.schema,l,o)).fold(()=>{s&&$y(e,t,i)},l=>{s&&$y(e,t,m.some(l))})},EI=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,SI=e=>EI.test(e),go=(e,t)=>Cn(C.fromDom(t),sP(e))&&!Xs(e.schema,t)&&e.dom.isEditable(t),My=e=>{var t;return xe.DOM.getStyle(e,"direction",!0)==="rtl"||SI((t=e.textContent)!==null&&t!==void 0?t:"")},wI=(e,t,n)=>se(xe.DOM.getParents(n.container(),"*",t),e),Os=(e,t,n)=>{let s=wI(e,t,n);return m.from(s[s.length-1])},kI=(e,t,n)=>{let s=Ns(t,e),o=Ns(n,e);return U(s)&&s===o},_I=e=>Bu(e)||Ou(e),nn=(e,t)=>{let n=t.container(),s=t.offset();return e?_s(n)?F(n.nextSibling)?N(n.nextSibling,0):N.after(n):Bu(t)?N(n,s+1):t:_s(n)?F(n.previousSibling)?N(n.previousSibling,n.previousSibling.data.length):N.before(n):Ou(t)?N(n,s-1):t},Uy=G(nn,!0),zy=G(nn,!1),Hy=(e,t)=>{let n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},AI=e=>{e.execCommand("delete")},pl=e=>Hy(e,"Delete"),Wy=e=>Hy(e,"ForwardDelete"),xI=e=>t=>No(Fn(t),e,Se),NI=e=>Dh(e)||Wo(e),hl=(e,t)=>yn(e,t)?vs(t,NI,xI(e)):m.none(),Wf=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},Vy=(e,t,n)=>ct(ht(n),un(n),(s,o)=>{let r=nn(!0,s),a=nn(!1,o),i=nn(!1,t);return e?Rt(n,i).exists(l=>l.isEqual(a)&&t.isEqual(r)):Ot(n,i).exists(l=>l.isEqual(r)&&t.isEqual(a))}).getOr(!0),jy=e=>(mx(e)?bs(e):Hc(e)).bind(jy).orThunk(()=>m.some(e)),qy=(e,t,n,s=!0)=>{var o;t.deleteContents();let r=jy(n).getOr(n),a=C.fromDom((o=e.dom.getParent(r.dom,e.dom.isBlock))!==null&&o!==void 0?o:n.dom);if(a.dom===e.getBody()?Wf(e,s):gt(e.schema,a,{checkRootAsContent:!1})&&(ks(a),s&&e.selection.setCursorLocation(a.dom,0)),!Se(n,a)){let i=No(Fn(a),n)?[]:bx(a);D(i.concat(dt(n)),l=>{!Se(l,a)&&!yn(l,a)&&gt(e.schema,l)&&Te(l)})}},RI=e=>t=>Se(e,t),Vf=e=>mt(e,"td,th"),Ky=(e,t)=>Ca(C.fromDom(e),t),TI=e=>ct(e.startTable,e.endTable,(t,n)=>{let s=su(t,r=>Se(r,n)),o=su(n,r=>Se(r,t));return!s&&!o?e:we(Q({},e),{startTable:s?m.none():e.startTable,endTable:o?m.none():e.endTable,isSameTable:!1,isMultiTable:!1})}).getOr(e),DI=e=>TI(e),PI=(e,t)=>{let n=Ky(e.startContainer,t),s=Ky(e.endContainer,t),o=n.isSome(),r=s.isSome(),a=ct(n,s,Se).getOr(!1);return DI({startTable:n,endTable:s,isStartInTable:o,isEndInTable:r,isSameTable:a,isMultiTable:!a&&o&&r})},jf=(e,t)=>({start:e,end:t}),BI=(e,t,n)=>({rng:e,table:t,cells:n}),xa=Dn.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),bl=(e,t)=>Io(C.fromDom(e),"td,th",t),Gy=e=>!Se(e.start,e.end),Yy=(e,t)=>Ca(e.start,t).bind(n=>Ca(e.end,t).bind(s=>Ro(Se(n,s),n))),OI=(e,t)=>!Gy(e)&&Yy(e,t).exists(n=>{let s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),II=(e,t)=>{let n=bl(e.startContainer,t),s=bl(e.endContainer,t);return ct(n,s,jf)},FI=e=>t=>Ca(t,e).bind(n=>ps(Vf(n)).map(s=>jf(t,s))),LI=e=>t=>Ca(t,e).bind(n=>xt(Vf(n)).map(s=>jf(s,t))),qf=e=>t=>Yy(t,e).map(n=>BI(t,n,Vf(n))),Xy=(e,t,n,s)=>{if(n.collapsed||!e.forall(Gy))return m.none();if(t.isSameTable){let o=e.bind(qf(s));return m.some({start:o,end:o})}else{let o=bl(n.startContainer,s),r=bl(n.endContainer,s),a=o.bind(FI(s)).bind(qf(s)),i=r.bind(LI(s)).bind(qf(s));return m.some({start:a,end:i})}},Zy=(e,t)=>Ar(e,n=>Se(n,t)),Kf=e=>ct(Zy(e.cells,e.rng.start),Zy(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),$I=(e,t,n)=>e.exists(s=>OI(s,n)&&uf(s.start,t)),Qy=(e,t)=>{let{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},MI=(e,t,n,s)=>Xy(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{let{isSameTable:r}=t,a=Kf(o).getOr([]);if(r&&o.cells.length===a.length)return m.some(xa.fullTable(o.table));if(a.length>0){if(r)return m.some(xa.partialTable(a,m.none()));{let i=Qy(n,t);return m.some(xa.partialTable(a,m.some(we(Q({},t),{rng:i}))))}}else return m.none()}),UI=(e,t,n,s)=>Xy(e,t,n,s).bind(({start:o,end:r})=>{let a=o.bind(Kf).getOr([]),i=r.bind(Kf).getOr([]);if(a.length>0&&i.length>0){let l=Qy(n,t);return m.some(xa.multiTable(a,i,l))}else return m.none()}),zI=(e,t)=>{let n=RI(e),s=II(t,n),o=PI(t,n);return $I(s,t,n)?s.map(r=>xa.singleCellTable(t,r.start)):o.isMultiTable?UI(s,o,t,n):MI(s,o,t,n)},Jy=e=>D(e,t=>{it(t,"contenteditable"),ks(t)}),HI=(e,t)=>m.from(e.dom.getParent(t,e.dom.isBlock)).map(C.fromDom),WI=(e,t,n)=>{n.each(s=>{t?Te(s):(ks(s),e.selection.setCursorLocation(s.dom,0))})},Gf=(e,t,n,s)=>{let o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Yf(e,o,t,!1).each(r=>r())},ev=e=>{let t=Jo(e),n=C.fromDom(e.selection.getNode());Ri(n.dom)&&gt(e.schema,n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&Ie(t,s=>Se(s,n))&&at(n,"data-mce-selected","1")},tv=(e,t,n)=>m.some(()=>{let s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{let i=HI(e,a?r.endContainer:r.startContainer);r.deleteContents(),WI(e,a,i.filter(G(gt,e.schema)));let l=a?t[0]:t[t.length-1];return Gf(e,l,s,a),gt(e.schema,l)?m.none():m.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);Jy(o),ev(e)}),VI=(e,t,n,s)=>m.some(()=>{let o=e.selection.getRng(),r=t[0],a=n[n.length-1];Gf(e,r,o,!0),Gf(e,a,o,!1);let i=gt(e.schema,r)?t:t.slice(1),l=gt(e.schema,a)?n:n.slice(0,-1);Jy(i.concat(l)),s.deleteContents(),ev(e)}),Yf=(e,t,n,s=!0)=>m.some(()=>{qy(e,t,n,s)}),jI=(e,t)=>m.some(()=>mo(e,!1,t)),qI=(e,t,n)=>zI(t,n).bind(s=>s.fold(G(Yf,e),G(jI,e),G(tv,e),G(VI,e))),KI=(e,t)=>Cl(e,t),GI=(e,t,n,s)=>Xf(t,s).fold(()=>qI(e,t,n),o=>KI(e,o)),YI=(e,t,n)=>{let s=C.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?tv(e,n,m.none()):GI(e,s,o,t)},nv=(e,t)=>Ze(ls(t,e),ra),Xf=(e,t)=>Ze(ls(t,e),Mr("caption")),XI=(e,t,n,s,o)=>Zo(n,e.getBody(),o).bind(r=>nv(t,C.fromDom(r.getNode())).bind(a=>Se(a,s)?m.none():m.some(ce))),Cl=(e,t)=>m.some(()=>{ks(t),e.selection.setCursorLocation(t.dom,0)}),ZI=(e,t,n,s)=>ht(e.dom).bind(o=>un(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),QI=(e,t)=>Cl(e,t),JI=(e,t,n)=>Xf(e,C.fromDom(n.getNode())).fold(()=>m.some(ce),s=>Ro(!Se(s,t),ce)),eF=(e,t,n,s,o)=>Zo(n,e.getBody(),o).fold(()=>m.some(ce),r=>ZI(s,n,o,r)?QI(e,s):JI(t,s,r)),tF=(e,t,n,s)=>{let o=N.fromRangeStart(e.selection.getRng());return nv(n,s).bind(r=>gt(e.schema,r,{checkRootAsContent:!1})?Cl(e,r):XI(e,n,t,r,o))},nF=(e,t,n,s)=>{let o=N.fromRangeStart(e.selection.getRng());return gt(e.schema,s)?Cl(e,s):eF(e,n,t,s,o)},sv=(e,t)=>e?Cy(t):If(t),sF=(e,t)=>{let n=N.fromRangeStart(e.selection.getRng());return sv(t,n)||Zt(t,e.getBody(),n).exists(s=>sv(t,s))},oF=(e,t,n)=>{let s=C.fromDom(e.getBody());return Xf(s,n).fold(()=>tF(e,t,s,n).orThunk(()=>Ro(sF(e,t),ce)),o=>nF(e,t,s,o))},Zf=(e,t)=>{let n=C.fromDom(e.selection.getStart(!0)),s=Jo(e);return e.selection.isCollapsed()&&s.length===0?oF(e,t,n):YI(e,n,s)},po=(e,t)=>{let n=t;for(;n&&n!==e;){if(cn(n)||Re(n))return n;n=n.parentNode}return null},rF=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],aF=L.each,Qf=e=>{let t=e.dom,n=new Set(e.serializer.getTempAttrs()),s=(r,a)=>{if(r.nodeName!==a.nodeName||r.nodeType!==a.nodeType)return!1;let i=c=>{let u={};return aF(t.getAttribs(c),f=>{let d=f.nodeName.toLowerCase();d!=="style"&&!o(d)&&(u[d]=t.getAttrib(c,d))}),u},l=(c,u)=>{for(let f in c)if(oe(c,f)){let d=u[f];if(rt(d)||c[f]!==d)return!1;delete u[f]}for(let f in u)if(oe(u,f))return!1;return!0};return q(r)&&q(a)&&(!l(i(r),i(a))||!l(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(a,"style"))))?!1:!Jt(r)&&!Jt(a)},o=r=>Ie(rF,a=>Qe(r,a))||n.has(r);return{compare:s,isAttributeInternal:o}},ov=e=>["h1","h2","h3","h4","h5","h6"].includes(e.name),iF=e=>e.name==="summary",lF=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},rv=(e,t,n,s)=>{let o=n.name;for(let r=0,a=e.length;r<a;r++){let i=e[r];if(i.name===o){let l=s.nodes[o];l?l.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){let i=t[r],l=i.name;if(l in n.attributes.map){let c=s.attributes[l];c?c.nodes.push(n):s.attributes[l]={filter:i,nodes:[n]}}}},cF=(e,t,n)=>{let s={nodes:{},attributes:{}};return n.firstChild&&lF(n,o=>{rv(e,t,o,s)}),s},av=(e,t)=>{let n=(s,o)=>{Ne(s,r=>{let a=Mt(r.nodes);D(r.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){let c=a[l];(!(o?c.attr(r.filter.name)!==void 0:c.name===r.filter.name)||qe(c.parent))&&a.splice(l,1)}a.length>0&&i(a,r.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},iv=(e,t,n,s={})=>{let o=cF(e,t,n);av(o,s)},Jf=(e,t,n,s)=>{if((e.pad_empty_with_br||t.insert)&&n(s)){let r=new Et("br",1);t.insert&&r.attr("data-mce-bogus","1"),s.empty().append(r)}else s.empty().append(new Et("#text",3)).value=Je},uF=e=>{var t;return lv(e,"#text")&&((t=e?.firstChild)===null||t===void 0?void 0:t.value)===Je},lv=(e,t)=>{let n=e?.firstChild;return U(n)&&n===e.lastChild&&n.name===t},fF=(e,t)=>{let n=e.getElementRule(t.name);return n?.paddEmpty===!0},Na=(e,t,n,s)=>s.isEmpty(t,n,o=>fF(e,o)),dF=(e,t)=>U(e)&&(t(e)||e.name==="br"),mF=e=>{let t;for(let n=e;n;n=n.parent){let s=n.attr("contenteditable");if(s==="false")break;s==="true"&&(t=n)}return m.from(t)},ed=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{let s=e.children();for(let o of s)n&&!t.isValidChild(n.name,o.name)&&ed(o,t,n);e.unwrap()}},td=(e,t,n,s=ce)=>{let o=t.getTextBlockElements(),r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=L.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),l=new Set,c=u=>u!==n&&!i[u.name];for(let u=0;u<e.length;u++){let f=e[u],d,g,h;if(!f.parent||l.has(f))continue;if(o[f.name]&&f.parent.name==="li"){let b=f.next;for(;b&&o[b.name];){b.name="li",l.add(b),f.parent.insert(b,f.parent);b=b.next}f.unwrap();continue}let p=[f];for(d=f.parent;d&&!t.isValidChild(d.name,f.name)&&c(d);d=d.parent)p.push(d);if(d&&p.length>1)if(nd(t,f,d))ed(f,t);else{p.reverse(),g=p[0].clone(),s(g);let b=g;for(let y=0;y<p.length-1;y++){t.isValidChild(b.name,p[y].name)&&y>0?(h=p[y].clone(),s(h),b.append(h)):h=b;for(let v=p[y].firstChild;v&&v!==p[y+1];){let E=v.next;h.append(v),v=E}b=h}Na(t,r,a,g)?d.insert(f,p[0],!0):(d.insert(g,p[0],!0),d.insert(f,g)),d=p[0],(Na(t,r,a,d)||lv(d,"br"))&&d.empty().remove()}else if(f.parent){if(f.name==="li"){let b=f.prev;if(b&&(b.name==="ul"||b.name==="ol")){b.append(f);continue}if(b=f.next,b&&(b.name==="ul"||b.name==="ol")&&b.firstChild){b.insert(f,b.firstChild,!0);continue}let y=new Et("ul",1);s(y),f.wrap(y);continue}if(t.isValidChild(f.parent.name,"div")&&t.isValidChild("div",f.name)){let b=new Et("div",1);s(b),f.wrap(b)}else ed(f,t)}}},gF=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},nd=(e,t,n=t.parent)=>n?e.children[t.name]&&!e.isValidChild(n.name,t.name)||t.name==="a"&&gF(n,"a")?!0:iF(n)&&ov(t)?!(n?.firstChild===t&&n?.lastChild===t):!1:!1,pF=(e,t,n,s)=>{let o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},hF=e=>{let t=N.fromRangeStart(e),n=N.fromRangeEnd(e),s=e.commonAncestorContainer;return Zt(!1,s,n).map(o=>!zn(t,n,s)&&zn(t,o,s)?pF(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},sd=e=>e.collapsed?e:hF(e),bF=e=>U(e.firstChild)&&e.firstChild===e.lastChild,CF=e=>e.name==="br"||e.value===Je,yF=(e,t)=>e.getBlockElements()[t.name]&&bF(t)&&CF(t.firstChild),vF=(e,t)=>{let n=e.getNonEmptyElements();return U(t)&&(t.isEmpty(n)||yF(e,t))},EF=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),vF(e,s)&&(s=s?.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},SF=e=>{var t,n;let s=e.firstChild,o=e.lastChild;return s&&s.nodeName==="META"&&((t=s.parentNode)===null||t===void 0||t.removeChild(s)),o&&o.id==="mce_marker"&&((n=o.parentNode)===null||n===void 0||n.removeChild(o)),e},wF=(e,t,n)=>{let s=t.serialize(n),o=e.createFragment(s);return SF(o)},kF=e=>{var t;return se((t=e?.childNodes)!==null&&t!==void 0?t:[],n=>n.nodeName==="LI")},_F=e=>e.data===Je||Le(e),AF=e=>U(e?.firstChild)&&e.firstChild===e.lastChild&&_F(e.firstChild),xF=e=>!e.firstChild||AF(e),NF=e=>e.length>0&&xF(e[e.length-1])?e.slice(0,-1):e,od=(e,t)=>{let n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},RF=(e,t)=>!!od(e,t),TF=(e,t)=>{let n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},DF=(e,t)=>{let n=N.before(e),o=Wn(t).next(n);return o?o.toRange():null},cv=(e,t)=>{let n=N.after(e),o=Wn(t).prev(n);return o?o.toRange():null},PF=(e,t,n,s)=>{let o=TF(e,s),r=e.parentNode;return r&&(r.insertBefore(o[0],e),L.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e)),cv(t[t.length-1],n)},BF=(e,t,n)=>{let s=e.parentNode;return s&&L.each(t,o=>{s.insertBefore(o,e)}),DF(e,n)},OF=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),cv(t[0],n)),IF=(e,t,n,s)=>{let o=wF(t,e,s),r=od(t,n.startContainer),a=NF(kF(o.firstChild)),i=1,l=2,c=t.getRoot(),u=f=>{let d=N.fromRangeStart(n),g=Wn(t.getRoot()),h=f===i?g.prev(d):g.next(d),p=h?.getNode();return p?od(t,p)!==r:!0};return r?u(i)?BF(r,a,c):u(l)?OF(r,a,c,t):PF(r,a,c,n):null},FF=["pre"],LF=(e,t,n,s)=>{var o;let r=t.firstChild,a=t.lastChild,i=a.attr("data-mce-type")==="bookmark"?a.prev:a,l=r===i,c=ke(FF,r.name);if(l&&c){let u=r.attr("contenteditable")!=="false",f=((o=e.getParent(n,e.isBlock))===null||o===void 0?void 0:o.nodeName.toLowerCase())===r.name,d=m.from(po(s,n)).forall(cn);return u&&f&&d}else return!1},rd=Ri,$F=(e,t,n)=>{if(U(n)){let s=e.getParent(t.endContainer,rd);return n===s&&uf(C.fromDom(n),t)}else return!1},MF=(e,t)=>{if(e.isBlock(t)&&e.isEditable(t)){let n=t.childNodes;return n.length===1&&Le(n[0])||n.length===0}else return!1},UF=(e,t,n)=>{var s;n.getAttribute("data-mce-bogus")==="all"?(s=n.parentNode)===null||s===void 0||s.insertBefore(e.dom.createFragment(t),n):MF(e.dom,n)?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})},zF=(e,t,n)=>{m.from(e.getParent(t,"td,th")).map(C.fromDom).each(s=>hT(s,n))},HF=(e,t)=>{let n=e.schema.getTextInlineElements(),s=e.dom;if(t){let o=e.getBody(),r=Qf(e),a="*[data-mce-fragment]",i=s.select(a);L.each(i,l=>{let c=d=>U(n[d.nodeName.toLowerCase()]),u=d=>d.childNodes.length===1;if((d=>!(gy(s,d)||OO(s,d)))(l)&&c(l)&&u(l)){let d=or(s,l),g=(y,v)=>Qn(y,E=>ke(v,E)),h=y=>u(l)&&s.is(y,a)&&c(y)&&(y.nodeName===l.nodeName&&g(d,or(s,y))||h(y.children[0])),p=y=>U(y)&&y!==o&&(r.compare(l,y)||p(y.parentElement)),b=y=>U(y)&&y!==o&&s.is(y,a)&&(FO(s,l,y)||b(y.parentElement));(h(l.children[0])||p(l.parentElement)&&!b(l.parentElement))&&s.remove(l,!0)}})}},WF=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},VF=e=>{L.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},jF=e=>!!e.getAttribute("data-mce-fragment"),qF=(e,t)=>U(t)&&!e.schema.getVoidElements()[t.nodeName],KF=(e,t)=>{var n,s,o;let r,a=e.dom,i=e.selection;if(!t)return;i.scrollIntoView(t);let l=po(e.getBody(),t);if(l&&a.getContentEditable(l)==="false"){a.remove(t),i.select(l);return}let c=a.createRng(),u=t.previousSibling;if(F(u)){c.setStart(u,(s=(n=u.nodeValue)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0);let g=t.nextSibling;F(g)&&(u.appendData(g.data),(o=g.parentNode)===null||o===void 0||o.removeChild(g))}else c.setStartBefore(t),c.setEndBefore(t);let f=g=>{let h=N.fromRangeStart(g);return h=Wn(e.getBody()).next(h),h?.toRange()},d=a.getParent(t,a.isBlock);if(a.remove(t),d&&a.isEmpty(d)){let g=rd(d);Po(C.fromDom(d)),c.setStart(d,0),c.setEnd(d,0),!g&&!jF(d)&&(r=f(c))?(c=r,a.remove(d)):a.add(d,a.create("br",g?{}:{"data-mce-bogus":"1"}))}i.setRng(c)},GF=e=>{let t=e.dom,n=sd(e.selection.getRng());e.selection.setRng(n);let s=t.getParent(n.startContainer,rd);$F(t,n,s)?Yf(e,n,C.fromDom(s)):XF(n)||YF(n)?n.deleteContents():e.getDoc().execCommand("Delete",!1)},YF=e=>uv(e,F),XF=e=>uv(e,zN),uv=(e,t)=>e.startContainer===e.endContainer&&e.endOffset-e.startOffset===1&&t(e.startContainer.childNodes[e.startOffset]),ZF=e=>{for(let t=e;t;t=t.walk())if(t.attr("id")==="mce_marker")return m.some(t);return m.none()},QF=(e,t,n)=>{var s;return Ie(n.children(),ov)&&((s=e.getParent(t,e.isBlock))===null||s===void 0?void 0:s.nodeName)==="SUMMARY"},JF=(e,t,n)=>{var s,o;let r=e.selection,a=e.dom,i=e.parser,l=n.merge,c=Ts({validate:!0},e.schema),u='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';n.preserve_zwsp||(t=Vt(t)),t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,u);let f=r.getRng(),d=f.startContainer,g=e.getBody();d===g&&r.isCollapsed()&&a.isBlock(g.firstChild)&&qF(e,g.firstChild)&&a.isEmpty(g.firstChild)&&(f=a.createRng(),f.setStart(g.firstChild,0),f.setEnd(g.firstChild,0),r.setRng(f)),r.isCollapsed()||GF(e);let h=r.getNode(),p={context:h.nodeName.toLowerCase(),data:n.data,insert:!0},b=i.parse(t,p);if(n.paste===!0&&EF(e.schema,b)&&RF(a,h))return f=IF(c,a,r.getRng(),b),f&&r.setRng(f),t;n.paste===!0&&LF(a,b,h,e.getBody())&&((s=b.firstChild)===null||s===void 0||s.unwrap()),WF(b);let y=b.lastChild;if(y&&y.attr("id")==="mce_marker"){let v=y;for(y=y.prev;y&&y.name!=="table";y=y.walk(!0))if(y.type===3||!a.isBlock(y.name)){y.parent&&e.schema.isValidChild(y.parent.name,"span")&&y.parent.insert(v,y,y.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(h),!p.invalid&&!QF(a,h,b))t=c.serialize(b),UF(e,t,h);else{e.selection.setContent(u);let v=r.getNode(),E,w=e.getBody();for(Yr(v)?v=E=w:E=v;E&&E!==w;)v=E,E=E.parentNode;t=v===w?w.innerHTML:a.getOuterHTML(v);let T=i.parse(t),B=ZF(T),H=B.bind(mF).getOr(T);B.each(z=>z.replace(b));let x=b.children(),_=(o=b.parent)!==null&&o!==void 0?o:T;b.unwrap();let P=se(x,z=>nd(e.schema,z,_));td(P,e.schema,H),iv(i.getNodeFilters(),i.getAttributeFilters(),T),t=c.serialize(T),v===w?a.setHTML(w,t):a.setOuterHTML(v,t)}return HF(e,l),KF(e,a.get("mce_marker")),VF(e.getBody()),zF(a,r.getStart(),e.schema),rR(e.schema,e.getBody(),r.getStart()),t},yl=e=>e instanceof Et,eL=e=>{sr(e)&&ht(e.getBody()).each(t=>{let n=t.getNode(),s=Mn(n)?ht(n).getOr(t):t;e.selection.setRng(s.toRange())})},ad=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&eL(e)},tL=(e,t,n,s)=>{if(n=Vt(n),n.length===0||/^\s+$/.test(n)){let o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");let r=pt(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,ua(e),n)):n||(n=o),ad(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=Ts({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));let o=Fi(C.fromDom(t))?n:L.trim(n);return ad(e,o,s.no_selection),{content:o,html:o}}},nL=(e,t,n,s)=>{iv(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);let o=Ts({validate:!1},e.schema).serialize(n),r=Vt(Fi(C.fromDom(t))?o:L.trim(o));return ad(e,r,s.no_selection),{content:n,html:r}},sL=(e,t,n)=>m.from(e.getBody()).map(s=>yl(t)?nL(e,s,t,n):tL(e,s,t,n)).getOr({content:t,html:yl(n.content)?"":n.content}),id=hf,fv=(e,t,n)=>{let s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){let r=s[o];if(en(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},ld=(e,t,n,s,o)=>{let r=e.dom.getRoot();if(t===r)return!1;let a=e.dom.getParent(t,i=>fv(e,i,n)?!0:i.parentNode===r||!!jn(e,i,n,s,!0));return!!jn(e,a,n,s,o)},vl=(e,t,n)=>tt(n)&&id(t,n.inline)||Vn(n)&&id(t,n.block)?!0:en(n)?q(t)&&e.is(t,n.selector):!1,dv=(e,t,n,s,o,r)=>{let a=n[s],i=s==="attributes";if(_e(n.onmatch))return n.onmatch(t,n,s);if(a){if(Rg(a)){for(let l=0;l<a.length;l++)if(i?e.getAttrib(t,a[l]):tl(e,t,a[l]))return!0}else for(let l in a)if(oe(a,l)){let c=i?e.getAttrib(t,l):tl(e,t,l),u=Rs(a[l],r),f=qe(c)||Dr(c);if(f&&qe(u))continue;if(o&&f&&!n.exact||(!o||n.exact)&&!id(c,bf(u,l)))return!1}}return!0},jn=(e,t,n,s,o)=>{let r=e.formatter.get(n),a=e.dom;if(r&&q(t))for(let i=0;i<r.length;i++){let l=r[i];if(vl(e.dom,t,l)&&dv(a,t,l,"attributes",o,s)&&dv(a,t,l,"styles",o,s)){let c=l.classes;if(c){for(let u=0;u<c.length;u++)if(!e.dom.hasClass(t,Rs(c[u],s)))return}return l}}},cd=(e,t,n,s,o)=>{if(s)return ld(e,s,t,n,o);if(s=e.selection.getNode(),ld(e,s,t,n,o))return!0;let r=e.selection.getStart();return!!(r!==s&&ld(e,r,t,n,o))},oL=(e,t,n)=>{let s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){let l=t[i];!o[l]&&jn(e,a,l,n)&&(o[l]=!0,s.push(l))}},e.dom.getRoot()),s},rL=(e,t)=>{let n=o=>Se(o,C.fromDom(e.getBody())),s=(o,r)=>jn(e,o.dom,r)?m.some(r):m.none();return m.from(e.selection.getStart(!0)).bind(o=>ou(C.fromDom(o),r=>Ao(t,a=>s(r,a)),n)).getOrNull()},aL=(e,t)=>{let n=e.formatter.get(t),s=e.dom;if(n&&e.selection.isEditable()){let o=e.selection.getStart(),r=nl(s,o);for(let a=n.length-1;a>=0;a--){let i=n[a];if(!en(i))return!0;for(let l=r.length-1;l>=0;l--)if(s.is(r[l],i.selector))return!0}}return!1},iL=(e,t,n)=>Pt(n,(s,o)=>{let r=t1(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),Ra=et,lL=(e,t)=>e.importNode(t,!0),mv=e=>{if(e){let t=new st(e,e);for(let n=t.current();n;n=t.next())if(F(n))return n}return null},ud=e=>{let t=C.fromTag("span");return ns(t,{id:of,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&Ke(t,C.fromText(Ra)),t},cL=e=>{let t=mv(e);return t&&t.data.charAt(0)===Ra&&t.deleteData(0,1),t},fd=(e,t,n)=>{let s=e.dom,o=e.selection;if(pC(t))mo(e,!1,C.fromDom(t),n,!0);else{let r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,l=r.startOffset,c=r.endContainer,u=r.endOffset,f=cL(t);s.remove(t,!0),i===f&&l>0&&r.setStart(f,l-1),c===f&&u>0&&r.setEnd(f,u-1),a&&s.isEmpty(a)&&ks(C.fromDom(a)),o.setRng(r)}},dd=(e,t,n)=>{let s=e.dom,o=e.selection;if(t)fd(e,t,n);else if(t=io(e.getBody(),o.getStart()),!t)for(;t=s.get(of);)fd(e,t,n)},uL=(e,t,n)=>{var s,o;let r=e.dom,a=r.getParent(n,G(gf,e.schema));a&&r.isEmpty(a)?(s=n.parentNode)===null||s===void 0||s.replaceChild(t,n):(pT(C.fromDom(n)),r.isEmpty(n)?(o=n.parentNode)===null||o===void 0||o.replaceChild(t,n):r.insertAfter(t,n))},gv=(e,t)=>(e.appendChild(t),t),pv=(e,t)=>{var n;let s=_r(e,(r,a)=>gv(r,a.cloneNode(!1)),t),o=(n=s.ownerDocument)!==null&&n!==void 0?n:document;return gv(s,o.createTextNode(Ra))},fL=(e,t,n,s,o,r)=>{let a=e.formatter,i=e.dom,l=se(Ut(a.get()),f=>f!==s&&!ft(f,"removeformat")),c=iL(e,n,l);if(se(c,f=>!n1(e,f,s)).length>0){let f=n.cloneNode(!1);return i.add(t,f),a.remove(s,o,f,r),i.remove(f),m.some(f)}else return m.none()},hv=e=>Rp(e,jr(e).replace(new RegExp(`${Je}$`)," ")),bv=(e,t)=>{let n=()=>{t!==null&&!e.dom.isEmpty(t)&&bs(C.fromDom(t)).each(s=>{Nt(s)?hv(s):tu(s,o=>Nt(o)).each(o=>{Nt(o)&&hv(o)})})};e.once("input",s=>{s.data&&!lo(s.data)&&(s.isComposing?e.once("compositionend",()=>{n()}):n())})},dL=(e,t,n)=>{let s,o=e.selection,r=e.formatter.get(t);if(!r)return;let a=o.getRng(),i=a.startOffset,c=a.startContainer.nodeValue;s=io(e.getBody(),o.getStart());let u=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&i>0&&i<c.length&&u.test(c.charAt(i))&&u.test(c.charAt(i-1))){let f=o.getBookmark();a.collapse(!0);let d=co(e.dom,a,r);d=ul(d),e.formatter.apply(t,n,d),o.moveToBookmark(f)}else{let f=s?mv(s):null;(!s||f?.data!==Ra)&&(s=lL(e.getDoc(),ud(!0).dom),f=s.firstChild,a.insertNode(s),i=1,bv(e,s)),e.formatter.apply(t,n,s),o.setCursorLocation(f,i)}},mL=(e,t,n,s)=>{let o=e.dom,r=e.selection,a=!1,i=e.formatter.get(t);if(!i)return;let l=r.getRng(),c=l.startContainer,u=l.startOffset,f=c;F(c)&&(u!==c.data.length&&(a=!0),f=f.parentNode);let d=[],g;for(;f;){if(jn(e,f,t,n,s)){g=f;break}f.nextSibling&&(a=!0),d.push(f),f=f.parentNode}if(g)if(a){let h=r.getBookmark();l.collapse(!0);let p=co(o,l,i,{includeTrailingSpace:!0});p=ul(p),e.formatter.remove(t,n,p,s),r.moveToBookmark(h)}else{let h=io(e.getBody(),g),p=U(h)?o.getParents(g.parentNode,He,h):[],b=ud(!1).dom;uL(e,b,h??g);let y=fL(e,b,g,t,n,s),v=pv([...d,...y.toArray(),...p],b);h&&fd(e,h,U(h)),r.setCursorLocation(v,1),bv(e,b),o.isEmpty(g)&&o.remove(g)}},gL=(e,t,n)=>{let s=e.selection,o=e.getBody();dd(e,null,n),(t===8||t===46)&&s.isCollapsed()&&s.getStart().innerHTML===Ra&&dd(e,io(o,s.getStart()),!0),(t===37||t===39)&&dd(e,io(o,s.getStart()),!0)},pL=e=>F(e)&&Dc(e.data,Je),hL=e=>{e.on("mouseup keydown",t=>{gL(e,t.keyCode,pL(e.selection.getRng().endContainer))})},Cv=e=>{let t=ud(!1),n=pv(e,t.dom);return{caretContainer:t,caretPosition:N(n,0)}},yv=(e,t)=>{let{caretContainer:n,caretPosition:s}=Cv(t);return Bt(C.fromDom(e),n),Te(C.fromDom(e)),s},bL=(e,t)=>{let{caretContainer:n,caretPosition:s}=Cv(t);return e.insertNode(n.dom),s},vv=(e,t)=>{if(Qt(t.dom))return!1;let n=e.schema.getTextInlineElements();return oe(n,Ce(t))&&!Qt(t.dom)&&!Gs(t.dom)},Ta={},Ev=vn(["pre"]),CL=(e,t)=>{Ta[e]||(Ta[e]=[]),Ta[e].push(t)},yL=(e,t)=>{oe(Ta,e)&&D(Ta[e],n=>{n(t)})};CL("pre",e=>{let t=e.selection.getRng(),n=o=>r=>{let a=r.previousSibling;return Ev(a)&&ke(o,a)},s=(o,r)=>{let a=C.fromDom(r),i=hs(a).dom;Te(a),js(C.fromDom(o),[C.fromTag("br",i),C.fromTag("br",i),...dt(a)])};if(!t.collapsed){let o=e.selection.getSelectedBlocks(),r=se(se(o,Ev),n(o));D(r,a=>{s(a.previousSibling,a)})}});let Sv=["fontWeight","fontStyle","color","fontSize","fontFamily"],vL=e=>ot(e.styles)&&Ie(Ut(e.styles),t=>ke(Sv,t)),EL=e=>Ze(e,t=>tt(t)&&t.inline==="span"&&vL(t)),wv=(e,t)=>{let n=e.get(t);return Be(n)?EL(n):m.none()},kv=(e,t)=>Ot(t,N.fromRangeStart(e)).isNone(),_v=(e,t)=>Rt(t,N.fromRangeEnd(e)).exists(n=>!Le(n.getNode())||Rt(t,n).isSome())===!1,Av=e=>t=>WN(t)&&e.isEditable(t),SL=e=>{let t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(t.length===1)return kv(n,t[0])&&_v(n,t[0])?t:[];{let s=xt(t).filter(a=>kv(n,a)).toArray(),o=ps(t).filter(a=>_v(n,a)).toArray(),r=t.slice(1,-1);return s.concat(r).concat(o)}},wL=e=>se(SL(e),Av(e.dom)),xv=e=>se(e.getSelectedBlocks(),Av(e.dom)),md=L.each,gd=e=>q(e)&&!Jt(e)&&!Qt(e)&&!Gs(e),Nv=(e,t)=>{for(let n=e;n;n=n[t]){if(F(n)&&Pn(n.data))return e;if(q(n)&&!Jt(n))return n}return e},Rv=(e,t,n)=>{let s=Qf(e),o=$n(t)&&e.dom.isEditable(t),r=$n(n)&&e.dom.isEditable(n);if(o&&r){let a=Nv(t,"previousSibling"),i=Nv(n,"nextSibling");if(s.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){let c=l;l=l.nextSibling,a.appendChild(c)}return e.dom.remove(i),L.each(L.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},Tv=(e,t,n,s)=>{var o;if(s&&t.merge_siblings!==!1){let r=(o=Rv(e,dC(s),s))!==null&&o!==void 0?o:s;Rv(e,r,dC(r,!0))}},kL=(e,t,n)=>{if(t.clear_child_styles){let s=t.links?"*:not(a)":"*";md(e.select(s,n),o=>{gd(o)&&e.isEditable(o)&&md(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},pd=(e,t,n)=>{md(e.childNodes,s=>{gd(s)&&(t(s)&&n(s),s.hasChildNodes()&&pd(s,t,n))})},_L=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},Dv=(e,t)=>n=>!!(n&&tl(e,n,t)),Pv=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),_L(e,s)},ho=Dn.generate([{keep:[]},{rename:["name"]},{removed:[]}]),AL=/^(src|href|style)$/,hd=L.each,El=hf,xL=e=>/^(TR|TH|TD)$/.test(e.nodeName),Bv=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),Ov=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(q(s)){let r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return F(s)&&n&&o>=s.data.length&&(s=new st(s,e.getBody()).next()||s),F(s)&&!n&&o===0&&(s=new st(s,e.getBody()).prev()||s),s},Iv=(e,t)=>{let n=t?"firstChild":"lastChild",s=e[n];return xL(e)&&s?e.nodeName==="TR"&&s[n]||s:e},bd=(e,t,n,s)=>{var o;let r=e.create(n,s);return(o=t.parentNode)===null||o===void 0||o.insertBefore(r,t),r.appendChild(t),r},Fv=(e,t,n,s,o)=>{let r=C.fromDom(t),a=C.fromDom(e.create(s,o)),i=n?fp(r):up(r);return js(a,i),n?(Bt(r,a),Kc(a,r)):(ts(r,a),Ke(a,r)),a.dom},NL=(e,t)=>t.links&&e.nodeName==="A",Lv=(e,t,n)=>{let s=t.parentNode,o,r=e.dom,a=pt(e);Vn(n)&&s===r.getRoot()&&(!n.list_block||!El(t,n.list_block))&&D(Mt(t.childNodes),i=>{er(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=bd(r,i,a),r.setAttribs(o,ua(e))):o=null}),!(r1(n)&&!El(n.inline,t))&&r.remove(t,!0)},$v=(e,t,n)=>ln(e)?{name:t,value:null}:{name:e,value:Rs(t,n)},Mv=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},Uv=(e,t,n,s,o)=>{let r=!1;hd(n.styles,(a,i)=>{let{name:l,value:c}=$v(i,a,s),u=bf(c,l);(n.remove_similar||yt(c)||!q(o)||El(tl(e,o,l),u))&&e.setStyle(t,l,""),r=!0}),r&&Mv(e,t)},RL=(e,t,n)=>{t==="removeformat"?D(xv(e.selection),s=>{D(Sv,o=>e.dom.setStyle(s,o,"")),Mv(e.dom,s)}):wv(e.formatter,t).each(s=>{D(xv(e.selection),o=>Uv(e.dom,o,s,n,null))})},zv=(e,t,n,s,o)=>{let r=e.dom,a=Qf(e),i=e.schema;if(tt(t)&&hu(i,t.inline)&&Xs(i,s)&&s.parentElement===e.getBody())return Lv(e,s,t),ho.removed();if(!t.ceFalseOverride&&s&&r.getContentEditableParent(s)==="false"||s&&!vl(r,s,t)&&!NL(s,t))return ho.keep();let l=s,c=t.preserve_attributes;if(tt(t)&&t.remove==="all"&&Be(c)){let u=se(r.getAttribs(l),f=>ke(c,f.name.toLowerCase()));if(r.removeAllAttribs(l),D(u,f=>r.setAttrib(l,f.name,f.value)),u.length>0)return ho.rename("span")}if(t.remove!=="all"){Uv(r,l,t,n,o),hd(t.attributes,(f,d)=>{let{name:g,value:h}=$v(d,f,n);if(t.remove_similar||yt(h)||!q(o)||El(r.getAttrib(o,g),h)){if(g==="class"){let p=r.getAttrib(l,g);if(p){let b="";if(D(p.split(/\s+/),y=>{/mce\-\w+/.test(y)&&(b+=(b?" ":"")+y)}),b){r.setAttrib(l,g,b);return}}}if(AL.test(g)&&l.removeAttribute("data-mce-"+g),g==="style"&&vn(["li"])(l)&&r.getStyle(l,"list-style-type")==="none"){l.removeAttribute(g),r.setStyle(l,"list-style-type","none");return}g==="class"&&l.removeAttribute("className"),l.removeAttribute(g)}}),hd(t.classes,f=>{f=Rs(f,n),(!q(o)||r.hasClass(o,f))&&r.removeClass(l,f)});let u=r.getAttribs(l);for(let f=0;f<u.length;f++){let d=u[f].nodeName;if(!a.isAttributeInternal(d))return ho.keep()}}return t.remove!=="none"?(Lv(e,l,t),ho.removed()):ho.keep()},TL=(e,t,n,s,o)=>{let r;return t.parentNode&&D(nl(e.dom,t.parentNode).reverse(),a=>{if(!r&&q(a)&&a.id!=="_start"&&a.id!=="_end"){let i=jn(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},DL=(e,t,n,s)=>zv(e,t,n,s,s).fold(W(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),W(null)),PL=(e,t,n,s,o,r,a,i)=>{var l,c;let u,f,d=e.dom;if(n){let g=n.parentNode;for(let h=s.parentNode;h&&h!==g;h=h.parentNode){let p=d.clone(h,!1);for(let b=0;b<t.length&&(p=DL(e,t[b],i,p),p!==null);b++);p&&(u&&p.appendChild(u),f||(f=p),u=p)}r&&(!a.mixed||!d.isBlock(n))&&(s=(l=d.split(n,s))!==null&&l!==void 0?l:s),u&&f&&((c=o.parentNode)===null||c===void 0||c.insertBefore(u,o),f.appendChild(o),tt(a)&&Tv(e,a,i,u))}return s},BL=(e,t,n,s,o)=>{let r=e.formatter.get(t),a=r[0],i=e.dom,l=e.selection,c=p=>{let b=TL(e,p,t,n,o);return PL(e,r,b,p,p,!0,a,n)},u=p=>Jt(p)&&q(p)&&(p.id==="_start"||p.id==="_end"),f=p=>Ie(r,b=>Da(e,b,n,p,p)),d=p=>{let b=Mt(p.childNodes),v=f(p)||Ie(r,T=>vl(i,p,T)),E=p.parentNode;if(!v&&U(E)&&yf(a)&&f(E),a.deep&&b.length)for(let T=0;T<b.length;T++)d(b[T]);D(["underline","line-through","overline"],T=>{q(p)&&e.dom.getStyle(p,"text-decoration")===T&&p.parentNode&&gC(i,p.parentNode)===T&&Da(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:T}},void 0,p)})},g=p=>{let b=i.get(p?"_start":"_end");if(b){let y=b[p?"firstChild":"lastChild"];return u(y)&&(y=y[p?"firstChild":"lastChild"]),F(y)&&y.data.length===0&&(y=p?b.previousSibling||b.nextSibling:b.nextSibling||b.previousSibling),i.remove(b,!0),y}else return null},h=p=>{let b,y,v=co(i,p,r,{includeTrailingSpace:p.collapsed});if(a.split){if(v=ul(v),b=Ov(e,v,!0),y=Ov(e,v),b!==y){if(b=Iv(b,!0),y=Iv(y,!1),Bv(i,b,y)){let w=m.from(b.firstChild).getOr(b);c(Fv(i,w,!0,"span",{id:"_start","data-mce-type":"bookmark"})),g(!0);return}if(Bv(i,y,b)){let w=m.from(y.lastChild).getOr(y);c(Fv(i,w,!1,"span",{id:"_end","data-mce-type":"bookmark"})),g(!1);return}b=bd(i,b,"span",{id:"_start","data-mce-type":"bookmark"}),y=bd(i,y,"span",{id:"_end","data-mce-type":"bookmark"});let E=i.createRng();E.setStartAfter(b),E.setEndBefore(y),va(i,E,w=>{D(w,T=>{!Jt(T)&&!Jt(T.parentNode)&&c(T)})}),c(b),c(y),b=g(!0),y=g()}else b=y=c(b);v.startContainer=b.parentNode?b.parentNode:b,v.startOffset=i.nodeIndex(b),v.endContainer=y.parentNode?y.parentNode:y,v.endOffset=i.nodeIndex(y)+1}va(i,v,E=>{D(E,d)})};if(s){if(ya(s)){let p=i.createRng();p.setStartBefore(s),p.setEndAfter(s),h(p)}else h(s);fb(e,t,s,n);return}!l.isCollapsed()||!tt(a)||Jo(e).length?(fC(e,()=>df(e,h),p=>tt(a)&&cd(e,t,n,p)),e.nodeChanged()):mL(e,t,n,o),RL(e,t,n),fb(e,t,s,n)},Hv=(e,t,n,s,o)=>{(s||e.selection.isEditable())&&BL(e,t,n,s,o)},Da=(e,t,n,s,o)=>zv(e,t,n,s,o).fold(Oe,r=>(e.dom.rename(s,r),!0),He),Wv=L.each,OL=(e,t,n,s)=>{let o=r=>{if($n(r)&&q(r.parentNode)&&e.isEditable(r)){let a=gC(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(L.walk(s,o,"childNodes"),o(s))},IL=(e,t,n,s)=>{if(t.styles&&t.styles.backgroundColor){let o=Dv(e,"fontSize");pd(s,r=>o(r)&&e.isEditable(r),Pv(e,"backgroundColor",Rs(t.styles.backgroundColor,n)))}},FL=(e,t,n,s)=>{if(tt(t)&&(t.inline==="sub"||t.inline==="sup")){let o=Dv(e,"fontSize");pd(s,a=>o(a)&&e.isEditable(a),Pv(e,"fontSize",""));let r=se(e.select(t.inline==="sup"?"sub":"sup",s),e.isEditable);e.remove(r,!0)}},LL=(e,t,n,s)=>{Wv(t,o=>{tt(o)&&Wv(e.dom.select(o.inline,s),r=>{gd(r)&&Da(e,o,n,r,o.exact?r:null)}),kL(e.dom,o,s)})},$L=(e,t,n,s,o)=>{let r=o.parentNode;jn(e,r,n,s)&&Da(e,t,s,o)||t.merge_with_parents&&r&&e.dom.getParent(r,a=>jn(e,a,n,s)?(Da(e,t,s,o),!0):!1)},Sl=L.each,ML=(e,t,n,s)=>{if(fP(e)&&tt(t)&&n.parentNode){let o=gh(e.schema),r=sN(C.fromDom(n),a=>Qt(a.dom));return xo(o,s)&&as(e.schema,n.parentNode,{skipBogus:!1,includeZwsp:!0})&&!r}else return!1},Vv=(e,t,n,s)=>{if(Sl(n.styles,(o,r)=>{e.setStyle(t,r,Rs(o,s))}),n.styles){let o=e.getAttrib(t,"style");o&&e.setAttrib(t,"data-mce-style",o)}},UL=(e,t,n,s)=>{let o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(h,p=r)=>{_e(p.onformat)&&p.onformat(h,p,n,s),Vv(i,h,p,n),Sl(p.attributes,(b,y)=>{i.setAttrib(h,y,Rs(b,n))}),Sl(p.classes,b=>{let y=Rs(b,n);i.hasClass(h,y)||i.addClass(h,y)})},u=(h,p)=>{let b=!1;return Sl(h,y=>en(y)?i.getContentEditable(p)==="false"&&!y.ceFalseOverride||U(y.collapsed)&&y.collapsed!==a?!0:i.is(p,y.selector)&&!Qt(p)?(c(p,y),b=!0,!1):!0:!1),b},f=h=>{if(ee(h)){let p=i.create(h);return c(p),p}else return null},d=(h,p,b)=>{let y=[],v=!0,E=r.inline||r.block,w=f(E),T=x=>s1(r)&&jn(e,x,t,n),B=(x,_,P)=>{let z=o1(r)&&gf(e.schema,x)&&er(e,_,E);return P&&z},H=(x,_,P,z)=>{let X=x.nodeName.toLowerCase(),re=er(e,E,X)&&er(e,_,E),ie=!b&&F(x)&&Li(x.data),pe=Qt(x),Ee=!tt(r)||!h.isBlock(x);return(P||z)&&re&&!ie&&!pe&&Ee};va(h,p,x=>{let _,P=z=>{let X=!1,re=v,ie=!1,pe=z.parentNode,Ee=pe.nodeName.toLowerCase(),Ue=h.getContentEditable(z);U(Ue)&&(re=v,v=Ue==="true",X=!0,ie=mC(e,z));let We=v&&!X;if(Le(z)&&!ML(e,r,z,Ee)){_=null,Vn(r)&&h.remove(z);return}if(T(z)){_=null;return}if(B(z,Ee,We)){let Ye=h.rename(z,E);c(Ye),y.push(Ye),_=null;return}if(en(r)){let Ye=u(o,z);if(!Ye&&U(pe)&&yf(r)&&(Ye=u(o,pe)),!tt(r)||Ye){_=null;return}}U(w)&&H(z,Ee,We,ie)?(_||(_=h.clone(w,!1),pe.insertBefore(_,z),y.push(_)),ie&&X&&(v=re),_.appendChild(z)):(_=null,D(Mt(z.childNodes),P),X&&(v=re),_=null)};D(x,P)}),r.links===!0&&D(y,x=>{let _=P=>{P.nodeName==="A"&&c(P,r),D(Mt(P.childNodes),_)};_(x)}),D(y,x=>{let _=X=>{let re=0;return D(X.childNodes,ie=>{!JB(ie)&&!Jt(ie)&&re++}),re},P=X=>Ze(X.childNodes,mf).filter(ie=>h.getContentEditable(ie)!=="false"&&vl(h,ie,r)).map(ie=>{let pe=h.clone(ie,!1);return c(pe),h.replace(pe,X,!0),h.remove(ie,!0),pe}).getOr(X),z=_(x);if((y.length>1||!h.isBlock(x))&&z===0){h.remove(x,!0);return}(tt(r)||Vn(r)&&r.wrapper)&&(!r.exact&&z===1&&(x=P(x)),LL(e,o,n,x),$L(e,r,t,n,x),IL(h,r,n,x),OL(h,r,n,x),FL(h,r,n,x),Tv(e,r,n,x))})},g=ya(s)?s:l.getNode();if(i.getContentEditable(g)==="false"&&!mC(e,g)){s=g,u(o,s),ub(e,t,s,n);return}if(r){if(s)if(ya(s)){if(!u(o,s)){let h=i.createRng();h.setStartBefore(s),h.setEndAfter(s),d(i,co(i,h,o),!0)}}else d(i,s,!0);else!a||!tt(r)||Jo(e).length?(l.setRng(sd(l.getRng())),fC(e,()=>{df(e,(h,p)=>{let b=p?h:co(i,h,o);d(i,b,!1)})},He),e.nodeChanged()):dL(e,t,n),wv(e.formatter,t).each(h=>{D(wL(e.selection),p=>Vv(i,p,h,n))});yL(t,e)}ub(e,t,s,n)},jv=(e,t,n,s)=>{(s||e.selection.isEditable())&&UL(e,t,n,s)},qv=e=>oe(e,"vars"),zL=(e,t)=>{e.set({}),t.on("NodeChange",n=>{Xv(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{let s=m.from(n.node).map(o=>ya(o)?o:o.startContainer).bind(o=>q(o)?m.some(o):m.from(o.parentElement)).getOrThunk(()=>Kv(t));Xv(t,s,e.get())})},Kv=e=>e.selection.getStart(),Gv=(e,t,n,s,o)=>mg(t,i=>{let l=e.formatter.matchNode(i,n,o??{},s);return!rt(l)},i=>fv(e,i,n)?!0:s?!1:U(e.formatter.matchNode(i,n,o,!0))),Yv=(e,t)=>{let n=t??Kv(e);return se(nl(e.dom,n),s=>q(s)&&!Gs(s))},Xv=(e,t,n)=>{let s=Yv(e,t);Ne(n,(o,r)=>{let a=i=>{let l=Gv(e,s,r,i.similar,qv(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);let u=l.getOr(t);qv(i)?i.callback(c,{node:u,format:r,parents:s}):D(i.callbacks,f=>f(c,{node:u,format:r,parents:s}))}};D([o.withSimilar,o.withoutSimilar],a),D(o.withVars,a)})},HL=(e,t,n,s,o,r)=>{let a=t.get();D(n.split(","),i=>{let l=Fe(a,i).getOrThunk(()=>{let u={withSimilar:{state:nt(!1),similar:!0,callbacks:[]},withoutSimilar:{state:nt(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=u,u}),c=()=>{let u=Yv(e);return Gv(e,u,i,o,r).isSome()};if(rt(r)){let u=o?l.withSimilar:l.withoutSimilar;u.callbacks.push(s),u.callbacks.length===1&&u.state.set(c())}else l.withVars.push({state:nt(c()),similar:o,vars:r,callback:s})}),t.set(a)},WL=(e,t,n)=>{let s=e.get();D(t.split(","),o=>Fe(s,o).each(r=>{s[o]={withSimilar:we(Q({},r.withSimilar),{callbacks:se(r.withSimilar.callbacks,a=>a!==n)}),withoutSimilar:we(Q({},r.withoutSimilar),{callbacks:se(r.withoutSimilar.callbacks,a=>a!==n)}),withVars:se(r.withVars,a=>a.callback!==n)}})),e.set(s)},VL=(e,t,n,s,o,r)=>(HL(e,t,n,s,o,r),{unbind:()=>WL(t,n,s)}),jL=(e,t,n,s)=>{let o=e.formatter.get(t);o&&(cd(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?Hv(e,t,n,s):jv(e,t,n,s))},Zv=L.explode,Qv=()=>{let e={};return{addFilter:(o,r)=>{D(Zv(o),a=>{oe(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>Tc(e),removeFilter:(o,r)=>{D(Zv(o),a=>{if(oe(e,a))if(U(r)){let i=e[a],l=se(i.callbacks,c=>c!==r);l.length>0?i.callbacks=l:delete e[a]}else delete e[a]})}}},qL=(e,t)=>{D(t,n=>{e.attr(n,null)})},KL=(e,t,n)=>{e.addNodeFilter("font",s=>{D(s,o=>{let r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),l=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),l&&mi(l).each(c=>{r["font-size"]=n[c-1]}),o.name="span",o.attr("style",t.serialize(r)),qL(o,["color","face","size"])})})},GL=(e,t,n)=>{e.addNodeFilter("strike",s=>{let o=t.type!=="html4";D(s,r=>{if(o)r.name="s";else{let a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},YL=(e,t,n)=>{var s;let o=Au();t.convert_fonts_to_spans&&KL(e,o,L.explode((s=t.font_size_legacy_values)!==null&&s!==void 0?s:"")),GL(e,n,o)},XL=(e,t,n)=>{t.inline_styles&&YL(e,t,n)},ZL=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),QL=e=>{let t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},JL=e=>{try{return decodeURIComponent(e)}catch{return e}},Cd=e=>{let[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){let r=o[2]===";base64",a=JL(s),i=r?QL(a):a;return m.some({type:o[1],data:i,base64Encoded:r})}else return m.none()},Jv=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return m.none()}let o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return m.some(new Blob([o],{type:e}))},e$=e=>new Promise((t,n)=>{Cd(e).bind(({type:s,data:o,base64Encoded:r})=>Jv(s,o,r)).fold(()=>n("Invalid data URI"),t)}),t$=e=>Qe(e,"blob:")?ZL(e):Qe(e,"data:")?e$(e):Promise.reject("Unknown URI format"),eE=e=>new Promise((t,n)=>{let s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{var o;n((o=s.error)===null||o===void 0?void 0:o.message)},s.readAsDataURL(e)}),n$=0,s$=e=>(e||"blobid")+n$++,tE=(e,t,n)=>Cd(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return m.none();{let a=r?s:btoa(s);return n(a,o)}}),nE=(e,t,n)=>{let s=e.create(s$(),t,n);return e.add(s),s},sE=(e,t,n=!1)=>tE(t,n,(s,o)=>m.from(e.getByData(s,o)).orThunk(()=>Jv(o,s).map(r=>nE(e,r,s)))),o$=(e,t)=>{let n=()=>Promise.reject("Invalid data URI");if(Qe(t,"blob:")){let s=e.getByUri(t);return U(s)?Promise.resolve(s):t$(t).then(o=>eE(o).then(r=>tE(r,!1,a=>m.some(nE(e,o,a))).getOrThunk(n)))}else return Qe(t,"data:")?sE(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},r$=/^(?:(?:(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)([A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*))(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?)$/,a$=e=>m.from(e.match(r$)).bind(t=>Nr(t,1)).map(t=>Qe(t,"www.")?t.substring(4):t),oE=(e,t)=>{m.from(e.attr("src")).bind(a$).forall(n=>!ke(t,n))&&e.attr("sandbox","")},yd=(e,t)=>Qe(e,`${t}/`),i$=e=>rt(e)?"iframe":yd(e,"image")?"img":yd(e,"video")?"video":yd(e,"audio")?"audio":"iframe",l$=({type:e,src:t,width:n,height:s}={},o,r)=>{let a=i$(e),i=new Et(a,1);return i.attr(a==="audio"?{src:t}:{src:t,width:n,height:s}),(a==="audio"||a==="video")&&i.attr("controls",""),a==="iframe"&&o&&oE(i,r),i},c$=e=>U(e.attr("data-mce-bogus")),u$=e=>e.attr("src")===ye.transparentSrc||U(e.attr("data-mce-placeholder")),f$=(e,t)=>{let{blob_cache:n}=t;if(n){let s=o=>{let r=o.attr("src");u$(o)||c$(o)||qe(r)||sE(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};e.addAttributeFilter("src",o=>D(o,s))}},d$=(e,t)=>{var n,s;let o=e.schema;e.addAttributeFilter("href",l=>{let c=l.length,u=d=>d.split(" ").filter(h=>h.length>0).concat(["noopener"]).sort().join(" "),f=d=>{let g=d?L.trim(d):"";return/\b(noopener)\b/g.test(g)?g:u(g)};if(!t.allow_unsafe_link_target)for(;c--;){let d=l[c];d.name==="a"&&d.attr("target")==="_blank"&&d.attr("rel",f(d.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",l=>{let c=l.length,u,f,d,g;for(;c--;)if(g=l[c],g.name==="a"&&g.firstChild&&!g.attr("href"))for(d=g.parent,u=g.lastChild;u&&d;)f=u.prev,d.insert(u,g),u=f}),t.fix_list_elements&&e.addNodeFilter("ul,ol",l=>{let c=l.length,u,f;for(;c--;)if(u=l[c],f=u.parent,f&&(f.name==="ul"||f.name==="ol"))if(u.prev&&u.prev.name==="li")u.prev.append(u);else{let d=new Et("li",1);d.attr("style","list-style-type: none"),u.wrap(d)}});let r=o.getValidClasses();t.validate&&r&&e.addAttributeFilter("class",l=>{var c;let u=l.length;for(;u--;){let f=l[u],d=(c=f.attr("class"))!==null&&c!==void 0?c:"",g=L.explode(d," "),h="";for(let p=0;p<g.length;p++){let b=g[p],y=!1,v=r["*"];v&&v[b]&&(y=!0),v=r[f.name],!y&&v&&v[b]&&(y=!0),y&&(h&&(h+=" "),h+=b)}h.length||(h=null),f.attr("class",h)}}),f$(e,t);let a=(n=t.sandbox_iframes)!==null&&n!==void 0?n:!1,i=pg((s=t.sandbox_iframes_exclusions)!==null&&s!==void 0?s:[]);t.convert_unsafe_embeds&&e.addNodeFilter("object,embed",l=>D(l,c=>{c.replace(l$({type:c.attr("type"),src:c.name==="object"?c.attr("data"):c.attr("src"),width:c.attr("width"),height:c.attr("height")},a,i))})),a&&e.addNodeFilter("iframe",l=>D(l,c=>oE(c,i)))};let{entries:rE,setPrototypeOf:aE,isFrozen:m$,getPrototypeOf:g$,getOwnPropertyDescriptor:p$}=Object,{freeze:It,seal:fn,create:iE}=Object,{apply:vd,construct:Ed}=typeof Reflect<"u"&&Reflect;It||(It=function(t){return t}),fn||(fn=function(t){return t}),vd||(vd=function(t,n,s){return t.apply(n,s)}),Ed||(Ed=function(t,n){return new t(...n)});let wl=Lt(Array.prototype.forEach),h$=Lt(Array.prototype.lastIndexOf),lE=Lt(Array.prototype.pop),Pa=Lt(Array.prototype.push),b$=Lt(Array.prototype.splice),kl=Lt(String.prototype.toLowerCase),Sd=Lt(String.prototype.toString),cE=Lt(String.prototype.match),Ba=Lt(String.prototype.replace),C$=Lt(String.prototype.indexOf),y$=Lt(String.prototype.trim),_n=Lt(Object.prototype.hasOwnProperty),Ft=Lt(RegExp.prototype.test),Oa=v$(TypeError);function Lt(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return vd(e,t,s)}}function v$(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return Ed(e,n)}}function Ae(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kl;aE&&aE(e,null);let s=t.length;for(;s--;){let o=t[s];if(typeof o=="string"){let r=n(o);r!==o&&(m$(t)||(t[s]=r),o=r)}e[o]=!0}return e}function E$(e){for(let t=0;t<e.length;t++)_n(e,t)||(e[t]=null);return e}function bo(e){let t=iE(null);for(let[n,s]of rE(e))_n(e,n)&&(Array.isArray(s)?t[n]=E$(s):s&&typeof s=="object"&&s.constructor===Object?t[n]=bo(s):t[n]=s);return t}function Ia(e,t){for(;e!==null;){let s=p$(e,t);if(s){if(s.get)return Lt(s.get);if(typeof s.value=="function")return Lt(s.value)}e=g$(e)}function n(){return null}return n}let uE=It(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),wd=It(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),kd=It(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),S$=It(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_d=It(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),w$=It(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),fE=It(["#text"]),dE=It(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ad=It(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mE=It(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),_l=It(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),k$=fn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),_$=fn(/<%[\w\W]*|[\w\W]*%>/gm),A$=fn(/\$\{[\w\W]*/gm),x$=fn(/^data-[\-\w.\u00B7-\uFFFF]+$/),N$=fn(/^aria-[\-\w]+$/),gE=fn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),R$=fn(/^(?:\w+script|data):/i),T$=fn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pE=fn(/^html$/i),D$=fn(/^[a-z][.\w]*(-[.\w]+)+$/i);var hE=Object.freeze({__proto__:null,ARIA_ATTR:N$,ATTR_WHITESPACE:T$,CUSTOM_ELEMENT:D$,DATA_ATTR:x$,DOCTYPE_NAME:pE,ERB_EXPR:_$,IS_ALLOWED_URI:gE,IS_SCRIPT_OR_DATA:R$,MUSTACHE_EXPR:k$,TMPLIT_EXPR:A$});let Fa={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},P$=function(){return typeof window>"u"?null:window},B$=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let s=null,o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(s=n.getAttribute(o));let r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}},bE=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function CE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:P$(),t=fe=>CE(fe);if(t.version="3.2.4",t.removed=[],!e||!e.document||e.document.nodeType!==Fa.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e,s=n,o=s.currentScript,{DocumentFragment:r,HTMLTemplateElement:a,Node:i,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:f,DOMParser:d,trustedTypes:g}=e,h=l.prototype,p=Ia(h,"cloneNode"),b=Ia(h,"remove"),y=Ia(h,"nextSibling"),v=Ia(h,"childNodes"),E=Ia(h,"parentNode");if(typeof a=="function"){let fe=n.createElement("template");fe.content&&fe.content.ownerDocument&&(n=fe.content.ownerDocument)}let w,T="",{implementation:B,createNodeIterator:H,createDocumentFragment:x,getElementsByTagName:_}=n,{importNode:P}=s,z=bE();t.isSupported=typeof rE=="function"&&typeof E=="function"&&B&&B.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:X,ERB_EXPR:re,TMPLIT_EXPR:ie,DATA_ATTR:pe,ARIA_ATTR:Ee,IS_SCRIPT_OR_DATA:Ue,ATTR_WHITESPACE:We,CUSTOM_ELEMENT:Ye}=hE,{IS_ALLOWED_URI:M}=hE,Y=null,ge=Ae({},[...uE,...wd,...kd,..._d,...fE]),he=null,R=Ae({},[...dE,...Ad,...mE,..._l]),O=Object.seal(iE(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,le=null,ue=!0,ve=!0,rn=!1,Yn=!0,wt=!1,mn=!0,Kt=!1,bt=!1,kt=!1,an=!1,$s=!1,J=!1,de=!0,$e=!1,Ve="user-content-",Xe=!0,ze=!1,De={},Pe=null,_t=Ae({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),gn=null,Xn=Ae({},["audio","video","img","source","image","track"]),xn=null,Cr=Ae({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),yr="http://www.w3.org/1998/Math/MathML",ko="http://www.w3.org/2000/svg",pn="http://www.w3.org/1999/xhtml",Ms=pn,ni=!1,vr=null,z_=Ae({},[yr,ko,pn],Sd),si=Ae({},["mi","mo","mn","ms","mtext"]),oi=Ae({},["annotation-xml"]),H_=Ae({},["title","style","font","a","script"]),Er=null,Us=["application/xhtml+xml","text/html"],Sc="text/html",S=null,k=null,$=n.createElement("form"),I=function(A){return A instanceof RegExp||A instanceof Function},te=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(k&&k===A)){if((!A||typeof A!="object")&&(A={}),A=bo(A),Er=Us.indexOf(A.PARSER_MEDIA_TYPE)===-1?Sc:A.PARSER_MEDIA_TYPE,S=Er==="application/xhtml+xml"?Sd:kl,Y=_n(A,"ALLOWED_TAGS")?Ae({},A.ALLOWED_TAGS,S):ge,he=_n(A,"ALLOWED_ATTR")?Ae({},A.ALLOWED_ATTR,S):R,vr=_n(A,"ALLOWED_NAMESPACES")?Ae({},A.ALLOWED_NAMESPACES,Sd):z_,xn=_n(A,"ADD_URI_SAFE_ATTR")?Ae(bo(Cr),A.ADD_URI_SAFE_ATTR,S):Cr,gn=_n(A,"ADD_DATA_URI_TAGS")?Ae(bo(Xn),A.ADD_DATA_URI_TAGS,S):Xn,Pe=_n(A,"FORBID_CONTENTS")?Ae({},A.FORBID_CONTENTS,S):_t,K=_n(A,"FORBID_TAGS")?Ae({},A.FORBID_TAGS,S):{},le=_n(A,"FORBID_ATTR")?Ae({},A.FORBID_ATTR,S):{},De=_n(A,"USE_PROFILES")?A.USE_PROFILES:!1,ue=A.ALLOW_ARIA_ATTR!==!1,ve=A.ALLOW_DATA_ATTR!==!1,rn=A.ALLOW_UNKNOWN_PROTOCOLS||!1,Yn=A.ALLOW_SELF_CLOSE_IN_ATTR!==!1,wt=A.SAFE_FOR_TEMPLATES||!1,mn=A.SAFE_FOR_XML!==!1,Kt=A.WHOLE_DOCUMENT||!1,an=A.RETURN_DOM||!1,$s=A.RETURN_DOM_FRAGMENT||!1,J=A.RETURN_TRUSTED_TYPE||!1,kt=A.FORCE_BODY||!1,de=A.SANITIZE_DOM!==!1,$e=A.SANITIZE_NAMED_PROPS||!1,Xe=A.KEEP_CONTENT!==!1,ze=A.IN_PLACE||!1,M=A.ALLOWED_URI_REGEXP||gE,Ms=A.NAMESPACE||pn,si=A.MATHML_TEXT_INTEGRATION_POINTS||si,oi=A.HTML_INTEGRATION_POINTS||oi,O=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&I(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(O.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&I(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(O.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(O.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),wt&&(ve=!1),$s&&(an=!0),De&&(Y=Ae({},fE),he=[],De.html===!0&&(Ae(Y,uE),Ae(he,dE)),De.svg===!0&&(Ae(Y,wd),Ae(he,Ad),Ae(he,_l)),De.svgFilters===!0&&(Ae(Y,kd),Ae(he,Ad),Ae(he,_l)),De.mathMl===!0&&(Ae(Y,_d),Ae(he,mE),Ae(he,_l))),A.ADD_TAGS&&(Y===ge&&(Y=bo(Y)),Ae(Y,A.ADD_TAGS,S)),A.ADD_ATTR&&(he===R&&(he=bo(he)),Ae(he,A.ADD_ATTR,S)),A.ADD_URI_SAFE_ATTR&&Ae(xn,A.ADD_URI_SAFE_ATTR,S),A.FORBID_CONTENTS&&(Pe===_t&&(Pe=bo(Pe)),Ae(Pe,A.FORBID_CONTENTS,S)),Xe&&(Y["#text"]=!0),Kt&&Ae(Y,["html","head","body"]),Y.table&&(Ae(Y,["tbody"]),delete K.tbody),A.TRUSTED_TYPES_POLICY){if(typeof A.TRUSTED_TYPES_POLICY.createHTML!="function")throw Oa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof A.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Oa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=A.TRUSTED_TYPES_POLICY,T=w.createHTML("")}else w===void 0&&(w=B$(g,o)),w!==null&&typeof T=="string"&&(T=w.createHTML(""));It&&It(A),k=A}},me=Ae({},[...wd,...kd,...S$]),Me=Ae({},[..._d,...w$]),Nn=function(A){let Z=E(A);(!Z||!Z.tagName)&&(Z={namespaceURI:Ms,tagName:"template"});let ae=kl(A.tagName),je=kl(Z.tagName);return vr[A.namespaceURI]?A.namespaceURI===ko?Z.namespaceURI===pn?ae==="svg":Z.namespaceURI===yr?ae==="svg"&&(je==="annotation-xml"||si[je]):!!me[ae]:A.namespaceURI===yr?Z.namespaceURI===pn?ae==="math":Z.namespaceURI===ko?ae==="math"&&oi[je]:!!Me[ae]:A.namespaceURI===pn?Z.namespaceURI===ko&&!oi[je]||Z.namespaceURI===yr&&!si[je]?!1:!Me[ae]&&(H_[ae]||!me[ae]):!!(Er==="application/xhtml+xml"&&vr[A.namespaceURI]):!1},hn=function(A){Pa(t.removed,{element:A});try{E(A).removeChild(A)}catch{b(A)}},ri=function(A,Z){try{Pa(t.removed,{attribute:Z.getAttributeNode(A),from:Z})}catch{Pa(t.removed,{attribute:null,from:Z})}if(Z.removeAttribute(A),A==="is")if(an||$s)try{hn(Z)}catch{}else try{Z.setAttribute(A,"")}catch{}},W_=function(A){let Z=null,ae=null;if(kt)A="<remove></remove>"+A;else{let Ct=cE(A,/^[\r\n\t ]+/);ae=Ct&&Ct[0]}Er==="application/xhtml+xml"&&Ms===pn&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");let je=w?w.createHTML(A):A;if(Ms===pn)try{Z=new d().parseFromString(je,Er)}catch{}if(!Z||!Z.documentElement){Z=B.createDocument(Ms,"template",null);try{Z.documentElement.innerHTML=ni?T:je}catch{}}let Dt=Z.body||Z.documentElement;return A&&ae&&Dt.insertBefore(n.createTextNode(ae),Dt.childNodes[0]||null),Ms===pn?_.call(Z,Kt?"html":"body")[0]:Kt?Z.documentElement:Dt},V_=function(A){return H.call(A.ownerDocument||A,A,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},tg=function(A){return A instanceof f&&(typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof u)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"||typeof A.hasChildNodes!="function")},j_=function(A){return typeof i=="function"&&A instanceof i};function gs(fe,A,Z){wl(fe,ae=>{ae.call(t,A,Z,k)})}let q_=function(A){let Z=null;if(gs(z.beforeSanitizeElements,A,null),tg(A))return hn(A),!0;let ae=S(A.nodeName);if(gs(z.uponSanitizeElement,A,{tagName:ae,allowedTags:Y}),A.hasChildNodes()&&!j_(A.firstElementChild)&&Ft(/<[/\w]/g,A.innerHTML)&&Ft(/<[/\w]/g,A.textContent)||A.nodeType===Fa.progressingInstruction||mn&&A.nodeType===Fa.comment&&Ft(/<[/\w]/g,A.data))return hn(A),!0;if(!Y[ae]||K[ae]){if(!K[ae]&&G_(ae)&&(O.tagNameCheck instanceof RegExp&&Ft(O.tagNameCheck,ae)||O.tagNameCheck instanceof Function&&O.tagNameCheck(ae)))return!1;if(Xe&&!Pe[ae]){let je=E(A)||A.parentNode,Dt=v(A)||A.childNodes;if(Dt&&je){let Ct=Dt.length;for(let Gt=Ct-1;Gt>=0;--Gt){let Zn=p(Dt[Gt],!0);Zn.__removalCount=(A.__removalCount||0)+1,je.insertBefore(Zn,y(A))}}}return hn(A),!0}return A instanceof l&&!Nn(A)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&Ft(/<\/no(script|embed|frames)/i,A.innerHTML)?(hn(A),!0):(wt&&A.nodeType===Fa.text&&(Z=A.textContent,wl([X,re,ie],je=>{Z=Ba(Z,je," ")}),A.textContent!==Z&&(Pa(t.removed,{element:A.cloneNode()}),A.textContent=Z)),gs(z.afterSanitizeElements,A,null),!1)},K_=function(A,Z,ae){if(de&&(Z==="id"||Z==="name")&&(ae in n||ae in $))return!1;if(!(ve&&!le[Z]&&Ft(pe,Z))){if(!(ue&&Ft(Ee,Z))){if(!he[Z]||le[Z]){if(!(G_(A)&&(O.tagNameCheck instanceof RegExp&&Ft(O.tagNameCheck,A)||O.tagNameCheck instanceof Function&&O.tagNameCheck(A))&&(O.attributeNameCheck instanceof RegExp&&Ft(O.attributeNameCheck,Z)||O.attributeNameCheck instanceof Function&&O.attributeNameCheck(Z))||Z==="is"&&O.allowCustomizedBuiltInElements&&(O.tagNameCheck instanceof RegExp&&Ft(O.tagNameCheck,ae)||O.tagNameCheck instanceof Function&&O.tagNameCheck(ae))))return!1}else if(!xn[Z]){if(!Ft(M,Ba(ae,We,""))){if(!((Z==="src"||Z==="xlink:href"||Z==="href")&&A!=="script"&&C$(ae,"data:")===0&&gn[A])){if(!(rn&&!Ft(Ue,Ba(ae,We,"")))){if(ae)return!1}}}}}}return!0},G_=function(A){return A!=="annotation-xml"&&cE(A,Ye)},Y_=function(A){gs(z.beforeSanitizeAttributes,A,null);let{attributes:Z}=A;if(!Z||tg(A))return;let ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:he,forceKeepAttr:void 0},je=Z.length;for(;je--;){let Dt=Z[je],{name:Ct,namespaceURI:Gt,value:Zn}=Dt,ai=S(Ct),At=Ct==="value"?Zn:y$(Zn),U5=At;if(ae.attrName=ai,ae.attrValue=At,ae.keepAttr=!0,ae.forceKeepAttr=void 0,gs(z.uponSanitizeAttribute,A,ae),At=ae.attrValue,$e&&(ai==="id"||ai==="name")&&(ri(Ct,A),At=Ve+At),mn&&Ft(/((--!?|])>)|<\/(style|title)/i,At)){ri(Ct,A);continue}if(ae.forceKeepAttr)continue;if(!ae.keepAttr){ri(Ct,A);continue}if(!Yn&&Ft(/\/>/i,At)){ri(Ct,A);continue}wt&&wl([X,re,ie],Z_=>{At=Ba(At,Z_," ")});let X_=S(A.nodeName);if(!K_(X_,ai,At)){ri(Ct,A);continue}if(w&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Gt)switch(g.getAttributeType(X_,ai)){case"TrustedHTML":{At=w.createHTML(At);break}case"TrustedScriptURL":{At=w.createScriptURL(At);break}}if(At!==U5)try{Gt?A.setAttributeNS(Gt,Ct,At):A.setAttribute(Ct,At),tg(A)?hn(A):lE(t.removed)}catch{}}gs(z.afterSanitizeAttributes,A,null)},M5=function fe(A){let Z=null,ae=V_(A);for(gs(z.beforeSanitizeShadowDOM,A,null);Z=ae.nextNode();)gs(z.uponSanitizeShadowNode,Z,null),q_(Z),Y_(Z),Z.content instanceof r&&fe(Z.content);gs(z.afterSanitizeShadowDOM,A,null)};return t.sanitize=function(fe){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Z=null,ae=null,je=null,Dt=null;if(ni=!fe,ni&&(fe="<!-->"),typeof fe!="string"&&!j_(fe))if(typeof fe.toString=="function"){if(fe=fe.toString(),typeof fe!="string")throw Oa("dirty is not a string, aborting")}else throw Oa("toString is not a function");if(!t.isSupported)return fe;if(bt||te(A),t.removed=[],typeof fe=="string"&&(ze=!1),ze){if(fe.nodeName){let Zn=S(fe.nodeName);if(!Y[Zn]||K[Zn])throw Oa("root node is forbidden and cannot be sanitized in-place")}}else if(fe instanceof i)Z=W_("<!---->"),ae=Z.ownerDocument.importNode(fe,!0),ae.nodeType===Fa.element&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?Z=ae:Z.appendChild(ae);else{if(!an&&!wt&&!Kt&&fe.indexOf("<")===-1)return w&&J?w.createHTML(fe):fe;if(Z=W_(fe),!Z)return an?null:J?T:""}Z&&kt&&hn(Z.firstChild);let Ct=V_(ze?fe:Z);for(;je=Ct.nextNode();)q_(je),Y_(je),je.content instanceof r&&M5(je.content);if(ze)return fe;if(an){if($s)for(Dt=x.call(Z.ownerDocument);Z.firstChild;)Dt.appendChild(Z.firstChild);else Dt=Z;return(he.shadowroot||he.shadowrootmode)&&(Dt=P.call(s,Dt,!0)),Dt}let Gt=Kt?Z.outerHTML:Z.innerHTML;return Kt&&Y["!doctype"]&&Z.ownerDocument&&Z.ownerDocument.doctype&&Z.ownerDocument.doctype.name&&Ft(pE,Z.ownerDocument.doctype.name)&&(Gt="<!DOCTYPE "+Z.ownerDocument.doctype.name+`>
`+Gt),wt&&wl([X,re,ie],Zn=>{Gt=Ba(Gt,Zn," ")}),w&&J?w.createHTML(Gt):Gt},t.setConfig=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};te(fe),bt=!0},t.clearConfig=function(){k=null,bt=!1},t.isValidAttribute=function(fe,A,Z){k||te({});let ae=S(fe),je=S(A);return K_(ae,je,Z)},t.addHook=function(fe,A){typeof A=="function"&&Pa(z[fe],A)},t.removeHook=function(fe,A){if(A!==void 0){let Z=h$(z[fe],A);return Z===-1?void 0:b$(z[fe],Z,1)[0]}return lE(z[fe])},t.removeHooks=function(fe){z[fe]=[]},t.removeAllHooks=function(){z=bE()},t}var xd=CE();let yE=L.each,O$=L.trim,I$=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],F$={ftp:21,http:80,https:443,mailto:25},L$=["img","video"],$$=(e,t)=>U(e)?!e:U(t)?!ke(L$,t):!0,M$=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},vE=(e,t,n)=>{let s=M$(t).replace(/\s/g,"");return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?$$(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class dn{static parseDataUri(t){let n,s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{let o=Qs.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!vE(s,o,n)}}static getDocumentBaseUrl(t){var n;let s;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?s=(n=t.href)!==null&&n!==void 0?n:"":s=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/")),s}constructor(t,n={}){this.path="",this.directory="",t=O$(t),this.settings=n;let s=n.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}let r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){let i=s?s.path:new dn(document.location.href).directory;if(s?.protocol==="")t="//mce_host"+o.toAbsPath(i,t);else{let l=/([^#?]*)([#?]?.*)/.exec(t);l&&(t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2])}}t=t.replace(/@@/g,"(mce_at)");let a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&yE(I$,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),o[i]=c}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}setPath(t){let n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;let n=new dn(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();let s=this.getURI(),o=n.getURI();if(s===o||s.charAt(s.length-1)==="/"&&s.substr(0,s.length-1)===o)return s;let r=this.toRelPath(this.path,n.path);return n.query&&(r+="?"+n.query),n.anchor&&(r+="#"+n.anchor),r}toAbsolute(t,n){let s=new dn(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;let n=this.protocol?F$[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a,i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(r=0,a=i.length;r<a;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}}if(i.length<l.length){for(r=0,a=l.length;r<a;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=l.length;r<a;r++)r!==s-1?o+="/"+l[r]:o+=l[r];return o}toAbsPath(t,n){let s=0,o=/\/$/.test(n)?"/":"",r=t.split("/"),a=n.split("/"),i=[];yE(r,f=>{f&&i.push(f)});let l=[];for(let f=a.length-1;f>=0;f--)if(!(a[f].length===0||a[f]===".")){if(a[f]===".."){s++;continue}if(s>0){s--;continue}l.push(a[f])}let c=i.length-s,u;return c<=0?u=xr(l).join("/"):u=i.slice(0,c).join("/")+"/"+xr(l).join("/"),u.indexOf("/")!==0&&(u="/"+u),o&&u.lastIndexOf("/")!==u.length-1&&(u+=o),u}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}let U$=L.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),Nd="data-mce-type",EE=0,SE=(e,t,n,s,o)=>{var r,a,i,l;let c=t.validate,u=n.getSpecialElements();e.nodeType===bi&&!t.allow_conditional_comments&&/^\[if/i.test((r=e.nodeValue)!==null&&r!==void 0?r:"")&&(e.nodeValue=" "+e.nodeValue);let f=(a=o?.tagName)!==null&&a!==void 0?a:e.nodeName.toLowerCase();if(s!=="html"&&n.isValid(s)){U(o)&&(o.allowedTags[f]=!0);return}if(e.nodeType!==Lr||f==="body")return;let d=C.fromDom(e),g=Wr(d,Nd),h=Wt(d,"data-mce-bogus");if(!g&&ee(h)){h==="all"?Te(d):ys(d);return}let p=n.getElementRule(f);if(c&&!p){oe(u,f)?Te(d):ys(d);return}else U(o)&&(o.allowedTags[f]=!0);if(c&&p&&!g){if(D((i=p.attributesForced)!==null&&i!==void 0?i:[],b=>{at(d,b.name,b.value==="{$uid}"?`mce_${EE++}`:b.value)}),D((l=p.attributesDefault)!==null&&l!==void 0?l:[],b=>{Wr(d,b.name)||at(d,b.name,b.value==="{$uid}"?`mce_${EE++}`:b.value)}),p.attributesRequired&&!Ie(p.attributesRequired,b=>Wr(d,b))){ys(d);return}if(p.removeEmptyAttrs&&Bx(d)){ys(d);return}p.outputName&&p.outputName!==f&&Ix(d,p.outputName)}},z$=(e,t,n,s,o)=>{let r=e.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=wE(t,n,s,r,a,i),o.keepAttr?(o.allowedAttributes[a]=!0,_E(a,n)&&(o.attrValue=a),t.allow_svg_data_urls&&Qe(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):kE(e,a)&&(o.forceKeepAttr=!0)},wE=(e,t,n,s,o,r)=>n!=="html"&&!Ys(s)?!0:!(o in U$&&vE(e,r,s))&&(!e.validate||t.isValid(s,o)||Qe(o,"data-")||Qe(o,"aria-")),kE=(e,t)=>e.hasAttribute(Nd)&&(t==="id"||t==="class"||t==="style"),_E=(e,t)=>e in t.getBoolAttrs(),H$=(e,t,n,s)=>{let{attributes:o}=e;for(let r=o.length-1;r>=0;r--){let a=o[r],i=a.name,l=a.value;!wE(t,n,s,e.tagName.toLowerCase(),i,l)&&!kE(e,i)?e.removeAttribute(i):_E(i,n)&&e.setAttribute(i,i)}},W$=(e,t,n)=>{let s=xd();return s.addHook("uponSanitizeElement",(o,r)=>{SE(o,e,t,n.track(o),r)}),s.addHook("uponSanitizeAttribute",(o,r)=>{z$(o,e,t,n.current(),r)}),s},V$=(e,t)=>{let s=Q({},{IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[],SAFE_FOR_XML:!1});return s.PARSER_MEDIA_TYPE=t,e.allow_script_urls?s.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(s.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),s},j$=e=>{let t=["type","href","role","arcrole","title","show","actuate","label","from","to"].map(s=>`xlink:${s}`),n={IN_PLACE:!0,USE_PROFILES:{html:!0,svg:!0,svgFilters:!0},ALLOWED_ATTR:t};xd().sanitize(e,n)},q$=(e,t)=>{let n={IN_PLACE:!0,USE_PROFILES:{mathMl:!0}},s=xd(),o=t.allow_mathml_annotation_encodings,r=Be(o)&&o.length>0,a=l=>{let c=l.getAttribute("encoding");return r&&ee(c)&&ke(o,c)},i=(l,c)=>r&&c==="semantics"?m.some(!0):c==="annotation"?m.some(q(l)&&a(l)):Be(t.extended_mathml_elements)&&t.extended_mathml_elements.includes(c)?m.from(!0):m.none();s.addHook("uponSanitizeElement",(l,c)=>{var u;let f=(u=c.tagName)!==null&&u!==void 0?u:l.nodeName.toLowerCase();i(l,f).each(g=>{c.allowedTags[f]=g,!g&&t.sanitize&&q(l)&&l.remove()})}),s.addHook("uponSanitizeAttribute",(l,c)=>{Be(t.extended_mathml_attributes)&&t.extended_mathml_attributes.includes(c.attrName)&&(c.forceKeepAttr=!0)}),s.sanitize(e,n)},K$=e=>t=>{let n=Gp(t);if(n==="svg")j$(t);else if(n==="math")q$(t,e);else throw new Error("Not a namespace element")},G$=(e,t)=>{let n=JN();if(e.sanitize){let s=W$(e,t,n);return{sanitizeHtmlElement:(r,a)=>{s.sanitize(r,V$(e,a)),s.removed=[],n.reset()},sanitizeNamespaceElement:K$(e)}}else return{sanitizeHtmlElement:(r,a)=>{let i=document.createNodeIterator(r,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT),l;for(;l=i.nextNode();){let c=n.track(l);SE(l,e,t,c),q(l)&&H$(l,e,t,c)}n.reset()},sanitizeNamespaceElement:ce}},AE=L.makeMap,xE=L.extend,NE=(e,t,n,s)=>{let o=e.name,r=o in n&&o!=="title"&&o!=="textarea"&&o!=="noscript",a=t.childNodes;for(let i=0,l=a.length;i<l;i++){let c=a[i],u=new Et(c.nodeName.toLowerCase(),c.nodeType);if(q(c)){let f=c.attributes;for(let d=0,g=f.length;d<g;d++){let h=f[d];u.attr(h.name,h.value)}Ys(u.name)&&(s(c),u.value=c.innerHTML)}else F(c)?(u.value=c.data,r&&(u.raw=!0)):(Ss(c)||MN(c)||UN(c))&&(u.value=c.data);Ys(u.name)||NE(u,c,n,s),e.append(u)}},Y$=(e,t,n)=>{let s=[];for(let o=e,r=o;o;r=o,o=o.walk()){let a=o;D(t,i=>i(a)),qe(a.parent)&&a!==e?o=r:s.push(a)}for(let o=s.length-1;o>=0;o--){let r=s[o];D(n,a=>a(r))}},X$=(e,t,n,s)=>{let o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=xE(AE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=gh(t),c=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,f=/[ \t\r\n]+$/,d=v=>{let E=v.parent;for(;U(E);){if(E.name in a)return!0;E=E.parent}return!1},g=v=>{let E=v;for(;U(E);){if(E.name in l)return Na(t,r,a,E);E=E.parent}return!1},h=v=>v.name in i||Cu(t,v)||Ys(v.name)&&v.parent===e,p=(v,E)=>{let w=E?v.prev:v.next;return U(w)||qe(v.parent)?!1:h(v.parent)&&(v.parent!==e||s.isRootContent===!0)};return[v=>{var E;if(v.type===3&&!d(v)){let w=(E=v.value)!==null&&E!==void 0?E:"";w=w.replace(c," "),(dF(v.prev,h)||p(v,!0))&&(w=w.replace(u,"")),w.length===0||w===" "&&v.prev&&v.prev.type===bi&&v.next&&v.next.type===bi?v.remove():v.value=w}},v=>{var E;if(v.type===1){let w=t.getElementRule(v.name);if(o&&w){let T=Na(t,r,a,v);w.paddInEmptyBlock&&T&&g(v)?Jf(n,s,h,v):w.removeEmpty&&T?h(v)?v.remove():v.unwrap():w.paddEmpty&&(T||uF(v))&&Jf(n,s,h,v)}}else if(v.type===3&&!d(v)){let w=(E=v.value)!==null&&E!==void 0?E:"";(v.next&&h(v.next)||p(v,!1))&&(w=w.replace(f,"")),w.length===0?v.remove():v.value=w}}]},Z$=(e,t)=>{var n;let s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},rr=(e={},t=ws())=>{let n=Qv(),s=Qv(),o=Q({validate:!0,root_name:"body",sanitize:!0},e),r=new DOMParser,a=G$(o,t),i=(E,w,T="html")=>{let B=T==="xhtml"?"application/xhtml+xml":"text/html",H=oe(t.getSpecialElements(),w.toLowerCase()),x=H?`<${w}>${E}</${w}>`:E,_=()=>T==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${x}</body></html>`:/^[\s]*<head/i.test(E)||/^[\s]*<html/i.test(E)||/^[\s]*<!DOCTYPE/i.test(E)?`<html>${x}</html>`:`<body>${x}</body>`,P=r.parseFromString(_(),B).body;return a.sanitizeHtmlElement(P,B),H?P.firstChild:P},l=n.addFilter,c=n.getFilters,u=n.removeFilter,f=s.addFilter,d=s.getFilters,g=s.removeFilter,h=(E,w)=>{nd(t,E)&&w.push(E)},p=(E,w)=>{let T=ee(w.attr(Nd)),B=w.type===1&&!oe(E,w.name)&&!Cu(t,w)&&!Ys(w.name);return w.type===3||B&&!T},b=(E,w)=>{let T=xE(AE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),B=/^[ \t\r\n]+/,H=/[ \t\r\n]+$/,x=E.firstChild,_=null,P=z=>{var X,re;z&&(x=z.firstChild,x&&x.type===3&&(x.value=(X=x.value)===null||X===void 0?void 0:X.replace(B,"")),x=z.lastChild,x&&x.type===3&&(x.value=(re=x.value)===null||re===void 0?void 0:re.replace(H,"")))};if(t.isValidChild(E.name,w.toLowerCase())){for(;x;){let z=x.next;p(T,x)?(_||(_=new Et(w,1),_.attr(o.forced_root_block_attrs),E.insert(_,x)),_.append(x)):(P(_),_=null),x=z}P(_)}},v={schema:t,addAttributeFilter:f,getAttributeFilters:d,removeAttributeFilter:g,addNodeFilter:l,getNodeFilters:c,removeNodeFilter:u,parse:(E,w={})=>{var T;let B=o.validate,H=(T=w.context)!==null&&T!==void 0?T:o.root_name,x=i(E,H,w.format);gu(t,x);let _=new Et(H,11);NE(_,x,t.getSpecialElements(),a.sanitizeNamespaceElement),x.innerHTML="";let[P,z]=X$(_,t,o,w),X=[],re=B?Ue=>h(Ue,X):ce,ie={nodes:{},attributes:{}},pe=Ue=>rv(c(),d(),Ue,ie);if(Y$(_,[P,pe],[z,re]),X.reverse(),B&&X.length>0)if(w.context){let{pass:Ue,fail:We}=_o(X,Ye=>Ye.parent===_);td(We,t,_,pe),w.invalid=Ue.length>0}else td(X,t,_,pe);let Ee=Z$(o,w);return Ee&&(_.name==="body"||w.isRootContent)&&b(_,Ee),w.invalid||av(ie,w),_}};return d$(v,o),XL(v,o,t),v},Q$=e=>yl(e)?Ts({validate:!1}).serialize(e):e,RE=(e,t,n)=>{let s=Q$(e),o=t(s);if(o.isDefaultPrevented())return o;if(yl(e))if(o.content!==s){let r=rr(Q({validate:!1,forced_root_block:!1},n)).parse(o.content,{context:e.name});return we(Q({},o),{content:r})}else return we(Q({},o),{content:e});else return o},TE=e=>({sanitize:Pb(e),sandbox_iframes:Ob(e),sandbox_iframes_exclusions:Zu(e)}),DE=(e,t)=>{if(t.no_events)return zt.value(t);{let n=wD(e,t);return n.isDefaultPrevented()?zt.error(mb(e,Q({content:""},n)).content):zt.value(n)}},PE=(e,t,n)=>n.no_events?t:RE(t,o=>mb(e,we(Q({},n),{content:o})),TE(e)).content,Rd=(e,t)=>{if(t.no_events)return zt.value(t);{let n=RE(t.content,s=>SD(e,we(Q({},t),{content:s})),TE(e));return n.isDefaultPrevented()?(db(e,n),zt.error(void 0)):zt.value(n)}},Td=(e,t,n)=>{n.no_events||db(e,we(Q({},n),{content:t}))},Dd=(e,t,n)=>({element:e,width:t,rows:n}),BE=(e,t)=>({element:e,cells:t}),J$=(e,t)=>({x:e,y:t}),OE=(e,t)=>ss(e,t).bind(mi).getOr(1),eM=(e,t,n,s,o)=>{let r=OE(o,"rowspan"),a=OE(o,"colspan"),i=e.rows;for(let l=n;l<n+r;l++){i[l]||(i[l]=BE(vp(s),[]));for(let c=t;c<t+a;c++){let u=i[l].cells;u[c]=l===n&&c===t?o:qs(o)}}},tM=(e,t,n)=>{let s=e.rows;return!!(s[n]?s[n].cells:[])[t]},nM=(e,t,n)=>{for(;tM(e,t,n);)t++;return t},IE=e=>Pt(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),FE=(e,t)=>{let n=e.rows;for(let s=0;s<n.length;s++){let o=n[s].cells;for(let r=0;r<o.length;r++)if(Se(o[r],t))return m.some(J$(r,s))}return m.none()},LE=(e,t,n,s,o)=>{let r=[],a=e.rows;for(let i=n;i<=o;i++){let l=a[i].cells,c=t<s?l.slice(t,s+1):l.slice(s,t+1);r.push(BE(a[i].element,c))}return r},sM=(e,t,n)=>{let s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?LE(e,s,o,r,a):LE(e,s,a,r,o);return Dd(e.element,IE(i),i)},oM=(e,t)=>{let n=qs(e.element),s=C.fromTag("tbody");return js(s,t),Ke(n,s),n},rM=e=>be(e.rows,t=>{let n=be(t.cells,o=>{let r=vp(o);return it(r,"colspan"),it(r,"rowspan"),r}),s=qs(t.element);return js(s,n),s}),aM=e=>{let t=Dd(qs(e),0,[]);return D(mt(e,"tr"),(n,s)=>{D(mt(n,"td,th"),(o,r)=>{eM(t,nM(t,r,s),s,n,o)})}),Dd(t.element,IE(t.rows),t.rows)},iM=e=>oM(e,rM(e)),lM=(e,t,n)=>FE(e,t).bind(s=>FE(e,n).map(o=>sM(e,s,o))),cM=e=>Ze(e,t=>Ce(t)==="ul"||Ce(t)==="ol"),uM=(e,t)=>Ze(e,n=>Ce(n)==="li"&&uf(n,t)).fold(W([]),n=>cM(e).map(s=>{let o=C.fromTag(Ce(s)),r=Rr(Yc(s),(a,i)=>Qe(i,"list-style"));return vi(o,r),[C.fromTag("li"),o]}).getOr([])),fM=(e,t)=>{let n=Pt(t,(s,o)=>(Ke(o,s),o),e);return t.length>0?Qc([n]):n},dM=e=>Wo(e)?Fn(e).filter(Pu).fold(W([]),t=>[e,t]):Pu(e)?[e]:[],mM=(e,t,n)=>{let s=C.fromDom(t.commonAncestorContainer),o=ls(s,e),r=se(o,l=>n.isWrapper(Ce(l))),a=uM(o,t),i=r.concat(a.length?a:dM(s));return be(i,qs)},$E=()=>Qc([]),gM=(e,t,n)=>fM(C.fromDom(t.cloneContents()),mM(e,t,n)),pM=(e,t)=>qr(t,"table",G(Se,e)),hM=(e,t)=>pM(e,t[0]).bind(n=>{let s=t[0],o=t[t.length-1],r=aM(n);return lM(r,s,o).map(a=>Qc([iM(a)]))}).getOrThunk($E),bM=(e,t,n)=>t.length>0&&t[0].collapsed?$E():gM(e,t[0],n),CM=(e,t,n)=>{let s=lC(t,e);return s.length>0?hM(e,s):bM(e,t,n)},Al=(e,t)=>t>=0&&t<e.length&&lo(e.charAt(t)),ME=e=>Vt(e.innerText),yM=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),vM=e=>m.from(e.selection.getRng()).map(t=>{var n;let s=m.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=yM(s),a=C.fromDom(t.cloneContents());iy(a),ly(a);let i=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},a.dom),l=ME(i),c=Vt((n=i.textContent)!==null&&n!==void 0?n:"");if(e.dom.remove(i),Al(c,0)||Al(c,c.length-1)){let u=s.getOr(o),f=ME(u),d=f.indexOf(l);if(d===-1)return l;{let g=Al(f,d-1),h=Al(f,d+l.length);return(g?" ":"")+l+(h?" ":"")}}else return l}).getOr(""),EM=(e,t)=>{let n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=Pf(e,lf(o)),a=t.contextual?CM(C.fromDom(e.getBody()),r,e.schema).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},SM=(e,t)=>{if(t.format==="text")return vM(e);{let n=EM(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},wM=(e,t)=>we(Q({},e),{format:t,get:!0,selection:!0,getInner:!0}),kM=(e,t,n={})=>{let s=wM(n,t);return DE(e,s).fold($t,o=>{let r=SM(e,o);return PE(e,r,o)})},Pd=0,UE=1,zE=2,_M=(e,t)=>{let n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(u,f,d)=>({start:u,end:f,diag:d}),a=(u,f,d,g,h)=>{let p=l(u,f,d,g);if(p===null||p.start===f&&p.diag===f-g||p.end===u&&p.diag===u-d){let b=u,y=d;for(;b<f||y<g;)b<f&&y<g&&e[b]===t[y]?(h.push([Pd,e[b]]),++b,++y):f-u>g-d?(h.push([zE,e[b]]),++b):(h.push([UE,t[y]]),++y)}else{a(u,p.start,d,p.start-p.diag,h);for(let b=p.start;b<p.end;++b)h.push([Pd,e[b]]);a(p.end,f,p.end-p.diag,g,h)}},i=(u,f,d,g)=>{let h=u;for(;h-f<g&&h<d&&e[h]===t[h-f];)++h;return r(u,h,f)},l=(u,f,d,g)=>{let h=f-u,p=g-d;if(h===0||p===0)return null;let b=h-p,y=p+h,v=(y%2===0?y:y+1)/2;s[1+v]=u,o[1+v]=f+1;let E,w,T,B,H;for(E=0;E<=v;++E){for(w=-E;w<=E;w+=2){for(T=w+v,w===-E||w!==E&&s[T-1]<s[T+1]?s[T]=s[T+1]:s[T]=s[T-1]+1,B=s[T],H=B-u+d-w;B<f&&H<g&&e[B]===t[H];)s[T]=++B,++H;if(b%2!==0&&b-E<=w&&w<=b+E&&o[T-b]<=s[T])return i(o[T-b],w+u-d,f,g)}for(w=b-E;w<=b+E;w+=2){for(T=w+v-b,w===b-E||w!==b+E&&o[T+1]<=o[T-1]?o[T]=o[T+1]-1:o[T]=o[T-1],B=o[T]-1,H=B-u+d-w;B>=u&&H>=d&&e[B]===t[H];)o[T]=B--,H--;if(b%2===0&&-E<=w&&w<=E&&o[T]<=s[T+b])return i(o[T],w+u-d,f,g)}}return null},c=[];return a(0,e.length,0,t.length,c),c},Bd=e=>q(e)?e.outerHTML:F(e)?Qs.encodeRaw(e.data,!1):Ss(e)?"<!--"+e.data+"-->":"",AM=e=>{let t,n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},xM=(e,t,n)=>{let s=AM(t);if(e.hasChildNodes()&&n<e.childNodes.length){let o=e.childNodes[n];e.insertBefore(s,o)}else e.appendChild(s)},NM=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){let n=e.childNodes[t];e.removeChild(n)}},RM=(e,t)=>{let n=0;D(e,s=>{s[0]===Pd?n++:s[0]===UE?(xM(t,s[1],n),n++):s[0]===zE&&NM(t,n)})},TM=(e,t)=>se(be(Mt(e.childNodes),t?Tn(Vt,Bd):Bd),n=>n.length>0),DM=(e,t)=>{let n=be(Mt(t.childNodes),Bd);return RM(_M(n,e),t),t},PM=Bn(()=>document.implementation.createHTMLDocument("undo")),BM=e=>e.querySelector("iframe")!==null,OM=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),IM=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),xl=e=>{let t=e.serializer.getTempAttrs(),n=ay(e.getBody(),t);return BM(n)?OM(TM(n,!0)):IM(Vt(n.innerHTML))},Od=(e,t,n)=>{let s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?DM(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:U(s)&&sC(s)?!s.isFakeCaret:!0}),s&&(e.selection.moveToBookmark(s),e.selection.scrollIntoView())},Id=e=>e.type==="fragmented"?e.fragments.join(""):e.content,HE=e=>{let t=C.fromTag("body",PM());return yi(t,Id(e)),D(mt(t,"*[data-mce-bogus]"),ys),Ep(t)},FM=(e,t)=>Id(e)===Id(t),LM=(e,t)=>HE(e)===HE(t),Fd=(e,t)=>!e||!t?!1:FM(e,t)?!0:LM(e,t),Ld=e=>e.get()===0,Nl=(e,t,n)=>{Ld(n)&&(e.typing=t)},WE=(e,t)=>{e.typing&&(Nl(e,!1,t),e.add())},$M=e=>{e.typing&&(e.typing=!1,e.add())},MM=(e,t,n)=>{Ld(t)&&n.set(Vu(e.selection))},UM=(e,t,n,s,o,r,a)=>{let i=xl(e),l=L.extend(r||{},i);if(!Ld(s)||e.removed)return null;let c=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:l,lastLevel:c,originalEvent:a}).isDefaultPrevented()||c&&Fd(c,l))return null;t.data[n.get()]&&o.get().each(d=>{t.data[n.get()].beforeBookmark=d});let u=CP(e);if(u&&t.data.length>u){for(let d=0;d<t.data.length-1;d++)t.data[d]=t.data[d+1];t.data.length--,n.set(t.data.length)}l.bookmark=Vu(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(l),n.set(t.data.length-1);let f={level:l,lastLevel:c,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",f),e.dispatch("change",f)):e.dispatch("AddUndo",f),l},zM=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},HM=(e,t,n,s,o)=>{if(t.transact(s)){let r=t.data[n.get()].bookmark,a=t.data[n.get()-1];Od(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},WM=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],Od(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},VM=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,Nl(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],Od(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},jM=e=>{e.clear(),e.add()},qM=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!Fd(xl(e),t.data[0]),KM=(e,t)=>t.get()<e.data.length-1&&!e.typing,GM=(e,t,n)=>(WE(e,t),e.beforeChange(),e.ignore(n),e.add()),YM=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},XM=(e,t)=>{let n=e.dom,s=U(t)?t:e.getBody();D(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":let r=kP(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){let i=n.getAttrib(o,"name")||o.id,l=Rb(e);i&&e.hasVisual?n.addClass(o,l):n.removeClass(o,l)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},VE=e=>({init:{bindEvents:ce},undoManager:{beforeChange:(t,n)=>MM(e,t,n),add:(t,n,s,o,r,a)=>UM(e,t,n,s,o,r,a),undo:(t,n,s)=>VM(e,t,n,s),redo:(t,n)=>WM(e,t,n),clear:(t,n)=>zM(e,t,n),reset:t=>jM(t),hasUndo:(t,n)=>qM(e,t,n),hasRedo:(t,n)=>KM(t,n),transact:(t,n,s)=>GM(t,n,s),ignore:(t,n)=>YM(t,n),extra:(t,n,s,o)=>HM(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>cd(e,t,n,s,o),matchAll:(t,n)=>oL(e,t,n),matchNode:(t,n,s,o)=>jn(e,t,n,s,o),canApply:t=>aL(e,t),closest:t=>rL(e,t),apply:(t,n,s)=>jv(e,t,n,s),remove:(t,n,s,o)=>Hv(e,t,n,s,o),toggle:(t,n,s)=>jL(e,t,n,s),formatChanged:(t,n,s,o,r)=>VL(e,t,n,s,o,r)},editor:{getContent:t=>TO(e,t),setContent:(t,n)=>sL(e,t,n),insertContent:(t,n)=>JF(e,t,n),addVisual:t=>XM(e,t)},selection:{getContent:(t,n)=>kM(e,t,n)},autocompleter:{addDecoration:ce,removeDecoration:ce},raw:{getModel:()=>m.none()}}),ZM=e=>{let t=c=>ot(c)?c:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(c,u,f)=>s.transact(f),ignore:(c,u)=>s.ignore(u),extra:(c,u,f,d)=>s.extra(f,d)},formatter:{match:(c,u,f,d)=>o.match(c,t(u),d),matchAll:o.matchAll,matchNode:o.matchNode,canApply:c=>o.canApply(c),closest:c=>o.closest(c),apply:(c,u,f)=>o.apply(c,t(u)),remove:(c,u,f,d)=>o.remove(c,t(u)),toggle:(c,u,f)=>o.toggle(c,t(u)),formatChanged:(c,u,f,d,g)=>o.formatChanged(u,f,d,g)},editor:{getContent:c=>r.getContent(c),setContent:(c,u)=>({content:r.setContent(c,u),html:""}),insertContent:(c,u)=>(r.insertContent(c),""),addVisual:r.addVisual},selection:{getContent:(c,u)=>a.getContent(u)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>m.some(l.getRawModel())}}},QM=()=>{let e=W(null),t=W("");return{init:{bindEvents:ce},undoManager:{beforeChange:ce,add:e,undo:e,redo:e,clear:ce,reset:ce,hasUndo:Oe,hasRedo:Oe,transact:e,ignore:ce,extra:ce},formatter:{match:Oe,matchAll:W([]),matchNode:W(void 0),canApply:Oe,closest:t,apply:ce,remove:ce,toggle:ce,formatChanged:W({unbind:ce})},editor:{getContent:t,setContent:W({content:"",html:""}),insertContent:W(""),addVisual:ce},selection:{getContent:t},autocompleter:{addDecoration:ce,removeDecoration:ce},raw:{getModel:W(m.none())}}},qn=e=>oe(e.plugins,"rtc"),JM=e=>Fe(e.plugins,"rtc").bind(t=>m.from(t.setup)),eU=e=>{let t=e;return JM(e).fold(()=>(t.rtcInstance=VE(e),m.none()),n=>(t.rtcInstance=QM(),m.some(()=>n().then(s=>(t.rtcInstance=ZM(s),s.rtc.isRemote)))))},$d=e=>e.rtcInstance?e.rtcInstance:VE(e),Ge=e=>{let t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},tU=(e,t,n)=>{Ge(e).undoManager.beforeChange(t,n)},nU=(e,t,n,s,o,r,a)=>Ge(e).undoManager.add(t,n,s,o,r,a),sU=(e,t,n,s)=>Ge(e).undoManager.undo(t,n,s),oU=(e,t,n)=>Ge(e).undoManager.redo(t,n),rU=(e,t,n)=>{Ge(e).undoManager.clear(t,n)},aU=(e,t)=>{Ge(e).undoManager.reset(t)},iU=(e,t,n)=>Ge(e).undoManager.hasUndo(t,n),lU=(e,t,n)=>Ge(e).undoManager.hasRedo(t,n),cU=(e,t,n,s)=>Ge(e).undoManager.transact(t,n,s),uU=(e,t,n)=>{Ge(e).undoManager.ignore(t,n)},fU=(e,t,n,s,o)=>{Ge(e).undoManager.extra(t,n,s,o)},dU=(e,t,n,s,o)=>Ge(e).formatter.match(t,n,s,o),mU=(e,t,n)=>Ge(e).formatter.matchAll(t,n),gU=(e,t,n,s,o)=>Ge(e).formatter.matchNode(t,n,s,o),pU=(e,t)=>Ge(e).formatter.canApply(t),hU=(e,t)=>Ge(e).formatter.closest(t),bU=(e,t,n,s)=>{Ge(e).formatter.apply(t,n,s)},CU=(e,t,n,s,o)=>{Ge(e).formatter.remove(t,n,s,o)},yU=(e,t,n,s)=>{Ge(e).formatter.toggle(t,n,s)},vU=(e,t,n,s,o,r)=>Ge(e).formatter.formatChanged(t,n,s,o,r),EU=(e,t)=>$d(e).editor.getContent(t),SU=(e,t,n)=>$d(e).editor.setContent(t,n),wU=(e,t,n)=>$d(e).editor.insertContent(t,n),kU=(e,t,n)=>Ge(e).selection.getContent(t,n),_U=(e,t)=>Ge(e).editor.addVisual(t),jE=e=>Ge(e).init.bindEvents(),AU=(e,t={})=>{let n=t.format?t.format:"html";return kU(e,n,t)},qE=e=>e.dom.length===0?(Te(e),m.none()):m.some(e),xU=(e,t)=>e.filter(n=>Ea.isBookmarkNode(n.dom)).bind(t?Hr:bs),NU=(e,t,n,s,o)=>{let r=e.dom,a=t.dom,i=s?r.length:a.length;s?(Hf(r,a,o,!1,!s),n.setStart(a,i)):(Hf(a,r,o,!1,!s),n.setEnd(a,i))},RU=(e,t,n)=>{Fn(e).each(s=>{let o=e.dom;t&&_a(s,N(o,0),n)?gl(o,0,n):!t&&Aa(s,N(o,o.length),n)&&zf(o,o.length,n)})},KE=(e,t,n,s,o)=>{e.bind(r=>((s?zf:gl)(r.dom,s?r.dom.length:0,o),t.filter(Nt).map(i=>NU(r,i,n,s,o)))).orThunk(()=>xU(t,s).or(t).filter(Nt).map(a=>RU(a,s,o)))},TU=(e,t,n)=>{let s=m.from(t.firstChild).map(C.fromDom),o=m.from(t.lastChild).map(C.fromDom);e.deleteContents(),e.insertNode(t);let r=s.bind(bs).filter(Nt).bind(qE),a=o.bind(Hr).filter(Nt).bind(qE);KE(r,s,e,!0,n),KE(a,o,e,!1,n),e.collapse(!1)},DU=(e,t)=>we(Q({format:"html"},e),{set:!0,selection:!0,content:t}),PU=(e,t)=>{if(t.format!=="raw"){let n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,Q(Q({forced_root_block:!1},o),t));return Ts({validate:!1},e.schema).serialize(r)}else return t.content},BU=(e,t,n={})=>{let s=DU(n,t);Rd(e,s).each(o=>{let r=PU(e,o),a=e.selection.getRng();TU(a,a.createContextualFragment(r),e.schema),e.selection.setRng(a),Sa(e,a),Td(e,r,o)})},GE=(e,t,n)=>{if(oe(e,t)){let s=se(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var OU=(e,t)=>{let n,s,o=(i,l)=>Ze(l,c=>e.is(c,i)),r=i=>e.getParents(i,void 0,e.getRoot()),a=()=>{n={},s={},t.on("NodeChange",i=>{let l=i.element,c=r(l),u={};Ne(n,(f,d)=>{o(d,c).each(g=>{s[d]||(D(f,h=>{h(!0,{node:g,selector:d,parents:c})}),s[d]=f),u[d]=f})}),Ne(s,(f,d)=>{u[d]||(delete s[d],D(f,g=>{g(!1,{node:l,selector:d,parents:c})}))})})};return{selectorChangedWithUnbind:(i,l)=>(n||a(),n[i]||(n[i]=[]),n[i].push(l),o(i,r(t.selection.getStart())).each(()=>{s[i]=n[i]}),{unbind:()=>{GE(n,i,l),GE(s,i,l)}})}};let YE=e=>!!(e&&e.ownerDocument)&&yn(C.fromDom(e.ownerDocument),C.fromDom(e)),IU=e=>e?YE(e.startContainer)&&YE(e.endContainer):!1,XE=(e,t,n,s)=>{let o,r,{selectorChangedWithUnbind:a}=OU(e,s),i=(M,Y)=>{let ge=e.createRng();U(M)&&U(Y)?(ge.setStart(M,Y),ge.setEnd(M,Y),w(ge),y(!1)):(ff(e,ge,s.getBody(),!0),w(ge))},l=M=>AU(s,M),c=(M,Y)=>BU(s,M,Y),u=M=>ZC(s.getBody(),E(),M),f=M=>QC(s.getBody(),E(),M),d=(M,Y)=>We.getBookmark(M,Y),g=M=>We.moveToBookmark(M),h=(M,Y)=>(hO(e,M,Y).each(w),M),p=()=>{let M=E(),Y=v();return!M||M.item?!1:M.compareEndPoints?M.compareEndPoints("StartToEnd",M)===0:!Y||M.collapsed},b=()=>{if(s.mode.isReadOnly())return!1;let M=E(),Y=s.getBody().querySelectorAll('[data-mce-selected="1"]');return Y.length>0?Qn(Y,ge=>e.isEditable(ge.parentElement)):YC(e,M)},y=M=>{let Y=E();Y.collapse(!!M),w(Y)},v=()=>t.getSelection?t.getSelection():t.document.selection,E=()=>{let M,Y=(he,R,O)=>{try{return R.compareBoundaryPoints(he,O)}catch{return-1}},ge=t.document;if(U(s.bookmark)&&!sr(s)){let he=Ef(s);if(he.isSome())return he.map(R=>Pf(s,[R])[0]).getOr(ge.createRange())}try{let he=v();he&&!xi(he.anchorNode)&&(he.rangeCount>0?M=he.getRangeAt(0):M=ge.createRange(),M=Pf(s,[M])[0])}catch{}if(M||(M=ge.createRange()),Yr(M.startContainer)&&M.collapsed){let he=e.getRoot();M.setStart(he,0),M.setEnd(he,0)}return o&&r&&(Y(M.START_TO_START,M,o)===0&&Y(M.END_TO_END,M,o)===0?M=r:(o=null,r=null)),M},w=(M,Y)=>{if(!IU(M))return;let ge=v();if(M=s.dispatch("SetSelectionRange",{range:M,forward:Y}).range,ge){r=M;try{ge.removeAllRanges(),ge.addRange(M)}catch{}Y===!1&&ge.extend&&(ge.collapse(M.endContainer,M.endOffset),ge.extend(M.startContainer,M.startOffset)),o=ge.rangeCount>0?ge.getRangeAt(0):null}if(!M.collapsed&&M.startContainer===M.endContainer&&ge?.setBaseAndExtent&&M.endOffset-M.startOffset<2&&M.startContainer.hasChildNodes()){let R=M.startContainer.childNodes[M.startOffset];R&&R.nodeName==="IMG"&&(ge.setBaseAndExtent(M.startContainer,M.startOffset,M.endContainer,M.endOffset),(ge.anchorNode!==M.startContainer||ge.focusNode!==M.endContainer)&&ge.setBaseAndExtent(R,0,R,1))}s.dispatch("AfterSetSelectionRange",{range:M,forward:Y})},T=M=>(c(e.getOuterHTML(M)),M),B=()=>gO(s.getBody(),E()),H=(M,Y)=>pO(e,E(),M,Y),x=()=>{let M=v(),Y=M?.anchorNode,ge=M?.focusNode;if(!M||!Y||!ge||xi(Y)||xi(ge))return!0;let he=e.createRng(),R=e.createRng();try{he.setStart(Y,M.anchorOffset),he.collapse(!0),R.setStart(ge,M.focusOffset),R.collapse(!0)}catch{return!0}return he.compareBoundaryPoints(he.START_TO_START,R)<=0},Ue={dom:e,win:t,serializer:n,editor:s,expand:(M={type:"word"})=>w(fo(e).expand(E(),M)),collapse:y,setCursorLocation:i,getContent:l,setContent:c,getBookmark:d,moveToBookmark:g,select:h,isCollapsed:p,isEditable:b,isForward:x,setNode:T,getNode:B,getSel:v,setRng:w,getRng:E,getStart:u,getEnd:f,getSelectedBlocks:H,normalize:()=>{let M=E(),Y=v();if(!qB(Y)&&el(s)){let ge=ll(e,M);return ge.each(he=>{w(he,x())}),ge.getOr(M)}return M},selectorChanged:(M,Y)=>(a(M,Y),Ue),selectorChangedWithUnbind:a,getScrollContainer:()=>{let M,Y=e.getRoot();for(;Y&&Y.nodeName!=="BODY";){if(Y.scrollHeight>Y.clientHeight){M=Y;break}Y=Y.parentNode}return M},scrollIntoView:(M,Y)=>{U(M)?mO(s,M,Y):Sa(s,E(),Y)},placeCaretAt:(M,Y)=>w($C(M,Y,s.getDoc())),getBoundingClientRect:()=>{let M=E();return M.collapsed?N.fromRangeStart(M).getClientRects()[0]:M.getBoundingClientRect()},destroy:()=>{t=o=r=null,Ye.destroy()}},We=Ea(Ue),Ye=LC(Ue,s);return Ue.bookmarkManager=We,Ue.controlSelection=Ye,Ue},FU=(e,t,n)=>{t.addNodeFilter("br",(s,o,r)=>{let a=L.extend({},n.getBlockElements()),i=n.getNonEmptyElements(),l=n.getWhitespaceElements();a.body=1;let c=u=>u.name in a||Cu(n,u);for(let u=0,f=s.length;u<f;u++){let d=s[u],g=d.parent;if(g&&c(g)&&d===g.lastChild){let h=d.prev;for(;h;){let p=h.name;if(p!=="span"||h.attr("data-mce-type")!=="bookmark"){p==="br"&&(d=null);break}h=h.prev}if(d&&(d.remove(),Na(n,i,l,g))){let p=n.getElementRule(g.name);p&&(p.removeEmpty?g.remove():p.paddEmpty&&Jf(e,r,c,g))}}else{let h=d;for(;g&&g.firstChild===h&&g.lastChild===h&&(h=g,!a[g.name]);)g=g.parent;if(h===g){let p=new Et("#text",3);p.value=Je,d.replace(p)}}}})},LU=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){let a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{let r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope,l=s.length;for(;l--;){let c=s[l],u=c.attr(r);u!==void 0?(c.attr(o,u.length>0?u:null),c.attr(r,null)):(u=c.attr(o),o==="style"?u=n.serializeStyle(n.parseStyle(u),c.name):a&&(u=a.call(i,u,o,c.name)),c.attr(o,u.length>0?u:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){let r=s[o],a=r.attr("class");a&&(a=a.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){let i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(m.from(i.firstChild).exists(c=>{var u;return!Li((u=c.value)!==null&&u!==void 0?u:"")})?i.unwrap():i.remove())}}),e.addNodeFilter("script,style",(s,o)=>{var r;let a=l=>l.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,""),i=s.length;for(;i--;){let l=s[i],c=l.firstChild,u=(r=c?.value)!==null&&r!==void 0?r:"";if(o==="script"){let f=l.attr("type");f&&l.attr("type",f==="mce-no/type"?null:f.replace(/^mce\-/,"")),t.element_format==="xhtml"&&c&&u.length>0&&(c.value=`// <![CDATA[
`+a(u)+`
// ]]>`)}else t.element_format==="xhtml"&&c&&u.length>0&&(c.value=`<!--
`+a(u)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){let r=s[o],a=r.value;t.preserve_cdata&&a?.indexOf("[CDATA[")===0?(r.name="#cdata",r.type=4,r.value=n.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):a?.indexOf("mce:protected ")===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){let a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{D(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.remove_trailing_brs&&FU(t,e,e.schema)},$U=e=>{let t=s=>s?.name==="br",n=e.lastChild;if(t(n)){let s=n.prev;t(s)&&(n.remove(),s.remove())}},MU=(e,t,n)=>{let s,o=e.dom,r=t.cloneNode(!0),a=document.implementation;if(a.createHTMLDocument){let i=a.createHTMLDocument("");L.each(r.nodeName==="BODY"?r.childNodes:[r],l=>{i.body.appendChild(i.importNode(l,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return fD(e,we(Q({},n),{node:r})),s&&(o.doc=s),r},UU=(e,t)=>U(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,zU=(e,t,n)=>UU(e,n)?MU(e,t,n):t,HU=(e,t,n)=>{L.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},WU=(e,t,n)=>!t.no_events&&e?dD(e,we(Q({},t),{content:n})).content:n,VU=(e,t,n)=>{let s=Vt(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Fi(C.fromDom(t))?s:L.trim(s)},jU=(e,t,n)=>{let s=n.selection?Q({forced_root_block:!1},n):n,o=e.parse(t,s);return $U(o),o},qU=(e,t,n)=>Ts(e,t).serialize(n),KU=(e,t,n,s,o)=>{let r=qU(t,n,s);return WU(e,o,r)},GU=(e,t)=>{let n=["data-mce-selected"],s=Q({entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1},e),o=t&&t.dom?t.dom:xe.DOM,r=t&&t.schema?t.schema:ws(s),a=rr(s,r);LU(a,s,o);let i=(l,c={})=>{let u=Q({format:"html"},c),f=zU(t,l,u),d=VU(o,f,u),g=jU(a,d,u);return u.format==="tree"?g:KU(t,s,r,g,u)};return{schema:r,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:i,addRules:r.addValidElements,setRules:r.setValidElements,addTempAttr:G(HU,a,n),getTempAttrs:W(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},ZE=(e,t)=>{let n=GU(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},YU="html",XU=(e,t)=>we(Q({},e),{format:t,get:!0,getInner:!0}),ZU=(e,t={})=>{let n=t.format?t.format:YU,s=XU(t,n);return DE(e,s).fold($t,o=>{let r=EU(e,o);return PE(e,r,o)})},QU="html",JU=(e,t)=>we(Q({format:QU},e),{set:!0,content:t}),Md=(e,t,n={})=>{let s=JU(n,t);return Rd(e,s).map(o=>{let r=SU(e,o.content,o);return Td(e,r.html,o),r.content}).getOr(t)},ez="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists,template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),tz=[],nz="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,template,textcolor,rtc".split(","),QE=[{name:"export",replacedWith:"Export to PDF"}],JE=(e,t)=>{let n=se(t,s=>oe(e,s));return Hs(n)},sz=e=>{let t=JE(e,ez),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),Hs(t)},oz=e=>JE(e,tz),eS=(e,t)=>{let n=L.makeMap(e.plugins," "),o=se(t,r=>oe(n,r));return Hs(o)},rz=e=>eS(e,nz),az=e=>eS(e,QE.map(t=>t.name)),iz=(e,t)=>{let n=sz(e),s=rz(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){let i=`
- `,l=a?`

Themes:${i}mobile`:"",c=o?`

Plugins:${i}${s.join(i)}`:"",u=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 7.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/7/migration-from-6x/ for more information."+l+c+u)}},lz=e=>Ze(QE,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),cz=(e,t)=>{let n=oz(e),s=az(t),o=s.length>0,r=n.length>0;if(o||r){let a=`
- `,i=o?`

Plugins:${a}${s.map(lz).join(a)}`:"",l=r?`

Options:${a}${n.join(a)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+i+l)}},uz=(e,t)=>{iz(e,t),cz(e,t)},Rl=xe.DOM,fz=e=>{Rl.setStyle(e.id,"display",e.orgDisplay)},Tl=e=>m.from(e).each(t=>t.destroy()),dz=e=>{let t=e;t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;let n=e.selection;if(n){let s=n.dom;t.selection=n.win=n.dom=s.doc=null}},mz=e=>{let t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),Rl.unbind(t,"submit reset",e.formEventDelegate))},gz=e=>{if(!e.removed){let{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&U(o?.nextSibling)&&Rl.remove(o.nextSibling),mD(e),e.editorManager.remove(e),!e.inline&&s&&fz(e),gD(e),Rl.remove(e.getContainer()),Tl(t),Tl(n),e.destroy()}},pz=(e,t)=>{let{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),Tl(n),Tl(s)),mz(e),dz(e),e.destroyed=!0}},Dl=(()=>{let e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>oe(e,o)}})(),ar=vt.ModelManager,tS=(e,t)=>t.dom[e],nS=(e,t)=>parseInt(Ln(t,e),10),hz=G(tS,"clientWidth"),bz=G(tS,"clientHeight"),Cz=G(nS,"margin-top"),yz=G(nS,"margin-left"),vz=e=>e.dom.getBoundingClientRect(),Ez=(e,t,n)=>{let s=hz(e),o=bz(e);return t>=0&&n>=0&&t<=s&&n<=o},Sz=(e,t,n,s)=>{let o=vz(t),r=e?o.left+t.dom.clientLeft+yz(t):0,a=e?o.top+t.dom.clientTop+Cz(t):0,i=n-r,l=s-a;return{x:i,y:l}},wz=(e,t,n)=>{let s=C.fromDom(e.getBody()),o=e.inline?s:hx(s),r=Sz(e.inline,o,t,n);return Ez(o,r.x,r.y)},kz=e=>m.from(e).map(C.fromDom),_z=e=>{let t=e.inline?e.getBody():e.getContentAreaContainer();return kz(t).map(Bo).getOr(!1)};var Az=()=>{let e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};let sS=e=>{let t=[],n=()=>{let d=e.theme;return d&&d.getNotificationManagerImpl?d.getNotificationManagerImpl():Az()},s=()=>m.from(t[0]),o=(d,g)=>d.type===g.type&&d.text===g.text&&!d.progressBar&&!d.timeout&&!g.progressBar&&!g.timeout,r=()=>{s().each(d=>{d.reposition()})},a=d=>{t.push(d)},i=d=>{Ar(t,g=>g===d).each(g=>{t.splice(g,1)})},l=(d,g=!0)=>e.removed||!_z(e)?{}:(g&&e.dispatch("BeforeOpenNotification",{notification:d}),Ze(t,h=>o(n().getArgs(h),d)).getOrThunk(()=>{e.editorManager.setActive(e);let h=n().open(d,()=>{i(h)},()=>_f(e));return a(h),r(),e.dispatch("OpenNotification",{notification:Q({},h)}),h})),c=()=>{s().each(d=>{n().close(d),i(d),r()})},u=W(t);return(d=>{d.on("SkinLoaded",()=>{let g=aP(d);g&&l({text:g,type:"warning",timeout:0},!1),r()}),d.on("show ResizeEditor ResizeWindow NodeChange ToggleView FullscreenStateChanged",()=>{requestAnimationFrame(r)}),d.on("remove",()=>{D(t.slice(),g=>{n().close(g)})}),d.on("keydown",g=>{var h;let p=((h=g.key)===null||h===void 0?void 0:h.toLowerCase())==="f12"||g.keyCode===123;g.altKey&&p&&(g.preventDefault(),s().map(b=>C.fromDom(b.getEl())).each(b=>gp(b)))})})(e),{open:l,close:c,getNotifications:u}},ir=vt.PluginManager,Co=vt.ThemeManager;var xz=()=>{let e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};let oS=e=>{let t=[],n=()=>{let p=e.theme;return p&&p.getWindowManagerImpl?p.getWindowManagerImpl():xz()},s=(p,b)=>(...y)=>b?b.apply(p,y):void 0,o=p=>{e.dispatch("OpenWindow",{dialog:p})},r=p=>{e.dispatch("CloseWindow",{dialog:p})},a=p=>{t.push(p),o(p)},i=p=>{r(p),t=se(t,b=>b!==p),t.length===0&&e.focus()},l=()=>m.from(t[t.length-1]),c=p=>{e.editorManager.setActive(e),ol(e),e.ui.show();let b=p();return a(b),b},u=(p,b)=>c(()=>n().open(p,b,i)),f=p=>c(()=>n().openUrl(p,i)),d=(p,b,y)=>{let v=n();v.alert(p,s(y||v,b))},g=(p,b,y)=>{let v=n();v.confirm(p,s(y||v,b))},h=()=>{l().each(p=>{n().close(p),i(p)})};return e.on("remove",()=>{D(t,p=>{n().close(p)})}),{open:u,openUrl:f,alert:d,confirm:g,close:h}},rS=(e,t)=>{e.notificationManager.open({type:"error",text:t})},Pl=(e,t)=>{e._skinLoaded?rS(e,t):e.on("SkinLoaded",()=>{rS(e,t)})},Nz=(e,t)=>{Pl(e,Sn.translate(["Failed to upload image: {0}",t]))},La=(e,t,n)=>{cb(e,t,{message:n}),console.error(n)},$a=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,Rz=(e,t,n)=>{La(e,"PluginLoadError",$a("plugin",t,n))},Tz=(e,t,n)=>{La(e,"IconsLoadError",$a("icons",t,n))},Dz=(e,t,n)=>{La(e,"LanguageLoadError",$a("language",t,n))},Pz=(e,t,n)=>{La(e,"ThemeLoadError",$a("theme",t,n))},Bz=(e,t,n)=>{La(e,"ModelLoadError",$a("model",t,n))},Oz=(e,t,n)=>{let s=Sn.translate(["Failed to initialize plugin: {0}",t]);cb(e,"PluginLoadError",{message:s}),Bl(s,n),Pl(e,s)},Bl=(e,...t)=>{let n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},Iz=e=>{m.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},Ud=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},Fz=(e,t)=>{Ud(e,"StyleWithCSS",t),Ud(e,"enableInlineTableEditing",t),Ud(e,"enableObjectResizing",t)},Lz=e=>{e.selection.setRng(e.selection.getRng())},aS=(e,t,n)=>{nu(e,t)&&!n?Gr(e,t):n&&Fo(e,t)},iS=e=>{let t=C.fromDom(e.getBody());aS(t,"mce-content-readonly",!0),e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),Iz(e)},lS=e=>{let t=C.fromDom(e.getBody());aS(t,"mce-content-readonly",!1),e.hasEditableRoot()&&ki(t,!0),Fz(e,!1),_f(e)&&e.focus(),Lz(e),e.nodeChanged()},cs=e=>Ki(e),yo="data-mce-contenteditable",$z=e=>{D(mt(e,'*[contenteditable="true"]'),t=>{at(t,yo,"true"),ki(t,!1)})},Mz=e=>{D(mt(e,`*[${yo}="true"]`),t=>{it(t,yo),ki(t,!0)})},cS=(e,t)=>{let n=C.fromDom(e.getBody());t?(iS(e),ki(n,!1),$z(n)):(Mz(n),lS(e))},Uz=e=>{e.serializer?uS(e):e.on("PreInit",()=>{uS(e)})},uS=e=>{e.parser.addAttributeFilter("contenteditable",t=>{cs(e)&&D(t,n=>{n.attr(yo,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(yo,t=>{cs(e)&&D(t,n=>{n.attr("contenteditable",n.attr(yo))})}),e.serializer.addTempAttr(yo)},zz=e=>e.type==="click",Hz=["copy"],Wz=e=>ke(Hz,e.type),Vz=(e,t)=>Io(t,"a",s=>Se(s,C.fromDom(e.getBody()))).bind(s=>ss(s,"href")),jz=(e,t)=>{if(zz(t)&&!j.metaKeyPressed(t)){let n=C.fromDom(t.target);Vz(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){let o=e.dom.select(`${s},[name="${Ag(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else Wz(t)&&e.dispatch(t.type,t)},qz=e=>{e.on("ShowCaret ObjectSelected",t=>{cs(e)&&t.preventDefault()}),e.on("DisabledStateChange",t=>{t.isDefaultPrevented()||cS(e,t.state)})},Kz=e=>{Uz(e),qz(e)},Gz=e=>/^[a-z0-9\-]+$/i.test(e),zd=e=>"content/"+e+"/content.css",Yz=e=>tinymce.Resource.has(zd(e)),Xz=e=>fS(e,eP(e)),Zz=e=>fS(e,kb(e)),fS=(e,t)=>{let n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return be(t,r=>Yz(r)?r:Gz(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},Qz=e=>{e.contentCSS=e.contentCSS.concat(Xz(e),Zz(e))},Jz=e=>e?Mt(e.getElementsByTagName("img")):[],eH=(e,t)=>{let n={};return{findAll:(o,r=He)=>{let a=se(Jz(o),l=>{let c=l.src;return l.hasAttribute("data-mce-bogus")||l.hasAttribute("data-mce-placeholder")||!c||c===ye.transparentSrc?!1:Qe(c,"blob:")?!e.isUploaded(c)&&r(l):Qe(c,"data:")?r(l):!1}),i=be(a,l=>{let c=l.src;if(oe(n,c))return n[c].then(u=>ee(u)?u:{image:l,blobInfo:u.blobInfo});{let u=o$(t,c).then(f=>(delete n[c],{image:l,blobInfo:f})).catch(f=>(delete n[c],f));return n[c]=u,u}});return Promise.all(i)}}},dS=()=>{let n={},s=(d,g)=>({status:d,resultUri:g}),o=d=>d in n;return{hasBlobUri:o,getResultUri:d=>{let g=n[d];return g?g.resultUri:null},isPending:d=>o(d)?n[d].status===1:!1,isUploaded:d=>o(d)?n[d].status===2:!1,markPending:d=>{n[d]=s(1,null)},markUploaded:(d,g)=>{n[d]=s(2,g)},removeFailed:d=>{delete n[d]},destroy:()=>{n={}}}},tH=0,nH=()=>{let e=()=>Math.round(yg()*4294967295).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},sH=e=>e+tH+++nH(),oH=()=>{let e=[],t=f=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[f.toLowerCase()]||"dat",n=(f,d,g,h,p)=>{if(ee(f))return s({id:f,name:h,filename:p,blob:d,base64:g});if(ot(f))return s(f);throw new Error("Unknown input type")},s=f=>{if(!f.blob||!f.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");let d=f.id||sH("blobid"),g=f.name||d,h=f.blob;return{id:W(d),name:W(g),filename:W(f.filename||g+"."+t(h.type)),blob:W(h),base64:W(f.base64),blobUri:W(f.blobUri||URL.createObjectURL(h)),uri:W(f.uri)}},o=f=>{a(f.id())||e.push(f)},r=f=>Ze(e,f).getOrUndefined(),a=f=>r(d=>d.id()===f);return{create:n,add:o,get:a,getByUri:f=>r(d=>d.blobUri()===f),getByData:(f,d)=>r(g=>g.base64()===f&&g.blob().type===d),findFirst:r,removeByUri:f=>{e=se(e,d=>d.blobUri()===f?(URL.revokeObjectURL(d.blobUri()),!1):!0)},destroy:()=>{D(e,f=>{URL.revokeObjectURL(f.blobUri())}),e=[]}}},rH=(e,t)=>{let n={},s=(p,b)=>p?p.replace(/\/$/,"")+"/"+b.replace(/^\//,""):b,o=(p,b)=>new Promise((y,v)=>{let E=new XMLHttpRequest;E.open("POST",t.url),E.withCredentials=t.credentials,E.upload.onprogress=T=>{b(T.loaded/T.total*100)},E.onerror=()=>{v("Image upload failed due to a XHR Transport error. Code: "+E.status)},E.onload=()=>{if(E.status<200||E.status>=300){v("HTTP Error: "+E.status);return}let T=JSON.parse(E.responseText);if(!T||!ee(T.location)){v("Invalid JSON: "+E.responseText);return}y(s(t.basePath,T.location))};let w=new FormData;w.append("file",p.blob(),p.filename()),E.send(w)}),r=_e(t.handler)?t.handler:o,a=()=>new Promise(p=>{p([])}),i=(p,b)=>({url:b,blobInfo:p,status:!0}),l=(p,b)=>({url:"",blobInfo:p,status:!1,error:b}),c=(p,b)=>{L.each(n[p],y=>{y(b)}),delete n[p]},u=(p,b,y)=>(e.markPending(p.blobUri()),new Promise(v=>{let E,w;try{let T=()=>{E&&(E.close(),w=ce)},B=x=>{T(),e.markUploaded(p.blobUri(),x),c(p.blobUri(),i(p,x)),v(i(p,x))},H=x=>{T(),e.removeFailed(p.blobUri()),c(p.blobUri(),l(p,x)),v(l(p,x))};w=x=>{x<0||x>100||m.from(E).orThunk(()=>m.from(y).map(Ac)).each(_=>{E=_,_.progressBar.value(x)})},b(p,w).then(B,x=>{H(ee(x)?{message:x}:x)})}catch(T){v(l(p,T))}})),f=p=>p===o,d=p=>{let b=p.blobUri();return new Promise(y=>{n[b]=n[b]||[],n[b].push(y)})},g=(p,b)=>(p=L.grep(p,y=>!e.isUploaded(y.blobUri())),Promise.all(L.map(p,y=>e.isPending(y.blobUri())?d(y):u(y,r,b))));return{upload:(p,b)=>!t.url&&f(r)?a():g(p,b)}},mS=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),gS=(e,t)=>rH(t,{url:KD(e),basePath:GD(e),credentials:YD(e),handler:XD(e)}),aH=e=>{let t=dS(),n=gS(e,t);return{upload:(s,o=!0)=>n.upload(s,o?mS(e):void 0)}},iH=(e,t)=>e.dom.isEmpty(t.dom)&&U(e.schema.getTextBlockElements()[Ce(t)]),lH=e=>t=>{iH(e,t)&&Ke(t,C.fromHtml('<br data-mce-bogus="1" />'))},cH=e=>{let t=oH(),n,s,o=dS(),r=[],a=E=>w=>e.selection?E(w):[],i=E=>E+(E.indexOf("?")===-1?"?":"&")+new Date().getTime(),l=(E,w,T)=>{let B=0;do B=E.indexOf(w,B),B!==-1&&(E=E.substring(0,B)+T+E.substr(B+w.length),B+=T.length-w.length+1);while(B!==-1);return E},c=(E,w,T)=>{let B=`src="${T}"${T===ye.transparentSrc?' data-mce-placeholder="1"':""}`;return E=l(E,`src="${w}"`,B),E=l(E,'data-mce-src="'+w+'"','data-mce-src="'+T+'"'),E},u=(E,w)=>{D(e.undoManager.data,T=>{T.type==="fragmented"?T.fragments=be(T.fragments,B=>c(B,E,w)):T.content=c(T.content,E,w)})},f=(E,w)=>{let T=e.convertURL(w,"src");u(E.src,w),ns(C.fromDom(E),{src:vb(e)?i(w):w,"data-mce-src":T})},d=()=>(n||(n=gS(e,o)),b().then(a(E=>{let w=be(E,T=>T.blobInfo);return n.upload(w,mS(e)).then(a(T=>{let B=[],H=!1,x=be(T,(_,P)=>{let{blobInfo:z,image:X}=E[P],re=!1;return _.status&&jD(e)?(_.url&&!ft(X.src,_.url)&&(H=!0),t.removeByUri(X.src),qn(e)||f(X,_.url)):_.error&&(_.error.remove&&(u(X.src,ye.transparentSrc),B.push(X),re=!0),Nz(e,_.error.message)),{element:X,status:_.status,uploadUri:_.url,blobInfo:z,removed:re}});return B.length>0&&!qn(e)?e.undoManager.transact(()=>{D(Gc(B),_=>{let P=Fn(_);Te(_),P.each(lH(e)),t.removeByUri(_.dom.src)})}):H&&e.undoManager.dispatchChange(),x}))}))),g=()=>yb(e)?d():Promise.resolve([]),h=E=>Qn(r,w=>w(E)),p=E=>{r.push(E)},b=()=>(s||(s=eH(o,t)),s.findAll(e.getBody(),h).then(a(E=>{let w=se(E,T=>ee(T)?(Pl(e,T),!1):T.uriType!=="blob");return qn(e)||D(w,T=>{u(T.image.src,T.blobInfo.blobUri()),T.image.src=T.blobInfo.blobUri(),T.image.removeAttribute("data-mce-src")}),w}))),y=()=>{t.destroy(),o.destroy(),s=n=null},v=E=>E.replace(/src="(blob:[^"]+)"/g,(w,T)=>{let B=o.getResultUri(T);if(B)return'src="'+B+'"';let H=t.getByUri(T);return H||(H=Pt(e.editorManager.get(),(x,_)=>x||_.editorUpload&&_.editorUpload.blobCache.getByUri(T),void 0)),H?'src="data:'+H.blob().type+";base64,"+H.base64()+'"':w});return e.on("SetContent",()=>{yb(e)?g():b()}),e.on("RawSaveContent",E=>{E.content=v(E.content)}),e.on("GetContent",E=>{E.source_view||E.format==="raw"||E.format==="tree"||(E.content=v(E.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",E=>{D(E,w=>{let T=w.attr("src");if(!T||t.getByUri(T))return;let B=o.getResultUri(T);B&&w.attr("src",B)})})}),{blobCache:t,addFilter:p,uploadImages:d,uploadImagesAuto:g,scanForImages:b,destroy:y}},uH=e=>{let t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:".mce-placeholder",styles:{float:"left"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:".mce-placeholder",styles:{display:"block",marginLeft:"auto",marginRight:"auto"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:".mce-placeholder",styles:{float:"right"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{let o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},samp:{inline:"samp"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>q(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{L.each(a,(i,l)=>{t.setAttrib(o,l,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o?.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return L.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},pS={remove_similar:!0,inherit:!1},lr=Q({selector:"td,th"},pS),fH={tablecellbackgroundcolor:Q({styles:{backgroundColor:"%value"}},lr),tablecellverticalalign:Q({styles:{"vertical-align":"%value"}},lr),tablecellbordercolor:Q({styles:{borderColor:"%value"}},lr),tablecellclass:Q({classes:["%value"]},lr),tableclass:Q({selector:"table",classes:["%value"]},pS),tablecellborderstyle:Q({styles:{borderStyle:"%value"}},lr),tablecellborderwidth:Q({styles:{borderWidth:"%value"}},lr)},dH=W(fH),mH=e=>{let t={},n=a=>U(a)?t[a]:t,s=a=>oe(t,a),o=(a,i)=>{a&&(ee(a)?(Be(i)||(i=[i]),D(i,l=>{rt(l.deep)&&(l.deep=!en(l)),rt(l.split)&&(l.split=!en(l)||tt(l)),rt(l.remove)&&en(l)&&!tt(l)&&(l.remove="none"),en(l)&&tt(l)&&(l.mixed=!0,l.block_expand=!0),ee(l.classes)&&(l.classes=l.classes.split(/\s+/))}),t[a]=i):Ne(a,(l,c)=>{o(c,l)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(uH(e)),o(dH()),o(cP(e)),{get:n,has:s,register:o,unregister:r}},Ol=L.each,sn=xe.DOM,Hd=e=>U(e)&&ot(e),hS=(e,t)=>{let n=t&&t.schema||ws({}),s=(l,c)=>{c.classes.length>0&&sn.addClass(l,c.classes.join(" ")),sn.setAttribs(l,c.attrs)},o=l=>{let c=ee(l)?{name:l,classes:[],attrs:{}}:l,u=sn.create(c.name);return s(u,c),u},r=(l,c)=>{let u=n.getElementRule(l.nodeName.toLowerCase()),f=u?.parentsRequired;return f&&f.length?c&&ke(f,c)?c:f[0]:!1},a=(l,c,u)=>{let f,d=c[0],g=Hd(d)?d.name:void 0,h=r(l,g);if(h)g===h?(f=d,c=c.slice(1)):f=h;else if(d)f=d,c=c.slice(1);else if(!u)return l;let p=f?o(f):sn.create("div");p.appendChild(l),u&&L.each(u,y=>{let v=o(y);p.insertBefore(v,l)});let b=Hd(f)?f.siblings:void 0;return a(p,c,b)},i=sn.create("div");if(e.length>0){let l=e[0],c=o(l),u=Hd(l)?l.siblings:void 0;i.appendChild(a(c,e.slice(1),u))}return i},gH=e=>{e=L.trim(e);let t="div",n={name:t,classes:[],attrs:{},selector:e};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":L.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){let l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},pH=e=>ee(e)?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),L.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{let n=L.map(t.split(/(?:~\+|~|\+)/),gH),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()):[],hH=(e,t)=>{let n="",s=uP(e);if(s==="")return"";let o=d=>ee(d)?d.replace(/%(\w+)/g,""):"",r=(d,g)=>sn.getStyle(g??e.getBody(),d,!0);if(ee(t)){let d=e.formatter.get(t);if(!d)return"";t=d[0]}if("preview"in t){let d=t.preview;if(d===!1)return"";s=d||s}let a=t.block||t.inline||"span",i,l=pH(t.selector);l.length>0?(l[0].name||(l[0].name=a),a=t.selector,i=hS(l,e)):i=hS([a],e);let c=sn.select(a,i)[0]||i.firstChild;Ol(t.styles,(d,g)=>{let h=o(d);h&&sn.setStyle(c,g,h)}),Ol(t.attributes,(d,g)=>{let h=o(d);h&&sn.setAttrib(c,g,h)}),Ol(t.classes,d=>{let g=o(d);sn.hasClass(c,g)||sn.addClass(c,g)}),e.dispatch("PreviewFormats"),sn.setStyles(i,{position:"absolute",left:-65535}),e.getBody().appendChild(i);let u=r("fontSize"),f=/px$/.test(u)?parseInt(u,10):0;return Ol(s.split(" "),d=>{let g=r(d,c);if(!(d==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(g)&&(g=r(d),Zr(g).toLowerCase()==="#ffffff"))&&!(d==="color"&&Zr(g).toLowerCase()==="#000000")){if(d==="font-size"&&/em|%$/.test(g)){if(f===0)return;g=parseFloat(g)/(/%$/.test(g)?100:1)*f+"px"}d==="border"&&g&&(n+="padding:0 2px;"),n+=d+":"+g+";"}}),e.dispatch("AfterPreviewFormats"),sn.remove(i),n},bH=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},bS=e=>{let t=mH(e),n=nt({});return bH(e),hL(e),qn(e)||zL(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{bU(e,s,o,r)},remove:(s,o,r,a)=>{CU(e,s,o,r,a)},toggle:(s,o,r)=>{yU(e,s,o,r)},match:(s,o,r,a)=>dU(e,s,o,r,a),closest:s=>hU(e,s),matchAll:(s,o)=>mU(e,s,o),matchNode:(s,o,r,a)=>gU(e,s,o,r,a),canApply:s=>pU(e,s),formatChanged:(s,o,r,a)=>vU(e,n,s,o,r,a),getCssText:G(hH,e)}},CS=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},CH=(e,t,n)=>{let s=nt(!1),o=l=>{Nl(t,!1,n),t.add({},l)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",l=>{let c=l.command;CS(c)||(WE(t,n),t.beforeChange())}),e.on("ExecCommand",l=>{let c=l.command;CS(c)||o(l)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",l=>{let c=l.keyCode;if(l.isDefaultPrevented())return;let u=ye.os.isMacOS()&&l.key==="Meta";(c>=33&&c<=36||c>=37&&c<=40||c===45||l.ctrlKey||u)&&(o(),e.nodeChanged()),(c===46||c===8)&&e.nodeChanged(),s.get()&&t.typing&&!Fd(xl(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged())}),e.on("keydown",l=>{let c=l.keyCode;if(l.isDefaultPrevented())return;if(c>=33&&c<=36||c>=37&&c<=40||c===45){t.typing&&o(l);return}let u=l.ctrlKey&&!l.altKey||l.metaKey;if((c<16||c>20)&&c!==224&&c!==91&&!t.typing&&!u){t.beforeChange(),Nl(t,!0,n),t.add({},l),s.set(!0);return}(ye.os.isMacOS()?l.metaKey:l.ctrlKey&&!l.altKey)&&t.beforeChange()}),e.on("mousedown",l=>{t.typing&&o(l)});let r=l=>l.inputType==="insertReplacementText",a=l=>l.inputType==="insertText"&&l.data===null,i=l=>l.inputType==="insertFromPaste"||l.inputType==="insertFromDrop";e.on("input",l=>{l.inputType&&(r(l)||a(l)||i(l))&&o(l)}),e.on("AddUndo Undo Redo ClearUndos",l=>{l.isDefaultPrevented()||e.nodeChanged()})},yH=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},yS=e=>{let t=Jn(),n=nt(0),s=nt(0),o={data:[],typing:!1,beforeChange:()=>{tU(e,n,t)},add:(r,a)=>nU(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0);let r=xl(e);r.bookmark=Vu(e.selection),e.dispatch("change",{level:r,lastLevel:Nr(o.data,s.get()).getOrUndefined()})},undo:()=>sU(e,o,n,s),redo:()=>oU(e,s,o.data),clear:()=>{rU(e,o,s)},reset:()=>{aU(e,o)},hasUndo:()=>iU(e,o,s),hasRedo:()=>lU(e,o,s),transact:r=>cU(e,o,n,r),ignore:r=>{uU(e,n,r)},extra:(r,a)=>{fU(e,o,s,r,a)}};return qn(e)||CH(e,o,n),yH(e),o},vH=[9,27,j.HOME,j.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,j.DOWN,j.UP,j.LEFT,j.RIGHT].concat(ye.browser.isFirefox()?[224]:[]),vS="data-mce-placeholder",ES=e=>e.type==="keydown"||e.type==="keyup",SS=e=>{let t=e.keyCode;return t===j.BACKSPACE||t===j.DELETE},EH=e=>{if(ES(e)){let t=e.keyCode;return!SS(e)&&(j.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||ke(vH,t))}else return!1},SH=e=>ES(e)&&!(SS(e)||e.type==="keyup"&&e.keyCode===229),wH=(e,t,n)=>{if(e.isEmpty(t,void 0,{skipBogus:!1,includeZwsp:!0})){let s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},kH=e=>{var t;let n=e.dom,s=pt(e),o=(t=rP(e))!==null&&t!==void 0?t:"",r=(a,i)=>{if(EH(a))return;let l=e.getBody(),c=SH(a)?!1:wH(n,l,s);(n.getAttrib(l,vS)!==""!==c||i)&&(n.setAttrib(l,vS,c?o:null),ED(e,c),e.on(c?"keydown":"keyup",r),e.off(c?"keyup":"keydown",r))};Pn(o)&&e.on("init",a=>{r(a,!0),e.on("change SetContent ExecCommand",r),e.on("paste",i=>tn.setEditorTimeout(e,()=>r(i)))})},_H=(e,t)=>({block:e,position:t}),AH=(e,t)=>({from:e,to:t}),Wd=(e,t)=>{let n=C.fromDom(e),s=C.fromDom(t.container());return hl(n,s).map(o=>_H(o,t))},xH=e=>!(yn(e.to.block,e.from.block)||yn(e.from.block,e.to.block)),NH=e=>!Se(e.from.block,e.to.block),wS=(e,t)=>vs(t,o=>ra(o)||cn(o.dom),o=>Se(o,e)).filter(Ht).getOr(e),RH=(e,t)=>{let n=C.fromDom(e);return Se(wS(n,t.from.block),wS(n,t.to.block))},TH=e=>Re(e.from.block.dom)===!1&&Re(e.to.block.dom)===!1,DH=e=>{let t=n=>Dh(n)||pu(n.dom)||Wo(n);return t(e.from.block)&&t(e.to.block)},PH=(e,t,n,s)=>Le(s.position.getNode())&&!gt(e,s.block)?Qo(!1,s.block.dom).bind(o=>o.isEqual(s.position)?Zt(n,t,o).bind(r=>Wd(t,r)):m.some(s)).getOr(s):s,BH=(e,t,n,s)=>{let o=Wd(t,N.fromRangeStart(s)),r=o.bind(a=>Zt(n,t,a.position).bind(i=>Wd(t,i).map(l=>PH(e,t,n,l))));return ct(o,r,AH).filter(a=>NH(a)&&RH(t,a)&&TH(a)&&DH(a)&&xH(a))},OH=(e,t,n,s)=>s.collapsed?BH(e,t,n,s):m.none(),IH=(e,t)=>{let n=dt(e);return Ar(n,s=>t.isBlock(Ce(s))).fold(W(n),s=>n.slice(0,s))},kS=(e,t)=>{let n=IH(e,t);return D(n,Te),n},_S=(e,t,n)=>{let s=ls(n,t);return Ze(s.reverse(),o=>gt(e,o)).each(Te)},FH=(e,t)=>se(up(t),n=>!gt(e,n)).length===0,LH=(e,t,n,s,o)=>{if(gt(s,n))return ks(n),ht(n.dom);FH(s,o)&&gt(s,t)&&Bt(o,C.fromTag("br"));let r=Ot(n.dom,N.before(o.dom));return D(kS(t,s),a=>{Bt(o,a)}),_S(s,e,t),r},$H=(e,t)=>e.isInline(Ce(t)),MH=(e,t,n,s)=>{if(gt(s,n)){if(gt(s,t)){let a=_r((i=>{let l=(c,u)=>zc(c).fold(()=>u,f=>$H(s,f)?l(f,u.concat(qs(f))):u);return l(i,[])})(n),(i,l)=>(hp(i,l),l),Vo());Po(t),Ke(t,a)}return Te(n),ht(t.dom)}let o=un(n.dom);return D(kS(t,s),r=>{Ke(n,r)}),_S(s,e,t),o},UH=(e,t)=>{let n=ls(t,e);return m.from(n[n.length-1])},zH=(e,t)=>yn(t,e)?UH(t,e):m.none(),AS=(e,t)=>{Qo(e,t.dom).bind(n=>m.from(n.getNode())).map(C.fromDom).filter(no).each(Te)},xS=(e,t,n,s)=>(AS(!0,t),AS(!1,n),zH(t,n).fold(G(MH,e,t,n,s),G(LH,e,t,n,s))),NS=(e,t,n,s,o)=>t?xS(e,s,n,o):xS(e,n,s,o),Vd=(e,t)=>{let n=C.fromDom(e.getBody());return OH(e.schema,n.dom,t,e.selection.getRng()).map(o=>()=>{NS(n,t,o.from.block,o.to.block,e.schema).each(r=>{e.selection.setRng(r.toRange())})})},HH=(e,t,n)=>{let s=t.getRng();return ct(hl(e,C.fromDom(s.startContainer)),hl(e,C.fromDom(s.endContainer)),(o,r)=>Se(o,r)?m.none():m.some(()=>{s.deleteContents(),NS(e,!0,o,r,n).each(a=>{t.setRng(a.toRange())})})).getOr(m.none())},RS=(e,t)=>{let n=C.fromDom(t),s=G(Se,e);return os(n,ra,s).isSome()},WH=(e,t)=>RS(e,t.startContainer)||RS(e,t.endContainer),VH=(e,t)=>{let n=Ot(e.dom,N.fromRangeStart(t)).isNone(),s=Rt(e.dom,N.fromRangeEnd(t)).isNone();return!WH(e,t)&&n&&s},jH=e=>m.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),qH=e=>{let t=C.fromDom(e.getBody()),n=e.selection.getRng();return VH(t,n)?jH(e):HH(t,e.selection,e.schema)},jd=(e,t)=>e.selection.isCollapsed()?m.none():qH(e),us=(e,t,n,s,o)=>m.from(t._selectionOverrides.showCaret(e,n,s,o)),KH=e=>{let t=e.ownerDocument.createRange();return t.selectNode(e),t},Ma=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?m.none():m.some(KH(t)),GH=(e,t,n)=>{let s=ef(1,e.getBody(),t),o=N.fromRangeStart(s),r=o.getNode();if(da(r))return us(1,e,r,!o.isAtEnd(),!1);let a=o.getNode(!0);if(da(a))return us(1,e,a,!1,!1);let i=po(e.dom.getRoot(),o.getNode());return da(i)?us(1,e,i,!1,n):m.none()},qd=(e,t,n)=>t.collapsed?GH(e,t,n).getOr(t):t,YH=e=>Ps(e)||wa(e),XH=e=>Bs(e)||ka(e),ZH=(e,t)=>{F(t)&&t.data.length===0&&e.remove(t)},TS=(e,t,n,s,o,r)=>{us(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){let i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),ZH(e.dom,n)},QH=(e,t)=>{let n=e.selection.getRng();if(!F(n.commonAncestorContainer))return m.none();let s=t?1:-1,o=Wn(e.getBody()),r=G(tf,t?o.next:o.prev),a=t?YH:XH,i=ba(s,e.getBody(),n),l=r(i),c=l&&nn(t,l);if(!c||!Xi(i,c))return m.none();if(a(c))return m.some(()=>TS(e,n,i.getNode(),s,t,c));let u=r(c);return u&&a(u)&&Xi(c,u)?m.some(()=>TS(e,n,i.getNode(),s,t,u)):m.none()},Kd=(e,t)=>QH(e,t),Gd=(e,t)=>{let n=e.getBody();return t?ht(n).filter(Ps):un(n).filter(Bs)},Yd=e=>{let t=e.selection.getRng();return!t.collapsed&&(Gd(e,!0).exists(n=>n.isEqual(N.fromRangeStart(t)))||Gd(e,!1).exists(n=>n.isEqual(N.fromRangeEnd(t))))},JH=e=>U(e)&&(ra(C.fromDom(e))||Wo(C.fromDom(e))),jt=Dn.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),e2=(e,t)=>{let n=t.getNode(!e),s=e?"after":"before";return q(n)&&n.getAttribute("data-mce-caret")===s},t2=(e,t,n,s,o)=>{let r=a=>o.isInline(a.nodeName.toLowerCase())&&!zn(n,s,e);return Kb(!t,n).fold(()=>Kb(t,s).fold(Oe,r),r)},DS=(e,t,n,s,o)=>{let r=o.getNode(!n);return hl(C.fromDom(t),C.fromDom(s.getNode())).map(a=>gt(e,a)?jt.remove(a.dom):jt.moveToElement(r)).orThunk(()=>m.some(jt.moveToElement(r)))},PS=(e,t,n,s)=>Zt(t,e,n).bind(o=>JH(o.getNode())||t2(e,t,n,o,s)?m.none():t&&Re(o.getNode())||!t&&Re(o.getNode(!0))?DS(s,e,t,n,o):t&&Bs(n)||!t&&Ps(n)?m.some(jt.moveToPosition(o)):m.none()),n2=(e,t)=>qe(t)?m.none():e&&Re(t.nextSibling)?m.some(jt.moveToElement(t.nextSibling)):!e&&Re(t.previousSibling)?m.some(jt.moveToElement(t.previousSibling)):m.none(),s2=(e,t,n)=>n.fold(s=>m.some(jt.remove(s)),s=>m.some(jt.moveToElement(s)),s=>zn(t,s,e)?m.none():m.some(jt.moveToPosition(s))),o2=(e,t,n,s)=>e2(t,n)?n2(t,n.getNode(!t)).orThunk(()=>PS(e,t,n,s)):PS(e,t,n,s).bind(o=>s2(e,n,o)),r2=(e,t,n,s)=>{let o=ef(t?1:-1,e,n),r=N.fromRangeStart(o),a=C.fromDom(e);return!t&&Bs(r)?m.some(jt.remove(r.getNode(!0))):t&&Ps(r)?m.some(jt.remove(r.getNode())):!t&&Ps(r)&&ml(a,r,s)?ky(a,r,s).map(i=>jt.remove(i.getNode())):t&&Bs(r)&&$f(a,r,s)?qO(a,r,s).map(i=>jt.remove(i.getNode())):o2(e,t,r,s)},a2=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),mo(e,t,C.fromDom(n)),!0),i2=(e,t)=>n=>{let s=t?N.before(n):N.after(n);return e.selection.setRng(s.toRange()),!0},l2=e=>t=>(e.selection.setRng(t.toRange()),!0),BS=(e,t)=>m.from(po(e.getBody(),t)),c2=(e,t)=>{let n=e.selection.getNode();return BS(e,n).filter(Re).fold(()=>r2(e.getBody(),t,e.selection.getRng(),e.schema).map(s=>()=>s.fold(a2(e,t),i2(e,t),l2(e))),()=>m.some(ce))},u2=e=>{D(mt(e,".mce-offscreen-selection"),Te)},f2=(e,t)=>{let n=e.selection.getNode();return Re(n)&&!Ri(n)?BS(e,n.parentNode).filter(Re).fold(()=>m.some(()=>{u2(C.fromDom(e.getBody())),mo(e,t,C.fromDom(e.selection.getNode())),Wf(e)}),()=>m.some(ce)):Yd(e)?m.some(()=>{qy(e,e.selection.getRng(),C.fromDom(e.getBody()))}):m.none()},OS=e=>{let t=e.dom,n=e.selection,s=po(e.getBody(),n.getNode());if(cn(s)&&t.isBlock(s)&&t.isEmpty(s)){let o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(N.before(o).toRange())}return!0},Xd=(e,t)=>e.selection.isCollapsed()?c2(e,t):f2(e,t),IS=e=>e.hasOwnProperty("text"),FS=e=>e.hasOwnProperty("marker"),LS=(e,t)=>{let n=(r,a)=>{if(F(r))return{text:r,offset:a};{let i=t(),l=r.childNodes;return a<l.length?(r.insertBefore(i,l[a]),{marker:i,before:!0}):(r.appendChild(i),{marker:i,before:!1})}},s=n(e.endContainer,e.endOffset);return{start:n(e.startContainer,e.startOffset),end:s}},$S=e=>{var t,n;let{start:s,end:o}=e,r=new window.Range;return IS(s)?r.setStart(s.text,s.offset):FS(s)&&(s.before?r.setStartBefore(s.marker):r.setStartAfter(s.marker),(t=s.marker.parentNode)===null||t===void 0||t.removeChild(s.marker)),IS(o)?r.setEnd(o.text,o.offset):FS(o)&&(o.before?r.setEndBefore(o.marker):r.setEndAfter(o.marker),(n=o.marker.parentNode)===null||n===void 0||n.removeChild(o.marker)),r},Zd=(e,t)=>{var n;let s=e.dom,o=s.getParent(e.selection.getStart(),s.isBlock),r=s.getParent(e.selection.getEnd(),s.isBlock),a=e.getBody();if(((n=o?.nodeName)===null||n===void 0?void 0:n.toLowerCase())==="div"&&o&&r&&o===a.firstChild&&r===a.lastChild&&!s.isEmpty(a)){let l=o.cloneNode(!1),c=()=>{if(t?Wy(e):pl(e),a.firstChild!==o){let u=LS(e.selection.getRng(),()=>document.createElement("span"));Array.from(a.childNodes).forEach(f=>l.appendChild(f)),a.appendChild(l),e.selection.setRng($S(u))}};return m.some(c)}return m.none()},d2=(e,t)=>{let n=N.fromRangeStart(e.selection.getRng());return Zt(t,e.getBody(),n).filter(s=>t?$O(s):MO(s)).bind(s=>Ju(t?0:-1,s)).map(s=>()=>e.selection.select(s))},Qd=(e,t)=>e.selection.isCollapsed()?d2(e,t):m.none(),cr=F,MS=e=>cr(e)&&e.data[0]===et,US=e=>cr(e)&&e.data[e.data.length-1]===et,zS=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(et)},m2=e=>{var t;if(cr(e.previousSibling))return US(e.previousSibling)||e.previousSibling.appendData(et),e.previousSibling;if(cr(e))return MS(e)||e.insertData(0,et),e;{let n=zS(e);return(t=e.parentNode)===null||t===void 0||t.insertBefore(n,e),n}},g2=e=>{var t,n;if(cr(e.nextSibling))return MS(e.nextSibling)||e.nextSibling.insertData(0,et),e.nextSibling;if(cr(e))return US(e)||e.appendData(et),e;{let s=zS(e);return e.nextSibling?(t=e.parentNode)===null||t===void 0||t.insertBefore(s,e.nextSibling):(n=e.parentNode)===null||n===void 0||n.appendChild(s),s}},Il=(e,t)=>e?m2(t):g2(t),p2=G(Il,!0),h2=G(Il,!1),HS=(e,t)=>F(e.container())?Il(t,e.container()):Il(t,e.getNode()),WS=(e,t)=>{let n=t.get();return n&&e.container()===n&&_s(n)},Jd=(e,t)=>t.fold(n=>{ro(e.get());let s=p2(n);return e.set(s),m.some(N(s,s.length-1))},n=>ht(n).map(s=>{if(WS(s,e)){let o=e.get();return N(o,1)}else{ro(e.get());let o=HS(s,!0);return e.set(o),N(o,1)}}),n=>un(n).map(s=>{if(WS(s,e)){let o=e.get();return N(o,o.length-1)}else{ro(e.get());let o=HS(s,!1);return e.set(o),N(o,o.length-1)}}),n=>{ro(e.get());let s=h2(n);return e.set(s),m.some(N(s,1))}),VS=(e,t)=>{for(let n=0;n<e.length;n++){let s=e[n].apply(null,t);if(s.isSome())return s}return m.none()},St=Dn.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),jS=(e,t)=>{let n=Ns(t,e);return n||e},b2=(e,t,n)=>{let s=Uy(n),o=jS(t,s.container());return Os(e,o,s).fold(()=>Rt(o,s).bind(G(Os,e,o)).map(r=>St.before(r)),m.none)},C2=(e,t)=>io(e,t)===null,qS=(e,t,n)=>Os(e,t,n).filter(G(C2,t)),y2=(e,t,n)=>{let s=zy(n);return qS(e,t,s).bind(o=>Ot(o,s).isNone()?m.some(St.start(o)):m.none())},v2=(e,t,n)=>{let s=Uy(n);return qS(e,t,s).bind(o=>Rt(o,s).isNone()?m.some(St.end(o)):m.none())},E2=(e,t,n)=>{let s=zy(n),o=jS(t,s.container());return Os(e,o,s).fold(()=>Ot(o,s).bind(G(Os,e,o)).map(r=>St.after(r)),m.none)},KS=e=>!My(em(e)),Kn=(e,t,n)=>VS([b2,y2,v2,E2],[e,t,n]).filter(KS),em=e=>e.fold($t,$t,$t,$t),GS=e=>e.fold(W("before"),W("start"),W("end"),W("after")),Fl=e=>e.fold(St.before,St.before,St.after,St.after),tm=e=>e.fold(St.start,St.start,St.end,St.end),S2=(e,t)=>GS(e)===GS(t)&&em(e)===em(t),w2=(e,t,n,s,o,r)=>ct(Os(t,n,s),Os(t,n,o),(a,i)=>a!==i&&kI(n,a,i)?St.after(e?a:i):r).getOr(r),k2=(e,t)=>e.fold(He,n=>!S2(n,t)),_2=(e,t,n,s,o)=>{let r=nn(e,o);return Zt(e,n,r).map(G(nn,e)).fold(()=>s.map(Fl),l=>Kn(t,n,l).map(G(w2,e,t,n,r,l)).filter(G(k2,s))).filter(KS)},A2=(e,t)=>e?t.fold(Tn(m.some,St.start),m.none,Tn(m.some,St.after),m.none):t.fold(m.none,Tn(m.some,St.before),m.none,Tn(m.some,St.end)),x2=(e,t,n,s)=>{let o=nn(e,s),r=Kn(t,n,o);return Kn(t,n,o).bind(G(A2,e)).orThunk(()=>_2(e,t,n,r,s))},N2=e=>_e(e.selection.getSel().modify),YS=(e,t,n)=>{let s=e?1:-1;return t.setRng(N(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},R2=(e,t)=>{let n=t.selection.getRng(),s=e?N.fromRangeEnd(n):N.fromRangeStart(n);return N2(t)?e&&Bu(s)?YS(!0,t.selection,s):!e&&Ou(s)?YS(!1,t.selection,s):!1:!1};var fs=function(e){return e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol",e}(fs||{});let Ll=(e,t)=>e===-1?xr(t):t,T2=(e,t,n)=>e===1?t.next(n):t.prev(n),D2=(e,t,n,s)=>Le(s.getNode(t===1))?fs.Br:zn(n,s)===!1?fs.Block:fs.Wrap,XS=(e,t,n,s)=>{let o=Wn(n),r=s,a=[];for(;r;){let i=T2(t,o,r);if(!i)break;if(Le(i.getNode(!1)))return t===1?{positions:Ll(t,a).concat([i]),breakType:fs.Br,breakAt:m.some(i)}:{positions:Ll(t,a),breakType:fs.Br,breakAt:m.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){let l=D2(n,t,r,i);return{positions:Ll(t,a),breakType:l,breakAt:m.some(i)}}a.push(i),r=i}return{positions:Ll(t,a),breakType:fs.Eol,breakAt:m.none()}},ZS=(e,t,n,s)=>t(n,s).breakAt.map(o=>{let r=t(n,o).positions;return e===-1?r.concat(o):[o].concat(r)}).getOr([]),nm=(e,t)=>Pt(e,(n,s)=>n.fold(()=>m.some(s),o=>ct(xt(o.getClientRects()),xt(s.getClientRects()),(r,a)=>{let i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),m.none()),$l=(e,t)=>xt(t.getClientRects()).bind(n=>nm(e,n.left)),Ua=G(XS,N.isAbove,-1),za=G(XS,N.isBelow,1),QS=G(ZS,-1,Ua),JS=G(ZS,1,za),e0=(e,t)=>Ua(e,t).breakAt.isNone(),t0=(e,t)=>za(e,t).breakAt.isNone(),P2=e=>ht(e).map(t=>[t].concat(za(e,t).positions)).getOr([]),B2=e=>un(e).map(t=>Ua(e,t).positions.concat(t)).getOr([]),O2=(e,t)=>$l(QS(e,t),t),I2=(e,t)=>$l(JS(e,t),t),F2=Re,n0=(e,t)=>Math.abs(e.left-t),s0=(e,t)=>Math.abs(e.right-t),L2=e=>xo(e,"node"),o0=(e,t)=>hi(e,(n,s)=>{let o=Math.min(n0(n,t),s0(n,t)),r=Math.min(n0(s,t),s0(s,t));return r===o&&L2(s)&&F2(s.node)||r<o?s:n}),$2=e=>{let t=n=>be(n,s=>{let o=so(s);return o.node=e,o});if(q(e))return t(e.getClientRects());if(F(e)){let n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},r0=e=>Yt(e,$2);var ur=function(e){return e[e.Up=-1]="Up",e[e.Down=1]="Down",e}(ur||{});let M2=(e,t,n,s)=>{let o=s;for(;o=ga(o,e,Uh,t);)if(n(o))return},a0=(e,t,n,s,o,r)=>{let a=0,i=[],l=f=>{let d=r0([f]);e===ur.Up&&(d=d.reverse());for(let g=0;g<d.length;g++){let h=d[g];if(!n(h,c)){if(i.length>0&&t(h,Ws(i))&&a++,h.line=a,o(h))return!0;i.push(h)}}return!1},c=Ws(r.getClientRects());if(!c)return i;let u=r.getNode();return u&&(l(u),M2(e,s,l,u)),i},U2=(e,t)=>t.line>e,z2=(e,t)=>t.line===e,H2=G(a0,ur.Up,aa,ia),W2=G(a0,ur.Down,ia,aa),i0=e=>Ws(e.getClientRects()),V2=(e,t,n,s)=>{let o=Wn(t),r,a,i,l,c=[],u=0;e===ur.Down?(r=o.next,a=ia,i=aa,l=N.after(s)):(r=o.prev,a=aa,i=ia,l=N.before(s));let f=i0(l);do{if(!l.isVisible())continue;let d=i0(l);if(i(d,f))continue;c.length>0&&a(d,Ws(c))&&u++;let g=so(d);if(g.position=l,g.line=u,n(g))return c;c.push(g)}while(l=r(l));return c},l0=e=>t=>U2(e,t),sm=e=>t=>z2(e,t),ds=(e,t)=>{e.selection.setRng(t),Sa(e,e.selection.getRng())},om=(e,t,n)=>m.some(qd(e,t,n)),c0=(e,t,n,s,o,r)=>{let a=t===1,i=Wn(e.getBody()),l=G(tf,a?i.next:i.prev),c=a?s:o;if(!n.collapsed){let h=Ui(n);if(r(h))return us(t,e,h,t===-1,!1);if(Yd(e)){let p=n.cloneRange();return p.collapse(t===-1),m.from(p)}}let u=ba(t,e.getBody(),n);if(c(u))return Ma(e,u.getNode(!a));let f=l(u),d=Bh(n);if(f)f=nn(a,f);else return d?m.some(n):m.none();if(c(f))return us(t,e,f.getNode(!a),a,!1);let g=l(f);return g&&c(g)&&Xi(f,g)?us(t,e,g.getNode(!a),a,!1):d?om(e,f.toRange(),!1):m.none()},u0=(e,t,n,s,o,r)=>{let a=ba(t,e.getBody(),n),i=Ws(a.getClientRects()),l=t===ur.Down,c=e.getBody();if(!i)return m.none();if(Yd(e)){let b=l?N.fromRangeEnd(n):N.fromRangeStart(n);return(l?I2:O2)(c,b).orThunk(()=>m.from(b)).map(v=>v.toRange())}let f=(l?W2:H2)(c,l0(1),a),d=se(f,sm(1)),g=i.left,h=o0(d,g);if(h&&r(h.node)){let b=Math.abs(g-h.left),y=Math.abs(g-h.right);return us(t,e,h.node,b<y,!1)}let p;if(s(a)?p=a.getNode():o(a)?p=a.getNode(!0):p=Ui(n),p){let b=V2(t,c,l0(1),p),y=o0(se(b,sm(1)),g);if(y||(y=Ws(se(b,sm(0))),y))return om(e,y.position.toRange(),!1)}return d.length===0?rm(e,l).filter(l?o:s).map(b=>qd(e,b.toRange(),!1)):m.none()},rm=(e,t)=>{let n=e.selection.getRng(),s=t?N.fromRangeEnd(n):N.fromRangeStart(n),o=SB(s.container(),e.getBody());if(t){let r=za(o,s);return ps(r.positions)}else{let r=Ua(o,s);return xt(r.positions)}},f0=(e,t,n)=>rm(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),Ml=(e,t)=>{let n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},d0=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},m0=(e,t,n)=>Jd(t,n).map(s=>(Ml(e,s),n)),j2=(e,t,n)=>{let s=N.fromRangeStart(e);if(e.collapsed)return s;{let o=N.fromRangeEnd(e);return n?Ot(t,o).getOr(o):Rt(t,s).getOr(s)}},q2=(e,t,n)=>{let s=e.getBody(),o=j2(e.selection.getRng(),s,n),r=G(go,e);return x2(n,r,s,o).bind(i=>m0(e,t,i))},K2=(e,t,n)=>{let s=be(mt(C.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=se(s,e),r=se(n,e);D(ci(o,r),G(d0,!1)),D(ci(r,o),G(d0,!0))},G2=(e,t)=>{let n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){let s=N.fromRangeStart(e.selection.getRng());N.isTextPosition(s)&&!_I(s)&&(Ml(e,uB(n,s)),t.set(null))}},Y2=(e,t,n,s)=>{if(t.selection.isCollapsed()){let o=se(s,e);D(o,r=>{let a=N.fromRangeStart(t.selection.getRng());Kn(e,t.getBody(),a).bind(i=>m0(t,n,i))})}},g0=(e,t,n)=>fa(e)?q2(e,t,n).isSome():!1,p0=(e,t,n)=>fa(t)?R2(e,t):!1,X2=e=>{let t=nt(null),n=G(go,e);return e.on("NodeChange",s=>{fa(e)&&(K2(n,e.dom,s.parents),G2(e,t),Y2(n,e,t,s.parents))}),t},Z2=G(p0,!0),Q2=G(p0,!1),Ul=(e,t,n)=>{if(fa(e)){let s=rm(e,t).getOrThunk(()=>{let o=e.selection.getRng();return t?N.fromRangeEnd(o):N.fromRangeStart(o)});return Kn(G(go,e),e.getBody(),s).exists(o=>{let r=Fl(o);return Jd(n,r).exists(a=>(Ml(e,a),!0))})}else return!1},J2=(e,t)=>{let n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},eW=e=>ct(ht(e),un(e),(t,n)=>{let s=nn(!0,t),o=nn(!1,n);return Rt(e,s).forall(r=>r.isEqual(o))}).getOr(!0),h0=(e,t)=>n=>Jd(t,n).map(s=>()=>Ml(e,s)),b0=(e,t,n,s)=>{let o=e.getBody(),r=G(go,e);e.undoManager.ignore(()=>{e.selection.setRng(J2(n,s)),pl(e),Kn(r,o,N.fromRangeStart(e.selection.getRng())).map(tm).bind(h0(e,t)).each(kr)}),e.nodeChanged()},tW=(e,t)=>{let n=Ns(t,e);return n||e},nW=(e,t,n,s)=>{let o=tW(e.getBody(),s.container()),r=G(go,e),a=Kn(r,o,s);return a.bind(l=>n?l.fold(W(m.some(tm(l))),m.none,W(m.some(Fl(l))),m.none):l.fold(m.none,W(m.some(Fl(l))),m.none,W(m.some(tm(l))))).map(h0(e,t)).getOrThunk(()=>{let l=Zo(n,o,s),c=l.bind(u=>Kn(r,o,u));return ct(a,c,()=>Os(r,o,s).bind(u=>eW(u)?m.some(()=>{mo(e,n,C.fromDom(u))}):m.none())).getOrThunk(()=>c.bind(()=>l.map(u=>()=>{n?b0(e,t,s,u):b0(e,t,u,s)})))})},am=(e,t,n)=>{if(e.selection.isCollapsed()&&fa(e)){let s=N.fromRangeStart(e.selection.getRng());return nW(e,t,n,s)}return m.none()},sW=e=>Wc(e)>1,C0=(e,t)=>{let n=C.fromDom(e.getBody()),s=C.fromDom(e.selection.getStart()),o=ls(s,n);return Ar(o,t).fold(W(o),r=>o.slice(0,r))},oW=e=>Wc(e)===1,rW=e=>C0(e,t=>e.schema.isBlock(Ce(t))||sW(t)),aW=e=>C0(e,t=>e.schema.isBlock(Ce(t))),y0=(e,t)=>{let n=G(vv,e);return Yt(t,s=>n(s)?[s.dom]:[])},v0=e=>{let t=aW(e);return y0(e,t)},iW=(e,t,n,s)=>{let o=y0(t,s);if(o.length===0)mo(t,e,n);else{let r=yv(n.dom,o);t.selection.setRng(r.toRange())}},lW=(e,t)=>{let n=se(rW(e),oW);return ps(n).bind(s=>{let o=N.fromRangeStart(e.selection.getRng());return Vy(t,o,s.dom)&&!vf(s)?m.some(()=>iW(t,e,s,n)):m.none()})},cW=(e,t)=>{let n=t.parentElement;return Le(t)&&!yt(n)&&e.dom.isEmpty(n)},uW=e=>vf(C.fromDom(e)),E0=(e,t)=>{let n=e.selection.getStart(),s=cW(e,n)||uW(n)?yv(n,t):bL(e.selection.getRng(),t);e.selection.setRng(s.toRange())},fW=(e,t)=>{let n=ci(t,v0(e));n.length>0&&E0(e,n)},S0=e=>F(e.startContainer),dW=e=>e.startOffset===0&&S0(e),mW=(e,t)=>{let n=t.startContainer.parentElement;return!yt(n)&&vv(e,C.fromDom(n))},gW=e=>{let t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!yt(t)&&!yt(n)&&t.isEqualNode(n)},pW=e=>{let t=e.endContainer;return e.endOffset===(F(t)?t.length:t.childNodes.length)},hW=e=>gW(e)&&pW(e),bW=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),CW=e=>hW(e)||bW(e),yW=e=>{let t=e.selection.getRng();return dW(t)&&mW(e,t)&&CW(t)},vW=e=>{if(yW(e)){let t=v0(e);return m.some(()=>{pl(e),fW(e,t)})}else return m.none()},im=(e,t)=>e.selection.isCollapsed()?lW(e,t):vW(e),EW=(e,t)=>Fp(e,n=>Qt(n.dom),n=>t.isBlock(Ce(n))),SW=e=>EW(C.fromDom(e.selection.getStart()),e.schema),wW=e=>{let t=e.selection.getRng();return t.collapsed&&(S0(t)||e.dom.isEmpty(t.startContainer))&&!SW(e)},Ha=e=>(wW(e)&&E0(e,[]),!0),lm=(e,t,n)=>U(n)?m.some(()=>{e._selectionOverrides.hideFakeCaret(),mo(e,t,C.fromDom(n))}):m.none(),kW=(e,t)=>{let n=t?wa:ka,o=ba(t?1:-1,e.getBody(),e.selection.getRng());return n(o)?lm(e,t,o.getNode(!t)):m.from(nn(t,o)).filter(r=>n(r)&&Xi(o,r)).bind(r=>lm(e,t,r.getNode(!t)))},_W=(e,t)=>{let n=e.selection.getNode();return Un(n)?lm(e,t,n):m.none()},cm=(e,t)=>e.selection.isCollapsed()?kW(e,t):_W(e,t),AW=e=>vs(e,t=>cn(t.dom)||Re(t.dom)).exists(t=>cn(t.dom)),um=e=>mi(e??"").getOr(0),w0=(e,t)=>{let n=e||dT(t)?"margin":"padding",s=Ln(t,"direction")==="rtl"?"-right":"-left";return n+s},xW=(e,t,n,s,o,r)=>{let a=w0(n,C.fromDom(r)),i=um(e.getStyle(r,a));if(t==="outdent"){let l=Math.max(0,i-s);e.setStyle(r,a,l?l+o:"")}else{let l=i+s+o;e.setStyle(r,a,l)}},NW=(e,t)=>Qn(t,n=>{let s=w0(wb(e),n),o=Ei(n,s).map(um).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),k0=e=>{let t=A0(e);return!e.mode.isReadOnly()&&(t.length>1||NW(e,t))},_0=e=>Pu(e)||Wo(e),RW=e=>Fn(e).exists(_0),A0=e=>se(Gc(e.selection.getSelectedBlocks()),t=>!_0(t)&&!RW(t)&&AW(t)),x0=(e,t)=>{var n,s;if(e.mode.isReadOnly())return;let{dom:o}=e,r=JD(e),a=(s=(n=/[a-z%]+$/i.exec(r))===null||n===void 0?void 0:n[0])!==null&&s!==void 0?s:"px",i=um(r),l=wb(e);D(A0(e),c=>{xW(o,t,l,i,a,c.dom)})},TW=e=>x0(e,"indent"),N0=e=>x0(e,"outdent"),R0=e=>{if(e.selection.isCollapsed()&&k0(e)){let t=e.dom,n=e.selection.getRng(),s=N.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&Lf(C.fromDom(o),s,e.schema))return m.some(()=>N0(e))}return m.none()},T0=(e,t,n)=>Ao([R0,Xd,Kd,(s,o)=>am(s,t,o),Vd,Zf,Qd,cm,jd,im,Zd],s=>s(e,n)).filter(s=>e.selection.isEditable()),DW=(e,t)=>{T0(e,t,!1).fold(()=>{e.selection.isEditable()&&(pl(e),Wf(e))},kr)},PW=(e,t)=>{T0(e,t,!0).fold(()=>{e.selection.isEditable()&&Wy(e)},kr)},BW=(e,t)=>{e.addCommand("delete",()=>{DW(e,t)}),e.addCommand("forwardDelete",()=>{PW(e,t)})},D0=5,OW=400,P0=e=>e.touches===void 0||e.touches.length!==1?m.none():m.some(e.touches[0]),IW=(e,t)=>{let n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>D0||s>D0},FW=e=>{let t=Jn(),n=nt(!1),s=Bc(o=>{e.dispatch("longpress",we(Q({},o),{type:"longpress"})),n.set(!0)},OW);e.on("touchstart",o=>{P0(o).each(r=>{s.cancel();let a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),P0(o).each(r=>{t.on(a=>{IW(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",we(Q({},o),{type:"tap"}))})},!0)},fm=(e,t)=>oe(e,t.nodeName),LW=(e,t)=>F(t)?!0:q(t)?!fm(e.getBlockElements(),t)&&!Jt(t)&&!Xs(e,t)&&!du(t):!1,$W=(e,t,n)=>Ie(yy(C.fromDom(n),C.fromDom(t)),s=>fm(e,s.dom)),MW=(e,t)=>{if(F(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data))return!t.nextSibling||fm(e,t.nextSibling)||du(t.nextSibling)}return!1},dm=e=>e.dom.create(pt(e),ua(e)),UW=e=>{let t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements(),r=n.getStart(),a=e.getBody(),i,l,c=null,u=pt(e);if(!r||!q(r))return;let f=a.nodeName.toLowerCase();if(!s.isValidChild(f,u.toLowerCase())||$W(o,a,r))return;if(a.firstChild===a.lastChild&&Le(a.firstChild)){i=dm(e),i.appendChild(Vo().dom),a.replaceChild(i,a.firstChild),e.selection.setCursorLocation(i,0),e.nodeChanged();return}let d=a.firstChild;for(;d;)if(q(d)&&oR(s,d),LW(s,d)){if(MW(o,d)){l=d,d=d.nextSibling,t.remove(l);continue}if(!i){if(!c&&e.hasFocus()&&(c=LS(e.selection.getRng(),()=>document.createElement("span"))),!d.parentNode){d=null;break}i=dm(e),a.insertBefore(i,d)}l=d,d=d.nextSibling,i.appendChild(l)}else i=null,d=d.nextSibling;c&&(e.selection.setRng($S(c)),e.nodeChanged())},B0=(e,t,n)=>{let s=C.fromDom(dm(e)),o=Vo();Ke(s,o),n(t,s);let r=document.createRange();return r.setStartBefore(o.dom),r.setEndBefore(o.dom),r},zW=e=>{e.on("NodeChange",()=>UW(e))},O0=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,HW=(e,t,n)=>function(s){let o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){let i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},WW=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],HW(e,o,Db(e)));n.content=o}},VW=(e,t)=>Qn(e,n=>{let s=t.match(n);return s!==null&&s[0].length===t.length}),jW=e=>{let t="contenteditable",n=" "+L.trim(VP(e))+" ",s=" "+L.trim(Db(e))+" ",o=O0(n),r=O0(s),a=jP(e);a.length>0&&e.on("BeforeSetContent",i=>{WW(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let l=i.length;for(;l--;){let c=i[l];o(c)?c.attr(t,"true"):r(c)&&c.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let l=i.length;for(;l--;){let c=i[l];if(!o(c)&&!r(c))continue;let u=c.attr("data-mce-content");a.length>0&&u?VW(a,u)?(c.name="#text",c.type=3,c.raw=!0,c.value=u):c.remove():c.attr(t,null)}})},qW=e=>wi(C.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),I0=(e,t)=>{t.hasAttribute("data-mce-caret")&&(Iu(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},KW=(e,t)=>{let n=qW(e);if(n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),I0(e,n);return}Ph(n)&&(I0(e,n),e.undoManager.add())}},GW=e=>{e.on("keyup compositionstart",G(KW,e))},F0=Re,YW=(e,t,n)=>c0(t,e,n,Ps,Bs,F0),XW=(e,t,n)=>u0(t,e,n,r=>Ps(r)||Cy(r),r=>Bs(r)||If(r),F0),ZW=e=>{let t=e.dom.create(pt(e));return t.innerHTML='<br data-mce-bogus="1">',t},L0=(e,t,n)=>{let s=Wn(e.getBody()),o=G(tf,t===1?s.next:s.prev);if(n.collapsed){let r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(N.fromRangeStart(n))){let i=C.fromDom(ZW(e));t===1?ts(C.fromDom(r),i):Bt(C.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},QW=(e,t)=>{let n=t?1:-1,s=e.selection.getRng();return YW(n,e,s).orThunk(()=>(L0(e,n,s),m.none()))},JW=(e,t)=>{let n=t?1:-1,s=e.selection.getRng();return XW(n,e,s).orThunk(()=>(L0(e,n,s),m.none()))},eV=(e,t)=>{let n=t?e.getEnd(!0):e.getStart(!0);return My(n)?!t:t},$0=(e,t)=>QW(e,eV(e.selection,t)).exists(n=>(ds(e,n),!0)),M0=(e,t)=>JW(e,t).exists(n=>(ds(e,n),!0)),U0=(e,t)=>f0(e,t,t?Bs:Ps),zl=(e,t)=>Gd(e,!t).map(n=>{let s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(ds(e,n),!0)),tV=e=>ke(["figcaption"],Ce(e)),nV=(e,t,n)=>{let s=G(Se,t);return vs(C.fromDom(e.container()),o=>n.isBlock(Ce(o)),s).filter(tV)},sV=(e,t,n)=>t?t0(e.dom,n):e0(e.dom,n),oV=(e,t)=>{let n=C.fromDom(e.getBody()),s=N.fromRangeStart(e.selection.getRng());return nV(s,n,e.schema).exists(()=>{if(sV(n,t,s)){let r=B0(e,n,t?Ke:Kc);return e.selection.setRng(r),!0}else return!1})},z0=(e,t)=>e.selection.isCollapsed()?oV(e,t):!1,rV=(e,t,n)=>{let s=e.selection.getRng(),o=N.fromRangeStart(s);return e.getBody().firstChild===t&&e0(n,o)?(e.execCommand("InsertNewBlockBefore"),!0):!1},aV=(e,t)=>{let n=e.selection.getRng(),s=N.fromRangeStart(n);return e.getBody().lastChild===t&&t0(t,s)?(e.execCommand("InsertNewBlockAfter"),!0):!1},iV=(e,t)=>t?m.from(e.dom.getParent(e.selection.getNode(),"details")).map(n=>aV(e,n)).getOr(!1):m.from(e.dom.getParent(e.selection.getNode(),"summary")).bind(n=>m.from(e.dom.getParent(n,"details")).map(s=>rV(e,s,n))).getOr(!1),H0=(e,t)=>iV(e,t),W0={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},lV=e=>be(e,t=>Q(Q({},W0),t)),cV=e=>be(e,t=>Q(Q({},W0),t)),V0=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,uV=(e,t)=>Yt(lV(e),n=>V0(n,t)?[n]:[]),fV=(e,t)=>Yt(cV(e),n=>V0(n,t)?[n]:[]),ne=(e,...t)=>()=>e.apply(null,t),Wa=(e,t)=>Ze(uV(e,t),n=>n.action()),j0=(e,t)=>Ao(fV(e,t),n=>n.action()),q0=(e,t)=>{let n=t?1:-1,s=e.selection.getRng();return c0(e,n,s,wa,ka,Un).exists(o=>(ds(e,o),!0))},K0=(e,t)=>{let n=t?1:-1,s=e.selection.getRng();return u0(e,n,s,wa,ka,Un).exists(o=>(ds(e,o),!0))},G0=(e,t)=>f0(e,t,t?ka:wa),dV=(e,t)=>Y0(e,t,He),Y0=(e,t,n)=>Yt(dt(e),s=>Cn(s,t)?n(s)?[s]:[]:Y0(s,t,n)),mV=(e,t,n=Oe)=>{if(n(t))return m.none();if(ke(e,Ce(t)))return m.some(t);let s=o=>Cn(o,"table")||n(o);return qr(t,e.join(","),s)},gV=(e,t)=>mV(["td","th"],e,t),pV=e=>dV(e,"th,td"),X0=(e,t)=>Io(e,"table",t),Z0=Dn.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),hV=e=>Z0.none(e),Va=we(Q({},Z0),{none:hV}),mm=(e,t,n,s,o=He)=>{let r=s===1;if(!r&&n<=0)return Va.first(e[0]);if(r&&n>=e.length-1)return Va.last(e[e.length-1]);{let a=n+s,i=e[a];return o(i)?Va.middle(t,i):mm(e,t,a,s,o)}},Q0=(e,t)=>X0(e,t).bind(n=>{let s=pV(n);return Ar(s,r=>Se(e,r)).map(r=>({index:r,all:s}))}),bV=(e,t,n)=>Q0(e,n).fold(()=>Va.none(e),o=>mm(o.all,e,o.index,1,t)),CV=(e,t,n)=>Q0(e,n).fold(()=>Va.none(),o=>mm(o.all,e,o.index,-1,t)),J0=Tr("image"),yV=e=>{let t=e;return m.from(t[J0])},vV=(e,t)=>{let n=e;n[J0]=t},gm=Tr("event"),EV=e=>{let t=e;return m.from(t[gm])},Hl=e=>t=>{let n=t;n[gm]=e},SV=(e,t)=>Hl(t)(e),ew=Hl(0),wV=Hl(2),kV=Hl(1),_V=(e=>t=>{let n=t;return m.from(n[gm]).exists(s=>s===e)})(0),AV=()=>Object.freeze({length:0,item:e=>null}),pm=Tr("mode"),xV=e=>{let t=e;return m.from(t[pm])},Wl=e=>t=>{let n=t;n[pm]=e},tw=(e,t)=>Wl(t)(e),nw=Wl(0),hm=Wl(2),NV=Wl(1),sw=e=>t=>{let n=t;return m.from(n[pm]).exists(s=>s===e)},fr=sw(0),ow=sw(1),RV=(e,t)=>we(Q({},t),{get length(){return t.length},add:(n,s)=>{if(fr(e))if(ee(n)){if(!rt(s))return t.add(n,s)}else return t.add(n);return null},remove:n=>{fr(e)&&t.remove(n)},clear:()=>{fr(e)&&t.clear()}}),TV=["none","copy","link","move"],DV=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],bm=()=>{let e=new window.DataTransfer,t="move",n="all",s={get dropEffect(){return t},set dropEffect(o){ke(TV,o)&&(t=o)},get effectAllowed(){return n},set effectAllowed(o){_V(s)&&ke(DV,o)&&(n=o)},get items(){return RV(s,e.items)},get files(){return ow(s)?AV():e.files},get types(){return e.types},setDragImage:(o,r,a)=>{fr(s)&&(vV(s,{image:o,x:r,y:a}),e.setDragImage(o,r,a))},getData:o=>ow(s)?"":e.getData(o),setData:(o,r)=>{fr(s)&&e.setData(o,r)},clearData:o=>{fr(s)&&e.clearData(o)}};return nw(s),s},PV=e=>{let t=bm(),n=xV(e);return hm(e),ew(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,yV(e).each(s=>t.setDragImage(s.image,s.x,s.y)),D(e.types,s=>{s!=="Files"&&t.setData(s,e.getData(s))}),D(e.files,s=>t.items.add(s)),EV(e).each(s=>{SV(t,s)}),n.each(s=>{tw(e,s),tw(t,s)}),t},BV=e=>{let t=e.getData("text/html");return t===""?m.none():m.some(t)},rw=(e,t)=>e.setData("text/html",t),OV=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),IV=(e,t)=>Yt(t,n=>{let s=OV(so(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),FV=(e,t,n)=>Pt(e,(s,o)=>s.fold(()=>m.some(o),r=>{let a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return m.some(i<a?o:r)}),m.none()),aw=(e,t,n,s,o)=>{let r=mt(C.fromDom(n),"td,th,caption").map(i=>i.dom),a=se(IV(e,r),i=>t(i,o));return FV(a,s,o).map(i=>i.cell)},LV=e=>e.bottom,$V=e=>e.top,MV=(e,t)=>e.y<t,UV=(e,t)=>e.y>t,zV=G(aw,LV,MV),HV=G(aw,$V,UV),WV=(e,t)=>xt(t.getClientRects()).bind(n=>zV(e,n.left,n.top)).bind(n=>$l(B2(n),t)),VV=(e,t)=>ps(t.getClientRects()).bind(n=>HV(e,n.left,n.top)).bind(n=>$l(P2(n),t)),jV=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),qV=e=>e.breakType===fs.Wrap&&e.positions.length===0,KV=e=>e.breakType===fs.Br&&e.positions.length===1,iw=(e,t,n)=>{let s=e(t,n);return qV(s)||!Le(n.getNode())&&KV(s)?!jV(e,t,s):s.breakAt.isNone()},GV=G(iw,Ua),YV=G(iw,za),XV=(e,t,n)=>{let s=N.fromRangeStart(t);return Qo(!e,n).exists(o=>o.isEqual(s))},ZV=(e,t,n,s)=>{let o=e.selection.getRng(),r=t?1:-1;return zb()&&XV(t,o,n)?(us(r,e,n,!t,!1).each(a=>{ds(e,a)}),!0):!1},QV=(e,t,n)=>WV(t,n).orThunk(()=>xt(n.getClientRects()).bind(s=>nm(QS(e,N.before(t)),s.left))).getOr(N.before(t)),JV=(e,t,n)=>VV(t,n).orThunk(()=>xt(n.getClientRects()).bind(s=>nm(JS(e,N.after(t)),s.left))).getOr(N.after(t)),lw=(e,t)=>{let n=t.getNode(e);return Mn(n)?m.some(n):m.none()},e3=(e,t,n)=>{t.undoManager.transact(()=>{let s=e?ts:Bt,o=B0(t,C.fromDom(n),s);ds(t,o)})},cw=(e,t,n)=>{let s=lw(!!t,n),o=t===!1;s.fold(()=>ds(e,n.toRange()),r=>Qo(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>ds(e,n.toRange()),a=>e3(t,e,r)))},t3=(e,t,n,s)=>{let o=e.selection.getRng(),r=N.fromRangeStart(o),a=e.getBody();if(!t&&GV(s,r)){let i=QV(a,n,r);return cw(e,t,i),!0}else if(t&&YV(s,r)){let i=JV(a,n,r);return cw(e,t,i),!0}else return!1},uw=(e,t,n)=>m.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>m.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),fw=(e,t)=>uw(e,t,ZV),Cm=(e,t)=>uw(e,t,t3),n3=e=>{let t=Lo.exact(e,0,e,0);return RN(t)},dw=(e,t,n)=>n.fold(m.none,m.none,(s,o)=>uN(o).map(r=>n3(r)),s=>e.mode.isReadOnly()||!s3(s)?m.none():(e.execCommand("mceTableInsertRowAfter"),mw(e,t,s))),s3=e=>vs(e,Mr("table")).exists(Es),mw=(e,t,n)=>dw(e,t,bV(n,gw)),o3=(e,t,n)=>dw(e,t,CV(n,gw)),gw=e=>Es(e)||su(e,r3),r3=e=>$r(e)&&Es(e),pw=(e,t)=>{let n=["table","li","dl"],s=C.fromDom(e.getBody()),o=i=>{let l=Ce(i);return Se(i,s)||ke(n,l)},r=e.selection.getRng(),a=C.fromDom(t?r.endContainer:r.startContainer);return gV(a,o).map(i=>(X0(i,o).each(u=>{e.model.table.clearSelectedCells(u.dom)}),e.selection.collapse(!t),(t?mw:o3)(e,o,i).each(u=>{e.selection.setRng(u)}),!0)).getOr(!1)},a3=(e,t,n)=>{let s=ye.os.isMacOS()||ye.os.isiOS();Wa([{keyCode:j.RIGHT,action:ne($0,e,!0)},{keyCode:j.LEFT,action:ne($0,e,!1)},{keyCode:j.UP,action:ne(M0,e,!1)},{keyCode:j.DOWN,action:ne(M0,e,!0)},...s?[{keyCode:j.UP,action:ne(zl,e,!1),metaKey:!0,shiftKey:!0},{keyCode:j.DOWN,action:ne(zl,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:j.RIGHT,action:ne(fw,e,!0)},{keyCode:j.LEFT,action:ne(fw,e,!1)},{keyCode:j.UP,action:ne(Cm,e,!1)},{keyCode:j.DOWN,action:ne(Cm,e,!0)},{keyCode:j.UP,action:ne(Cm,e,!1)},{keyCode:j.UP,action:ne(H0,e,!1)},{keyCode:j.DOWN,action:ne(H0,e,!0)},{keyCode:j.RIGHT,action:ne(q0,e,!0)},{keyCode:j.LEFT,action:ne(q0,e,!1)},{keyCode:j.UP,action:ne(K0,e,!1)},{keyCode:j.DOWN,action:ne(K0,e,!0)},{keyCode:j.RIGHT,action:ne(g0,e,t,!0)},{keyCode:j.LEFT,action:ne(g0,e,t,!1)},{keyCode:j.RIGHT,ctrlKey:!s,altKey:s,action:ne(Z2,e,t)},{keyCode:j.LEFT,ctrlKey:!s,altKey:s,action:ne(Q2,e,t)},{keyCode:j.UP,action:ne(z0,e,!1)},{keyCode:j.DOWN,action:ne(z0,e,!0)}],n).each(o=>{n.preventDefault()})},i3=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||a3(e,t,n)})},An=(e,t)=>({container:e,offset:t}),Vl=xe.DOM,jl=e=>t=>e===t?-1:0,l3=e=>t=>e.isBlock(t)||ke(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",ym=(e,t,n)=>{if(F(e)&&t>=0)return m.some(An(e,t));{let s=to(Vl);return m.from(s.backwards(e,t,jl(e),n)).map(o=>An(o.container,o.container.data.length))}},c3=(e,t,n)=>{if(F(e)&&t>=e.length)return m.some(An(e,t));{let s=to(Vl);return m.from(s.forwards(e,t,jl(e),n)).map(o=>An(o.container,0))}},vm=(e,t,n)=>{if(!F(e))return m.none();let s=e.data;if(t>=0&&t<=s.length)return m.some(An(e,t));{let o=to(Vl);return m.from(o.backwards(e,t,jl(e),n)).bind(r=>{let a=r.container.data;return vm(r.container,t+a.length,n)})}},hw=(e,t,n)=>{if(!F(e))return m.none();let s=e.data;if(t<=s.length)return m.some(An(e,t));{let o=to(Vl);return m.from(o.forwards(e,t,jl(e),n)).bind(r=>hw(r.container,t-s.length,n))}},Em=(e,t,n,s,o)=>{let r=to(e,l3(e));return m.from(r.backwards(t,n,s,o))},u3=e=>e.collapsed&&F(e.startContainer),f3=e=>Vt(e.toString().replace(/\u00A0/g," ")),bw=e=>e!==""&&` \xA0\uFEFF\f
\r	\v`.indexOf(e)!==-1,d3=(e,t)=>e.substring(t.length),m3=(e,t,n,s=!1)=>{let o,r=n.charAt(0);for(o=t-1;o>=0;o--){let a=e.charAt(o);if(!s&&bw(a))return m.none();if(r===a&&ft(e,n,o,t))break}return m.some(o)},Sm=(e,t,n,s=!1)=>{if(!u3(t))return m.none();let o={text:"",offset:0},r=(i,l,c)=>(o.text=c+o.text,o.offset+=l,m3(o.text,o.offset,n,s).getOr(l)),a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return Em(e,t.startContainer,t.startOffset,r,a).bind(i=>{let l=t.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(t.endContainer,t.endOffset),l.collapsed)return m.none();let c=f3(l);return c.lastIndexOf(n)!==0?m.none():m.some({text:d3(c,n),range:l,trigger:n})})},g3=e=>e.nodeType===op,p3=e=>e.nodeType===Lr,Cw=e=>{if(g3(e))return An(e,e.data.length);{let t=e.childNodes;return t.length>0?Cw(t[t.length-1]):An(e,t.length)}},yw=(e,t)=>{let n=e.childNodes;return n.length>0&&t<n.length?yw(n[t],0):n.length>0&&p3(e)&&n.length===t?Cw(n[n.length-1]):An(e,t)},h3=(e,t)=>{var n;let s=(n=e.getParent(t.container,e.isBlock))!==null&&n!==void 0?n:e.getRoot();return Em(e,t.container,t.offset,(o,r)=>r===0?-1:r,s).filter(o=>{let r=o.container.data.charAt(o.offset-1);return!bw(r)}).isSome()},b3=e=>t=>{let n=yw(t.startContainer,t.startOffset);return!h3(e,n)},C3=(e,t,n)=>Ao(n.triggers,s=>Sm(e,t,s)),y3=(e,t)=>{let n=t(),s=e.selection.getRng();return C3(e.dom,s,n).bind(o=>vw(e,t,o))},vw=(e,t,n,s={})=>{var o;let r=t(),i=(o=e.selection.getRng().startContainer.nodeValue)!==null&&o!==void 0?o:"",l=se(r.lookupByTrigger(n.trigger),u=>n.text.length>=u.minChars&&u.matches.getOrThunk(()=>b3(e.dom))(n.range,i,n.text));if(l.length===0)return m.none();let c=Promise.all(be(l,u=>u.fetch(n.text,u.maxResults,s).then(d=>({matchText:n.text,items:d,columns:u.columns,onAction:u.onAction,highlightOn:u.highlightOn}))));return m.some({lookupData:c,context:n})};var Gn=function(e){return e[e.Error=0]="Error",e[e.Value=1]="Value",e}(Gn||{});let wm=(e,t,n)=>e.stype===Gn.Error?t(e.serror):n(e.svalue),v3=e=>{let t=[],n=[];return D(e,s=>{wm(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},E3=(e,t)=>e.stype===Gn.Error?{stype:Gn.Error,serror:t(e.serror)}:e,S3=(e,t)=>e.stype===Gn.Value?{stype:Gn.Value,svalue:t(e.svalue)}:e,w3=(e,t)=>e.stype===Gn.Value?t(e.svalue):e,k3=(e,t)=>e.stype===Gn.Error?t(e.serror):e,Ew=e=>({stype:Gn.Value,svalue:e}),Sw=e=>({stype:Gn.Error,serror:e}),lt={fromResult:e=>e.fold(Sw,Ew),toResult:e=>wm(e,zt.error,zt.value),svalue:Ew,partition:v3,serror:Sw,bind:w3,bindError:k3,map:S3,mapError:E3,fold:wm},ww=e=>ot(e)&&Ut(e).length>100?" removed due to size":JSON.stringify(e,null,2),_3=e=>{let t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:W("... (only showing first ten failures)")}]):e;return be(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},kw=(e,t)=>lt.serror([{path:e,getErrorInfo:t}]),A3=(e,t,n)=>kw(e,()=>'Could not find valid *required* value for "'+t+'" in '+ww(n)),x3=(e,t)=>kw(e,W(t)),km=e=>{let t=(s,o)=>lt.bindError(e(o),r=>x3(s,r)),n=W("val");return{extract:t,toString:n}},N3=km(lt.svalue),R3=W(N3),ql=(e,t)=>km(n=>{let s=typeof n;return e(n)?lt.svalue(n):lt.serror(`Expected type: ${t} but got: ${s}`)}),T3=ql(ln,"number"),Kl=ql(ee,"string"),D3=ql(Rn,"boolean"),_m=ql(_e,"function"),_w=e=>{if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>_w(e[t]));default:return!1}};km(e=>_w(e)?lt.svalue(e):lt.serror("Expected value to be acceptable for sending via postMessage"));let P3=()=>({tag:"required",process:{}}),B3=e=>({tag:"defaultedThunk",process:e}),Aw=e=>B3(W(e)),O3=()=>({tag:"option",process:{}}),I3=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),xw=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},F3=(e,t)=>e.length>0?lt.svalue(di(t,Sg.apply(void 0,e))):lt.svalue(t),Nw=e=>Tn(lt.serror,gg)(e),L3={consolidateObj:(e,t)=>{let n=lt.partition(e);return n.errors.length>0?Nw(n.errors):F3(n.values,t)},consolidateArr:e=>{let t=lt.partition(e);return t.errors.length>0?Nw(t.errors):lt.svalue(t.values)}},$3=(e,t,n,s)=>Fe(t,n).fold(()=>A3(e,n,t),s),Rw=(e,t,n,s)=>{let o=Fe(e,t).getOrThunk(()=>n(e));return s(o)},M3=(e,t,n)=>n(Fe(e,t)),U3=(e,t,n,s)=>{let o=Fe(e,t).map(r=>r===!0?n(e):r);return s(o)},z3=(e,t,n,s,o)=>{let r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>lt.svalue(m.none()),l=>{let c=o.extract(t.concat([s]),l);return lt.map(c,m.some)});switch(e.tag){case"required":return $3(t,n,s,r);case"defaultedThunk":return Rw(n,s,e.process,r);case"option":return M3(n,s,a);case"defaultedOptionThunk":return U3(n,s,e.process,a);case"mergeWithThunk":return Rw(n,s,W({}),i=>{let l=di(e.process(n),i);return r(l)})}},H3=(e,t,n)=>{let s={},o=[];for(let r of n)xw(r,(a,i,l,c)=>{let u=z3(l,e,t,a,c);lt.fold(u,f=>{o.push(...f)},f=>{s[i]=f})},(a,i)=>{s[a]=i(t)});return o.length>0?lt.serror(o):lt.svalue(s)},Tw=e=>({extract:(s,o)=>H3(s,o,e),toString:()=>`obj{
`+be(e,o=>xw(o,(r,a,i,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),W3=e=>({extract:(s,o)=>{let r=be(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return L3.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),V3=(e,t,n)=>{let s=t.extract([e],n);return lt.mapError(s,o=>({input:n,errors:o}))},j3=(e,t,n)=>lt.toResult(V3(e,t,n)),q3=e=>`Errors: 
`+_3(e.errors).join(`
`)+`

Input object: `+ww(e.input),Gl=I3,Dw=(e,t)=>Gl(e,e,P3(),t),ms=e=>Dw(e,Kl),Yl=e=>Dw(e,_m),Pw=(e,t)=>Gl(e,e,O3(),t),Is=e=>Pw(e,Kl),Bw=e=>Pw(e,_m),Ow=(e,t)=>Gl(e,e,Aw(t),R3()),ja=(e,t,n)=>Gl(e,e,Aw(t),n),Iw=(e,t)=>ja(e,t,T3),K3=(e,t)=>ja(e,t,Kl),Xl=(e,t)=>ja(e,t,D3),Fw=(e,t)=>ja(e,t,_m),G3=(e,t,n)=>ja(e,t,W3(n)),Y3=ms("type");ms("name"),ms("label"),ms("text"),ms("title"),ms("icon"),ms("url");let X3=ms("value"),Z3=Yl("fetch");Yl("getSubmenuItems");let Q3=Yl("onAction");Yl("onItemAction"),Fw("onSetup",()=>ce),Is("name");let J3=Is("text");Is("role");let e8=Is("icon");Is("url"),Is("tooltip"),Is("label"),Is("shortcut"),Bw("select");let t8=Xl("active",!1);Xl("borderless",!1);let n8=Xl("enabled",!0);Xl("primary",!1);let s8=e=>Ow("columns",e),o8=Ow("meta",{});Fw("onAction",ce),Tw([(e=>K3("type",e))("autocompleteitem"),t8,n8,o8,X3,J3,e8]);let r8=Tw([Y3,ms("trigger"),Iw("minChars",1),s8(1),Iw("maxResults",10),Bw("matches"),Z3,Q3,G3("highlightOn",[],Kl)]),a8=e=>j3("Autocompleter",r8,e),i8=()=>{let e={},t={},n={},s={},o={},r={},a={},i={},l={},c=(g,h)=>(p,b)=>{g[p.toLowerCase()]=we(Q({},b),{type:h})},u=(g,h)=>(p,b)=>{g[p.toLowerCase()]=Q({type:h},b)},f=(g,h)=>s[g.toLowerCase()]=h,d=(g,h)=>a[g.toLowerCase()]=h;return{addButton:c(e,"button"),addGroupToolbarButton:c(e,"grouptoolbarbutton"),addToggleButton:c(e,"togglebutton"),addMenuButton:c(e,"menubutton"),addSplitButton:c(e,"splitbutton"),addMenuItem:c(t,"menuitem"),addNestedMenuItem:c(t,"nestedmenuitem"),addToggleMenuItem:c(t,"togglemenuitem"),addAutocompleter:c(n,"autocompleter"),addContextMenu:c(o,"contextmenu"),addContextToolbar:c(r,"contexttoolbar"),addContextForm:u(r,"contextform"),addSidebar:c(i,"sidebar"),addView:c(l,"views"),addIcon:f,addContext:d,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:i,views:l,contexts:a})}},l8=e=>{let t=e.ui.registry.getAll().popups,n=ui(t,a=>a8(a).fold(i=>{throw new Error(q3(i))},$t)),s=Ng(fi(n,a=>a.trigger)),o=Tc(n);return{dataset:n,triggers:s,lookupByTrigger:a=>se(o,i=>i.trigger===a)}},c8=(e,t)=>{let n=Bc(t.load,50);e.on("input",s=>{s.inputType==="insertCompositionText"&&!e.composing||n.throttle()}),e.on("keydown",s=>{let o=s.which;o===8?n.throttle():o===27?(n.cancel(),t.cancelIfNecessary()):(o===38||o===40)&&n.cancel()},!0),e.on("remove",n.cancel)},u8=e=>{let t=Jn(),n=nt(!1),s=t.isSet,o=()=>{s()&&(AD(e),n.set(!1),t.clear())},r=f=>{s()||t.set({trigger:f.trigger,matchLength:f.text.length})},a=Bn(()=>l8(e)),i=f=>t.get().map(d=>Sm(e.dom,e.selection.getRng(),d.trigger,!0).bind(g=>vw(e,a,g,f))).getOrThunk(()=>y3(e,a)),l=f=>{i(f).fold(o,d=>{r(d.context),d.lookupData.then(g=>{t.get().map(h=>{let p=d.context;h.trigger===p.trigger&&(t.set(we(Q({},h),{matchLength:p.text.length})),n.get()?(qu(e,{range:p.range}),_D(e,{lookupData:g})):(n.set(!0),qu(e,{range:p.range}),kD(e,{lookupData:g})))})})})},c=(f,d)=>{let g=f.compareBoundaryPoints(window.Range.START_TO_START,d),h=f.compareBoundaryPoints(window.Range.END_TO_END,d);return g>=0&&h<=0},u=()=>t.get().bind(({trigger:f})=>{let d=e.selection.getRng();return Sm(e.dom,d,f,n.get()).filter(({range:g})=>c(d,g)).map(({range:g})=>g)});e.addCommand("mceAutocompleterReload",(f,d)=>{let g=ot(d)?d.fetchOptions:{};l(g)}),e.addCommand("mceAutocompleterClose",o),e.addCommand("mceAutocompleterRefreshActiveRange",()=>{u().each(f=>{qu(e,{range:f})})}),e.editorCommands.addQueryStateHandler("mceAutoCompleterInRange",()=>u().isSome()),c8(e,{cancelIfNecessary:o,load:l})},f8=bn().browser.isSafari(),Lw=e=>ks(C.fromDom(e)),$w=(e,t)=>{var n;return e.startOffset===0&&e.endOffset===((n=t.textContent)===null||n===void 0?void 0:n.length)},Zl=(e,t)=>m.from(e.getParent(t.container(),"details")),Mw=(e,t)=>Zl(e,t).isSome(),d8=(e,t)=>{let n=m.from(e.getParent(t.startContainer,"details")),s=m.from(e.getParent(t.endContainer,"details"));if(n.isSome()||s.isSome()){let o=n.bind(r=>m.from(e.select("summary",r)[0]));return m.some({startSummary:o,startDetails:n,endDetails:s})}else return m.none()},m8=(e,t)=>ht(t).exists(n=>n.isEqual(e)),g8=(e,t)=>un(t).exists(n=>Le(n.getNode())&&Ot(t,n).exists(s=>s.isEqual(e))||n.isEqual(e)),p8=(e,t)=>t.startSummary.exists(n=>m8(e,n)),h8=(e,t)=>t.startSummary.exists(n=>g8(e,n)),b8=(e,t)=>t.startDetails.exists(n=>Ot(n,e).forall(s=>t.startSummary.exists(o=>!o.contains(e.container())&&o.contains(s.container())))),C8=(e,t,n)=>n.startDetails.exists(s=>Rt(e,t).forall(o=>!s.contains(o.container()))),Uw=(e,t)=>{let n=t.getNode();rt(n)||e.selection.setCursorLocation(n,t.offset())},zw=(e,t,n)=>{let s=e.dom.getParent(t.container(),"details");if(s&&!s.open){let o=e.dom.select("summary",s)[0];o&&(n?ht(o):un(o)).each(a=>Uw(e,a))}else Uw(e,t)},y8=(e,t)=>{let n=l=>l.contains(e.startContainer),s=l=>l.contains(e.endContainer),o=t.startSummary.exists(n),r=t.startSummary.exists(s),a=t.startDetails.forall(l=>t.endDetails.forall(c=>l!==c));return(o||r)&&!(o&&r)||a},Hw=(e,t,n)=>{let{dom:s,selection:o}=e,r=e.getBody();if(n==="character"){let a=N.fromRangeStart(o.getRng()),i=s.getParent(a.container(),s.isBlock),l=Zl(s,a),c=i&&s.isEmpty(i),u=yt(i?.previousSibling),f=yt(i?.nextSibling);return c&&(t?f:u)&&Zo(!t,r,a).exists(h=>Mw(s,h)&&!wg(l,Zl(s,h)))?!0:Zo(t,r,a).fold(Oe,d=>{let g=Zl(s,d);if(Mw(s,d)&&!wg(l,g)){if(t||zw(e,d,!1),i&&c){if(t&&u)return!0;if(!t&&f)return!0;zw(e,d,t),e.dom.remove(i)}return!0}else return!1})}else return!1},v8=(e,t,n,s)=>{let r=e.selection.getRng(),a=N.fromRangeStart(r),i=e.getBody();return s==="selection"?y8(r,t):n?h8(a,t)||C8(i,a,t):p8(a,t)||b8(a,t)},E8=(e,t,n)=>d8(e.dom,e.selection.getRng()).fold(()=>Hw(e,t,n),s=>v8(e,s,t,n)||Hw(e,t,n)),S8=(e,t,n)=>{let s=e.selection,o=s.getNode(),r=s.getRng(),a=N.fromRangeStart(r);return VN(o)?(n==="selection"&&$w(r,o)||Vy(t,a,o)?Lw(o):e.undoManager.transact(()=>{let i=s.getSel(),{anchorNode:l,anchorOffset:c,focusNode:u,focusOffset:f}=i??{},d=()=>{U(l)&&U(c)&&U(u)&&U(f)&&i?.setBaseAndExtent(l,c,u,f)},g=()=>{l=i?.anchorNode,c=i?.anchorOffset,u=i?.focusNode,f=i?.focusOffset},h=(b,y)=>{D(b.childNodes,v=>{ya(v)&&y.appendChild(v)})},p=e.dom.create("span",{"data-mce-bogus":"1"});h(o,p),o.appendChild(p),d(),(n==="word"||n==="line")&&i?.modify("extend",t?"right":"left",n),!s.isCollapsed()&&$w(s.getRng(),p)?Lw(o):(e.execCommand(t?"ForwardDelete":"Delete"),g(),h(p,o),d()),e.dom.remove(p)}),!0):!1},vo=(e,t,n)=>E8(e,t,n)||f8&&S8(e,t,n)?m.some(ce):m.none(),Ww=e=>(t,n,s={})=>{let o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:ce,inputType:n},a=yh(new InputEvent(e));return t.dispatch(e,Q(Q(Q({},a),r),s))},qa=Ww("input"),Ql=Ww("beforeinput"),Vw=bn(),jw=Vw.os,qw=jw.isMacOS()||jw.isiOS(),w8=Vw.browser.isFirefox(),k8=(e,t,n)=>{let s=n.keyCode===j.BACKSPACE?"deleteContentBackward":"deleteContentForward",o=e.selection.isCollapsed(),r=o?"character":"selection",a=i=>o?i?"word":"line":"selection";j0([{keyCode:j.BACKSPACE,action:ne(R0,e)},{keyCode:j.BACKSPACE,action:ne(Xd,e,!1)},{keyCode:j.DELETE,action:ne(Xd,e,!0)},{keyCode:j.BACKSPACE,action:ne(Kd,e,!1)},{keyCode:j.DELETE,action:ne(Kd,e,!0)},{keyCode:j.BACKSPACE,action:ne(am,e,t,!1)},{keyCode:j.DELETE,action:ne(am,e,t,!0)},{keyCode:j.BACKSPACE,action:ne(Zf,e,!1)},{keyCode:j.DELETE,action:ne(Zf,e,!0)},{keyCode:j.BACKSPACE,action:ne(vo,e,!1,r)},{keyCode:j.DELETE,action:ne(vo,e,!0,r)},...qw?[{keyCode:j.BACKSPACE,altKey:!0,action:ne(vo,e,!1,a(!0))},{keyCode:j.DELETE,altKey:!0,action:ne(vo,e,!0,a(!0))},{keyCode:j.BACKSPACE,metaKey:!0,action:ne(vo,e,!1,a(!1))}]:[{keyCode:j.BACKSPACE,ctrlKey:!0,action:ne(vo,e,!1,a(!0))},{keyCode:j.DELETE,ctrlKey:!0,action:ne(vo,e,!0,a(!0))}],{keyCode:j.BACKSPACE,action:ne(Qd,e,!1)},{keyCode:j.DELETE,action:ne(Qd,e,!0)},{keyCode:j.BACKSPACE,action:ne(cm,e,!1)},{keyCode:j.DELETE,action:ne(cm,e,!0)},{keyCode:j.BACKSPACE,action:ne(jd,e,!1)},{keyCode:j.DELETE,action:ne(jd,e,!0)},{keyCode:j.BACKSPACE,action:ne(Vd,e,!1)},{keyCode:j.DELETE,action:ne(Vd,e,!0)},{keyCode:j.BACKSPACE,action:ne(im,e,!1)},{keyCode:j.DELETE,action:ne(im,e,!0)},{keyCode:j.BACKSPACE,action:ne(Zd,e,!1)},{keyCode:j.DELETE,action:ne(Zd,e,!0)}],n).filter(i=>e.selection.isEditable()).each(i=>{n.preventDefault(),Ql(e,s).isDefaultPrevented()||(i(),qa(e,s))})},_8=(e,t,n)=>Wa([{keyCode:j.BACKSPACE,action:ne(OS,e)},{keyCode:j.DELETE,action:ne(OS,e)},...qw?[{keyCode:j.BACKSPACE,altKey:!0,action:ne(Ha,e)},{keyCode:j.DELETE,altKey:!0,action:ne(Ha,e)},...n?[{keyCode:w8?224:91,action:ne(Ha,e)}]:[]]:[{keyCode:j.BACKSPACE,ctrlKey:!0,action:ne(Ha,e)},{keyCode:j.DELETE,ctrlKey:!0,action:ne(Ha,e)}]],t),A8=(e,t)=>{let n=!1;e.on("keydown",s=>{n=s.keyCode===j.BACKSPACE,s.isDefaultPrevented()||k8(e,t,s)}),e.on("keyup",s=>{s.isDefaultPrevented()||_8(e,s,n),n=!1})},x8=e=>{for(;e;){if(q(e)||F(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},dr=(e,t)=>{let n=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){let r=x8(t.firstChild);r&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(n.doc.createTextNode(Je),t.firstChild)}let o=n.createRng();if(t.normalize(),t.hasChildNodes()){let r=new st(t,t),a=t,i;for(;i=r.current();){if(F(i)){o.setStart(i,0),o.setEnd(i,0);break}if(s[i.nodeName.toLowerCase()]){o.setStartBefore(i),o.setEndBefore(i);break}a=i,i=r.next()}i||(o.setStart(a,0),o.setEnd(a,0))}else Le(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),Sa(e,o)},Ka=(e,t)=>{let n=e.getRoot(),s,o=t;for(;o!==n&&o&&e.getContentEditable(o)!=="false";){if(e.getContentEditable(o)==="true"){s=o;break}o=o.parentNode}return o!==n?s:n},Am=e=>m.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),N8=e=>Am(e).fold(W(""),t=>t.nodeName.toUpperCase()),R8=e=>Am(e).filter(t=>Wo(C.fromDom(t))).isSome(),xm=e=>{e.innerHTML='<br data-mce-bogus="1">'},T8=(e,t,n)=>{let s=e.dom;m.from(n.style).map(s.parseStyle).each(l=>{let c=Yc(C.fromDom(t)),u=Q(Q({},c),l);s.setStyles(t,u)});let o=m.from(n.class).map(l=>l.split(/\s+/)),r=m.from(t.className).map(l=>se(l.split(/\s+/),c=>c!==""));ct(o,r,(l,c)=>{let u=se(c,d=>!ke(l,d)),f=[...l,...u];s.setAttrib(t,"class",f.join(" "))});let a=["style","class"],i=Rr(n,(l,c)=>!ke(a,c));s.setAttribs(t,i)},Ga=(e,t)=>{if(pt(e).toLowerCase()===t.tagName.toLowerCase()){let s=ua(e);T8(e,t,s)}},Kw=(e,t,n,s,o=!0,r,a)=>{let i=e.dom,l=e.schema,c=pt(e),u=n?n.nodeName.toUpperCase():"",f=t,d=l.getTextInlineElements(),g;r||u==="TABLE"||u==="HR"?g=i.create(r||c,a||{}):g=n.cloneNode(!1);let h=g;if(!o)i.setAttrib(g,"style",null),i.setAttrib(g,"class",null);else do if(d[f.nodeName]){if(Qt(f)||Jt(f))continue;let p=f.cloneNode(!1);i.setAttrib(p,"id",""),g.hasChildNodes()?(p.appendChild(g.firstChild),g.appendChild(p)):(h=p,g.appendChild(p))}while((f=f.parentNode)&&f!==s);return Ga(e,g),xm(h),g},D8=(e,t)=>e.dom.getParent(t,uu),P8=(e,t,n)=>{let s=t;for(;s&&s!==e&&yt(s.nextSibling);){let o=s.parentElement;if(!o||!n(o))return uu(o);s=o}return!1},B8=(e,t,n)=>!t&&n.nodeName.toLowerCase()===pt(e)&&e.dom.isEmpty(n)&&P8(e.getBody(),n,s=>oe(e.schema.getTextBlockElements(),s.nodeName.toLowerCase())),O8=(e,t,n)=>{var s,o,r;let a=t(pt(e)),i=D8(e,n);i&&(e.dom.insertAfter(a,i),dr(e,a),((r=(o=(s=n.parentElement)===null||s===void 0?void 0:s.childNodes)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)>1&&e.dom.remove(n))},I8=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,F8=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},Gw=(e,t)=>{let n=e?.parentNode;return U(n)&&n.nodeName===t},Yw=e=>U(e)&&/^(OL|UL|LI)$/.test(e.nodeName),Nm=e=>U(e)&&/^(LI|DT|DD)$/.test(e.nodeName),L8=e=>Yw(e)&&Yw(e.parentNode),Jl=e=>{let t=e.parentNode;return Nm(t)?t:e},ec=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!q(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},Xw=e=>Pt(fi(Yc(C.fromDom(e)),(t,n)=>`${n}: ${t};`),(t,n)=>t+n,""),$8=(e,t,n,s,o)=>{let r=e.dom,a=e.selection.getRng(),i=n.parentNode;if(n===e.getBody()||!i)return;L8(n)&&(o="LI");let l=Nm(s)?Xw(s):void 0,c=Nm(s)&&l?t(o,{style:Xw(s)}):t(o);if(ec(n,s,!0)&&ec(n,s,!1))if(Gw(n,"LI")){let u=Jl(n);r.insertAfter(c,u),F8(n)?r.remove(u):r.remove(n)}else r.replace(c,n);else if(ec(n,s,!0))Gw(n,"LI")?(r.insertAfter(c,Jl(n)),c.appendChild(r.doc.createTextNode(" ")),c.appendChild(n)):i.insertBefore(c,n),r.remove(s);else if(ec(n,s,!1))r.insertAfter(c,Jl(n)),r.remove(s);else{n=Jl(n);let u=a.cloneRange();u.setStartAfter(s),u.setEndAfter(n);let f=u.extractContents();if(o==="LI"&&I8(f,"LI")){let d=se(be(c.children,C.fromDom),wr(Mr("br")));c=f.firstChild,r.insertAfter(f,n),D(d,g=>Kc(C.fromDom(c),g)),l&&c.setAttribute("style",l)}else r.insertAfter(f,n),r.insertAfter(c,n);r.remove(s)}dr(e,c)},M8=e=>{D(Ip(C.fromDom(e),Nt),t=>{let n=t.dom;n.nodeValue=Vt(n.data)})},U8=(e,t)=>{let n=e.dom.getParent(t,"ol,ul,dl");return n!==null&&e.dom.getContentEditableParent(n)==="false"},z8=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),Rm=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,H8=(e,t)=>e.nodeName===t||e.nextSibling&&e.nextSibling.nodeName===t,Tm=(e,t)=>U(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",W8=(e,t,n)=>{var s;let o=[];if(!n)return;let r=n;for(;r=r.firstChild;){if(e.isBlock(r))return;q(r)&&!t[r.nodeName.toLowerCase()]&&o.push(r)}let a=o.length;for(;a--;)r=o[a],(!r.hasChildNodes()||r.firstChild===r.lastChild&&((s=r.firstChild)===null||s===void 0?void 0:s.nodeValue)===""||z8(e,r))&&e.remove(r)},Dm=(e,t,n)=>F(t)?e?n===1&&t.data.charAt(n-1)===et?0:n:n===t.data.length-1&&t.data.charAt(n)===et?t.data.length:n:n,V8=e=>{let t=e.cloneRange();return t.setStart(e.startContainer,Dm(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Dm(!1,e.endContainer,e.endOffset)),t},j8=e=>{let t=e;do F(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},q8=(e,t,n,s,o)=>{var r,a;let i=e.dom,l=(r=Ka(i,s))!==null&&r!==void 0?r:i.getRoot(),c=i.getParent(s,i.isBlock);if(!c||!Tm(i,c)){if(c=c||l,!c.hasChildNodes()){let g=i.create(t);return Ga(e,g),c.appendChild(g),n.setStart(g,0),n.setEnd(g,0),g}let u=s;for(;u&&u.parentNode!==c;)u=u.parentNode;let f;for(;u&&!i.isBlock(u);)f=u,u=u.previousSibling;let d=(a=f?.parentElement)===null||a===void 0?void 0:a.nodeName;if(f&&d&&e.schema.isValidChild(d,t.toLowerCase())){let g=f.parentNode,h=i.create(t);for(Ga(e,h),g.insertBefore(h,f),u=f;u&&!i.isBlock(u);){let p=u.nextSibling;h.appendChild(u),u=p}n.setStart(s,o),n.setEnd(s,o)}}return s},K8=(e,t)=>{t.normalize();let n=t.lastChild;(!n||q(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},G8=(e,t)=>{let n=VD(e);return qe(t)?!1:ee(n)?ke(L.explode(n),t.nodeName.toLowerCase()):n},Zw={insert:(e,t)=>{let n,s,o,r,a=!1,i=e.dom,l=e.schema,c=l.getNonEmptyElements(),u=e.selection.getRng(),f=pt(e),d=C.fromDom(u.startContainer),g=Do(d,u.startOffset),h=g.exists(P=>$r(P)&&!Es(P)),p=u.collapsed&&h,b=(P,z)=>Kw(e,n,B,T,WD(e),P,z),y=P=>{let z=Dm(P,n,s);if(F(n)&&(P?z>0:z<n.data.length))return!1;if((n.parentNode===B||n===B)&&a&&!P||P&&q(n)&&n===B.firstChild)return!0;if(Rm(n,"TABLE")||Rm(n,"HR"))return H8(n,"BR")?!P:a&&!P||!a&&P;let X=new st(n,B);F(n)&&(P&&z===0?X.prev():!P&&z===n.data.length&&X.next());let re;for(;re=X.current();){if(q(re)){if(!re.getAttribute("data-mce-bogus")){let ie=re.nodeName.toLowerCase();if(c[ie]&&ie!=="br")return!1}}else if(F(re)&&!$o(re.data))return!1;P?X.prev():X.next()}return!0},v=()=>{let P;return/^(H[1-6]|PRE|FIGURE)$/.test(o)&&H!=="HGROUP"?P=b(f):P=b(),G8(e,r)&&Tm(i,r)&&i.isEmpty(B,void 0,{includeZwsp:!0})?P=i.split(r,B):i.insertAfter(P,B),dr(e,P),P};ll(i,u).each(P=>{u.setStart(P.startContainer,P.startOffset),u.setEnd(P.endContainer,P.endOffset)}),n=u.startContainer,s=u.startOffset;let E=!!(t&&t.shiftKey),w=!!(t&&t.ctrlKey);q(n)&&n.hasChildNodes()&&!p&&(a=s>n.childNodes.length-1,n=n.childNodes[Math.min(s,n.childNodes.length-1)]||n,a&&F(n)?s=n.data.length:s=0);let T=Ka(i,n);if(!T||U8(e,n))return;E||(n=q8(e,f,u,n,s));let B=i.getParent(n,i.isBlock)||i.getRoot();r=U(B?.parentNode)?i.getParent(B.parentNode,i.isBlock):null,o=B?B.nodeName.toUpperCase():"";let H=r?r.nodeName.toUpperCase():"";if(H==="LI"&&!w){let P=r;B=P,r=P.parentNode,o=H}if(q(r)&&B8(e,E,B))return O8(e,b,B);if(/^(LI|DT|DD)$/.test(o)&&q(r)&&i.isEmpty(B)){$8(e,b,r,B,f);return}if(!p&&(B===e.getBody()||!Tm(i,B)))return;let x=B.parentNode,_;if(p)_=b(f),g.fold(()=>{Ke(d,C.fromDom(_))},P=>{Bt(P,C.fromDom(_))}),e.selection.setCursorLocation(_,0);else if(qo(B))_=Iu(B),i.isEmpty(B)&&xm(B),Ga(e,_),dr(e,_);else if(y(!1))_=v();else if(y(!0)&&x){let P=N.fromRangeStart(u),z=If(P),X=C.fromDom(B),ie=ml(X,P,e.schema)?ky(X,P,e.schema).bind(Ee=>m.from(Ee.getNode())):m.none();_=x.insertBefore(b(),B);let pe=Rm(B,"HR")||z?_:ie.getOr(B);dr(e,pe)}else{let P=V8(u).cloneRange();P.setEndAfter(B);let z=P.extractContents();M8(z),j8(z),_=z.firstChild,i.insertAfter(z,B),W8(i,c,_),K8(i,B),i.isEmpty(B)&&xm(B),_.normalize(),i.isEmpty(_)?(i.remove(_),v()):(Ga(e,_),dr(e,_))}i.setAttrib(_,"id",""),e.dispatch("NewBlock",{newBlock:_})},fakeEventName:"insertParagraph"},Y8=(e,t,n)=>{let s=new st(t,n),o,r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||F(o)&&o.length>0)return!0;return!1},Qw=(e,t,n)=>{let s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),Sa(e,s)},X8=(e,t)=>{let n=e.selection,s=e.dom,o=n.getRng(),r,a=!1;ll(s,o).each(g=>{o.setStart(g.startContainer,g.startOffset),o.setEnd(g.endContainer,g.endOffset)});let i=o.startOffset,l=o.startContainer;if(q(l)&&l.hasChildNodes()){let g=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,g&&F(l)?i=l.data.length:i=0}let c=s.getParent(l,s.isBlock),u=c&&c.parentNode?s.getParent(c.parentNode,s.isBlock):null,f=u?u.nodeName.toUpperCase():"",d=!!(t&&t.ctrlKey);f==="LI"&&!d&&(c=u),F(l)&&i>=l.data.length&&(Y8(e.schema,l,c||s.getRoot())||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),zu(s,o,r),Qw(e,r,a),e.undoManager.add()},Z8=(e,t)=>{let n=C.fromTag("br");Bt(C.fromDom(t),n),e.undoManager.add()},Q8=(e,t)=>{ej(e.getBody(),t)||ts(C.fromDom(t),C.fromTag("br"));let n=C.fromTag("br");ts(C.fromDom(t),n),Qw(e,n.dom,!1),e.undoManager.add()},J8=e=>Le(e.getNode()),ej=(e,t)=>J8(N.after(t))?!0:Rt(e,N.after(t)).map(n=>Le(n.getNode())).getOr(!1),Jw=e=>e&&e.nodeName==="A"&&"href"in e,tj=e=>e.fold(Oe,Jw,Jw,Oe),nj=e=>{let t=G(go,e),n=N.fromRangeStart(e.selection.getRng());return Kn(t,e.getBody(),n).filter(tj)},sj=(e,t)=>{t.fold(ce,G(Z8,e),G(Q8,e),ce)},ek={insert:(e,t)=>{let n=nj(e);n.isSome()?n.each(G(sj,e)):X8(e,t)},fakeEventName:"insertLineBreak"},tk=(e,t)=>Am(e).filter(n=>t.length>0&&Cn(C.fromDom(n),t)).isSome(),oj=e=>tk(e,zD(e)),rj=e=>tk(e,HD(e)),qt=Dn.generate([{br:[]},{block:[]},{none:[]}]),aj=(e,t)=>rj(e),nk=e=>(t,n)=>R8(t)===e,sk=(e,t)=>(n,s)=>N8(n)===e.toUpperCase()===t,ij=e=>{let t=Ka(e.dom,e.selection.getStart());return qe(t)},Ya=e=>sk("pre",e),lj=()=>sk("summary",!0),tc=e=>(t,n)=>MD(t)===e,cj=(e,t)=>oj(e),nc=(e,t)=>t,uj=e=>{let t=pt(e),n=Ka(e.dom,e.selection.getStart());return U(n)&&e.schema.isValidChild(n.nodeName,t)},fj=e=>{let t=e.selection.getRng(),n=C.fromDom(t.startContainer),o=Do(n,t.startOffset).map(r=>$r(r)&&!Es(r));return t.collapsed&&o.getOr(!0)},on=(e,t)=>(n,s)=>Pt(e,(r,a)=>r&&a(n,s),!0)?m.some(t):m.none(),dj=(e,t)=>VS([on([aj],qt.none()),on([Ya(!0),ij],qt.none()),on([lj()],qt.br()),on([Ya(!0),tc(!1),nc],qt.br()),on([Ya(!0),tc(!1)],qt.block()),on([Ya(!0),tc(!0),nc],qt.block()),on([Ya(!0),tc(!0)],qt.br()),on([nk(!0),nc],qt.br()),on([nk(!0)],qt.block()),on([cj],qt.br()),on([nc],qt.br()),on([uj],qt.block()),on([fj],qt.block())],[e,!!(t&&t.shiftKey)]).getOr(qt.none()),sc=(e,t,n)=>{t.mode.isReadOnly()||(t.selection.isCollapsed()||AI(t),!(U(n)&&Ql(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),U(n)&&qa(t,e.fakeEventName)))},ok=(e,t)=>{if(e.mode.isReadOnly())return;let n=()=>sc(ek,e,t),s=()=>sc(Zw,e,t),o=dj(e,t);switch(UD(e)){case"linebreak":o.fold(n,n,ce);break;case"block":o.fold(s,s,ce);break;case"invert":o.fold(s,n,ce);break;default:o.fold(n,s,ce);break}},rk=bn(),mj=rk.os.isiOS()&&rk.browser.isSafari(),ak=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),$M(e.undoManager),e.undoManager.transact(()=>{ok(e,t)}))},gj=e=>{if(!e.collapsed)return!1;let t=e.startContainer;if(F(t)){let n=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,s=t.data.charAt(e.startOffset-1);return n.test(s)}else return!1},pj=e=>{let t=m.none(),n=o=>{t=m.some(o.selection.getBookmark()),o.undoManager.add()},s=(o,r)=>{o.undoManager.undo(),t.fold(ce,a=>o.selection.moveToBookmark(a)),ak(o,r),t=m.none()};e.on("keydown",o=>{o.keyCode===j.ENTER&&(mj&&gj(e.selection.getRng())?n(e):ak(e,o))}),e.on("keyup",o=>{o.keyCode===j.ENTER&&t.each(()=>s(e,o))})},hj=(e,t,n)=>{let s=ye.os.isMacOS()||ye.os.isiOS();Wa([{keyCode:j.END,action:ne(U0,e,!0)},{keyCode:j.HOME,action:ne(U0,e,!1)},...s?[]:[{keyCode:j.HOME,action:ne(zl,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:j.END,action:ne(zl,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:j.END,action:ne(G0,e,!0)},{keyCode:j.HOME,action:ne(G0,e,!1)},{keyCode:j.END,action:ne(Ul,e,!0,t)},{keyCode:j.HOME,action:ne(Ul,e,!1,t)}],n).each(o=>{n.preventDefault()})},bj=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||hj(e,t,n)})},Cj=e=>{e.on("input",t=>{t.isComposing||rI(e)})},yj=bn(),vj=(e,t,n)=>{Wa([{keyCode:j.PAGE_UP,action:ne(Ul,e,!1,t)},{keyCode:j.PAGE_DOWN,action:ne(Ul,e,!0,t)}],n)},ik=e=>e.stopImmediatePropagation(),lk=e=>e.keyCode===j.PAGE_UP||e.keyCode===j.PAGE_DOWN,ck=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",ik,!0):!n&&e.get()&&t.off("NodeChange",ik),e.set(n)},Ej=(e,t)=>{if(yj.os.isMacOS())return;let n=nt(!1);e.on("keydown",s=>{lk(s)&&ck(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()||vj(e,t,s),lk(s)&&n.get()&&(ck(n,e,!1),e.nodeChanged())})},uk=(e,t)=>e===t||e.contains(t),Sj=(e,t)=>!uk(e.getBody(),t.startContainer)||!uk(e.getBody(),t.endContainer)?!0:YC(e.dom,t),wj=e=>{e.on("beforeinput",t=>{(!e.selection.isEditable()||Ie(t.getTargetRanges(),n=>!Sj(e,n)))&&t.preventDefault()})},fk=(e,t)=>{let n=t.container(),s=t.offset();return F(n)?(n.insertData(s,e),m.some(N(n,s+e.length))):Yi(t).map(o=>{let r=C.fromText(e);return t.isAtEnd()?ts(o,r):Bt(o,r),N(r.dom,e.length)})},dk=G(fk,Je),mk=G(fk," "),kj=(e,t,n)=>Ty(e,t,n)?dk(t):mk(t),_j=e=>t=>t.fold(n=>Ot(e.dom,N.before(n)),n=>ht(n),n=>un(n),n=>Rt(e.dom,N.after(n))),Aj=(e,t,n)=>s=>Ty(e,s,n)?dk(t):mk(t),gk=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},xj=(e,t)=>e.isEditable(e.getParent(t,"summary")),Nj=e=>{let t=N.fromRangeStart(e.selection.getRng()),n=C.fromDom(e.getBody());if(e.selection.isCollapsed()){let s=G(go,e),o=N.fromRangeStart(e.selection.getRng());return Kn(s,e.getBody(),o).bind(_j(n)).map(r=>()=>Aj(n,t,e.schema)(r).each(gk(e)))}else return m.none()},Rj=e=>{let t=()=>{let n=C.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete");let s=N.fromRangeStart(e.selection.getRng());kj(n,s,e.schema).each(gk(e))};return Ro(ye.browser.isFirefox()&&e.selection.isEditable()&&xj(e.dom,e.selection.getRng().startContainer),t)},Tj=(e,t)=>{j0([{keyCode:j.SPACEBAR,action:ne(Nj,e)},{keyCode:j.SPACEBAR,action:ne(Rj,e)}],t).each(n=>{t.preventDefault(),Ql(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),qa(e,"insertText",{data:" "}))})},Dj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||Tj(e,t)})},Pj=e=>JP(e)?[{keyCode:j.TAB,action:ne(pw,e,!0)},{keyCode:j.TAB,shiftKey:!0,action:ne(pw,e,!1)}]:[],Bj=(e,t)=>{Wa([...Pj(e)],t).each(n=>{t.preventDefault()})},Oj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||Bj(e,t)})},Ij=e=>{if(e.addShortcut("Meta+P","","mcePrint"),u8(e),qn(e))return nt(null);{let t=X2(e);return wj(e),GW(e),i3(e,t),A8(e,t),pj(e),Dj(e),Cj(e),Oj(e),bj(e,t),Ej(e,t),t}};class Fj{constructor(t){this.lastPath=[],this.editor=t;let n,s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{let r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!Nf(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{ol(t),t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{let o=t.selection.getStart(!0);o&&el(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&el(t)&&(t.selection.getNode().nodeName==="IMG"?tn.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){let n=this.editor,s=n.selection,o;if(n.initialized&&s&&!yP(n)&&!Ki(n)){let r=n.getBody();o=s.getStart(!0)||r,(o.ownerDocument!==n.getDoc()||!n.dom.isChildOf(o,r))&&(o=r);let a=[];n.dom.getParent(o,i=>i===r?!0:(a.push(i),!1)),n.dispatch("NodeChange",we(Q({},t),{element:o,parents:a}))}}isSameElementPath(t){let n,s=this.editor,o=xr(s.dom.getParents(t,He,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}let pk="x-tinymce/html",oc=W(pk),Pm="<!-- "+pk+" -->",Lj=e=>Pm+e,$j=e=>e.replace(Pm,""),hk=e=>e.indexOf(Pm)!==-1,Mj=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),Uj=(e,t)=>{let n="<"+e,s=fi(t,(o,r)=>r+'="'+Qs.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},zj=(e,t,n)=>{let s=e.split(/\n\n/),o=Uj(t,n),r="</"+t+">",a=be(s,l=>l.split(/\n/).join("<br />")),i=l=>o+l+r;return a.length===1?a[0]:be(a,i).join("")},bk="%MCEPASTEBIN%",Hj=(e,t)=>{let{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());let r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},bk);ye.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},Wj=(e,t)=>{let n=e.dom;if(Bm(e)){let s,o=t.get();for(;s=Bm(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},Bm=e=>e.dom.get("mcepastebin"),Vj=e=>U(e)&&e.id==="mcepastebin",jj=e=>{let t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=se(e.getBody().childNodes,Vj);D(o,a=>{n(s,a)});let r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){let i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},Ck=e=>e===bk,qj=e=>{let t=nt(null);return{create:()=>Hj(e,t),remove:()=>Wj(e,t),getEl:()=>Bm(e),getHtml:()=>jj(e),getLastRng:t.get}},yk=(e,t)=>(L.each(t,n=>{ii(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),Kj=e=>{let t=ws(),n=rr({},t),s="",o=t.getVoidElements(),r=L.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=l=>{let c=l.name,u=l;if(c==="br"){s+=`
`;return}if(c!=="wbr"){if(o[c]&&(s+=" "),r[c]){s+=" ";return}if(l.type===3&&(s+=l.value),!(l.name in t.getVoidElements())){let f=l.firstChild;if(f)do i(f);while(f=f.next)}a[c]&&u.next&&(s+=`
`,c==="p"&&(s+=`
`))}};return e=yk(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},vk=e=>(e=yk(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":Je],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),Gj=e=>{let t=0;return()=>e+t++},Yj=e=>{let t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return L.hasOwn(n,t)?"image/"+n[t]:"image/"+t},Xj=(e,t)=>{let n=rr({sanitize:Pb(e),sandbox_iframes:Ob(e),sandbox_iframes_exclusions:Zu(e),convert_unsafe_embeds:nB(e)},e.schema);n.addNodeFilter("meta",o=>{L.each(o,r=>{r.remove()})});let s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return Ts({validate:!0},e.schema).serialize(s)},Ek=(e,t)=>({content:e,cancelled:t}),Zj=(e,t,n)=>{let s=e.dom.create("div",{style:"display:none"},t),o=ND(e,s,n);return Ek(o.node.innerHTML,o.isDefaultPrevented())},Qj=(e,t,n)=>{let s=xD(e,t,n),o=Xj(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?Zj(e,o,n):Ek(o,s.isDefaultPrevented())},Jj=(e,t,n)=>Qj(e,t,n),Om=(e,t)=>(e.insertContent(t,{merge:LP(e),paste:!0}),!0),Im=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),e4=(e,t)=>Im(t)&&Ie(Bb(e),n=>Dc(t.toLowerCase(),`.${n.toLowerCase()}`)),t4=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),n4=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),s4=(e,t,n)=>!e.selection.isCollapsed()&&Im(t)?n4(e,t,n):!1,o4=(e,t,n)=>e4(e,t)?t4(e,t,n):!1,r4=(e,t)=>{L.each([s4,o4,Om],n=>!n(e,t,Om))},a4=(e,t,n)=>{n||!$P(e)?Om(e,t):r4(e,t)},i4=Gj("mceclip"),l4=e=>{let t=bm();return rw(t,e),hm(t),t},Sk=(e,t,n,s,o)=>{let r=Jj(e,t,n);if(!r.cancelled){let a=r.content,i=()=>a4(e,a,s);o?Ql(e,"insertFromPaste",{dataTransfer:l4(a)}).isDefaultPrevented()||(i(),qa(e,"insertFromPaste")):i()}},rc=(e,t,n,s)=>{let o=n||hk(t);Sk(e,$j(t),o,!1,s)},Fm=(e,t,n)=>{let s=e.dom.encode(t).replace(/\r\n/g,`
`),o=Hp(s,UP(e)),r=zj(o,pt(e),ua(e));Sk(e,r,!1,!0,n)},wk=e=>{let t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){let s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},Fs=(e,t)=>t in e&&e[t].length>0,kk=e=>Fs(e,"text/html")||Fs(e,"text/plain"),c4=(e,t)=>{let n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return U(n)?e.dom.encode(n[1]):void 0},u4=(e,t,n,s)=>{let o=i4(),r=vb(e)&&U(n.name),a=r?c4(e,n.name):o,i=r?n.name:void 0,l=t.create(o,n,s,a,i);return t.add(l),l},f4=(e,t)=>{Cd(t.uri).each(({data:n,type:s,base64Encoded:o})=>{let r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(r,s),c=l??u4(e,i,a,r);rc(e,`<img src="${c.blobUri()}">`,!1,!0)})},d4=e=>e.type==="paste",m4=e=>Promise.all(be(e,t=>eE(t).then(n=>({file:t,uri:n})))),g4=e=>{let t=Bb(e);return n=>Qe(n.type,"image/")&&Ie(t,s=>Yj(s)===n.type)},p4=(e,t)=>{let n=t.items?Yt(Mt(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?Mt(t.files):[];return se(n.length>0?n:s,g4(e))},_k=(e,t,n)=>{let s=d4(t)?t.clipboardData:t.dataTransfer;if(qi(e)&&s){let o=p4(e,s);if(o.length>0)return t.preventDefault(),m4(o).then(r=>{n&&e.selection.setRng(n),D(r,a=>{f4(e,a)})}),!0}return!1},h4=e=>{var t,n;return ye.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},b4=e=>j.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,Lm=(e,t,n,s,o)=>{let r=vk(n),a=Fs(t,oc())||hk(n),i=!a&&Mj(r),l=Im(r);(Ck(r)||!r.length||i&&!l)&&(s=!0),(s||l)&&(Fs(t,"text/plain")&&i?r=t["text/plain"]:r=Kj(r)),!Ck(r)&&(s?Fm(e,r,o):rc(e,r,a,o))},C4=(e,t,n)=>{let s,o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{b4(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||h4(r))return;let a=n.get()==="text"||s;s=!1;let i=wk(r.clipboardData);!kk(i)&&_k(e,r,o())||(Fs(i,"text/html")?(r.preventDefault(),Lm(e,i,i["text/html"],a,!0)):Fs(i,"text/plain")&&Fs(i,"text/uri-list")?(r.preventDefault(),Lm(e,i,i["text/plain"],a,!0)):(t.create(),tn.setEditorTimeout(e,()=>{let l=t.getHtml();t.remove(),Lm(e,i,l,a,!1)},0)))})},y4=e=>{let t=o=>Qe(o,"webkit-fake-url"),n=o=>Qe(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!qi(e)&&s(a))for(let i of o){let l=i.attr("src");ee(l)&&!i.attr("data-mce-object")&&l!==ye.transparentSrc&&(t(l)||!zP(e)&&n(l))&&i.remove()}})},v4=(e,t,n)=>{C4(e,t,n),y4(e)},E4=(e,t)=>{t.get()==="text"?(t.set("html"),gb(e,!1)):(t.set("text"),gb(e,!0)),e.focus()},S4=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{E4(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&rc(e,s.html,s.internal,!1),s.text&&Fm(e,s.text,!1)})},w4=(e,t,n)=>{if(e)try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(oc(),t),!0}catch{return!1}else return!1},Ak=(e,t,n,s)=>{w4(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},xk=e=>(t,n)=>{let{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);let i=o.getRng();a.focus();let l=s.createRng();l.selectNodeContents(a),o.setRng(l),tn.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},Nk=e=>({html:Lj(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),k4=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),Rk=e=>!e.selection.isCollapsed()||k4(e),_4=e=>t=>{!t.isDefaultPrevented()&&Rk(e)&&e.selection.isEditable()&&Ak(t,Nk(e),xk(e),()=>{if(ye.browser.isChromium()||ye.browser.isFirefox()){let n=e.selection.getRng();tn.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},A4=e=>t=>{!t.isDefaultPrevented()&&Rk(e)&&Ak(t,Nk(e),xk(e),ce)},x4=e=>{e.on("cut",_4(e)),e.on("copy",A4(e))},Tk=(e,t)=>{var n,s;return fo.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},N4=e=>{let t=e["text/plain"];return t?t.indexOf("file://")===0:!1},Dk=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},R4=e=>Ie(e.files,t=>/^image\//.test(t.type)),T4=(e,t,n,s)=>{let o=e.getParent(n,a=>Xs(t,a));if(!yt(e.getParent(n,"summary")))return!0;if(o&&oe(s,"text/html")){let a=new DOMParser().parseFromString(s["text/html"],"text/html").body;return!yt(a.querySelector(o.nodeName.toLowerCase()))}else return!1},D4=e=>{e.on("input",t=>{let n=s=>yt(s.querySelector("summary"));if(t.inputType==="deleteByDrag"){let s=se(e.dom.select("details"),n);D(s,o=>{Le(o.firstChild)&&o.firstChild.remove();let r=e.dom.create("summary");r.appendChild(Vo().dom),o.prepend(r)})}})},P4=(e,t)=>{DP(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),qi(e)||e.on("drop",n=>{let s=n.dataTransfer;s&&R4(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;let s=Tk(e,n);if(qe(s))return;let o=wk(n.dataTransfer),r=Fs(o,oc());if((!kk(o)||N4(o))&&_k(e,n,s))return;let a=o[oc()],i=a||o["text/html"]||o["text/plain"],l=T4(e.dom,e.schema,s.startContainer,o),c=t.get();c&&!l||i&&(n.preventDefault(),tn.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{(a||c&&l)&&e.execCommand("Delete"),Dk(e,s);let u=vk(i);o["text/html"]?rc(e,u,r,!0):Fm(e,u,!0)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{qi(e)&&!t.get()&&(n.preventDefault(),Dk(e,Tk(e,n))),n.type==="dragend"&&t.set(!1)}),D4(e)},B4=e=>{let t=o=>r=>{o(e,r)},n=PP(e);_e(n)&&e.on("PastePreProcess",t(n));let s=BP(e);_e(s)&&e.on("PastePostProcess",t(s))},O4=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},I4=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,Pk=e=>L.trim(e).replace(I4,Zr).toLowerCase(),F4=(e,t,n)=>{let s=IP(e);if(n||s==="all"||!FP(e))return t;let o=s?s.split(/[, ]/):[];if(o&&s!=="none"){let r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,u)=>{let f=r.parseStyle(r.decode(c)),d={};for(let h=0;h<o.length;h++){let p=f[o[h]],b=p,y=r.getStyle(a,o[h],!0);/color/.test(o[h])&&(b=Pk(b),y=Pk(y)),y!==b&&(d[o[h]]=p)}let g=r.serializeStyle(d,"span");return g?l+' style="'+g+'"'+u:l+u})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,l)=>a+' style="'+i+'"'+l),t},L4=e=>{(ye.browser.isChromium()||ye.browser.isSafari())&&O4(e,F4)},$4=e=>{let t=nt(!1),n=nt(MP(e)?"text":"html"),s=qj(e);L4(e),S4(e,n),B4(e),e.addQueryStateHandler("mceTogglePlainTextPaste",()=>n.get()==="text"),e.on("PreInit",()=>{x4(e),P4(e,t),v4(e,s,n)})},M4=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},U4=e=>{e.parser.addNodeFilter("details",t=>{let n=eB(e);D(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{let n=tB(e);D(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})})},z4=e=>{M4(e),U4(e)},H4=Le,Bk=F,W4=e=>Re(e.dom),V4=e=>cn(e.dom),Ok=e=>t=>Se(C.fromDom(e),t),j4=(e,t,n)=>vs(C.fromDom(e),s=>V4(s)||n.isBlock(Ce(s)),Ok(t)).getOr(C.fromDom(t)).dom,Ik=(e,t)=>vs(C.fromDom(e),W4,Ok(t)),Fk=(e,t,n)=>{let s=new st(e,t),o=n?s.next.bind(s):s.prev.bind(s),r=e;for(let a=n?e:o();a&&!H4(a);a=o())wn(a)&&(r=a);return r},q4=(e,t,n)=>{let o=N.fromRangeStart(e).getNode(),r=j4(o,t,n),a=Fk(o,r,!1),i=Fk(o,r,!0),l=document.createRange();return Ik(a,r).fold(()=>{Bk(a)?l.setStart(a,0):l.setStartBefore(a)},c=>l.setStartBefore(c.dom)),Ik(i,r).fold(()=>{Bk(i)?l.setEnd(i,i.data.length):l.setEndAfter(i)},c=>l.setEndAfter(c.dom)),l},K4=e=>{let t=q4(e.selection.getRng(),e.getBody(),e.schema);e.selection.setRng(sd(t))},G4=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),K4(e))})};var Xa=function(e){return e.Before="before",e.After="after",e}(Xa||{});let Y4=(e,t)=>Math.abs(e.left-t),X4=(e,t)=>Math.abs(e.right-t),Z4=(e,t)=>e>=t.top&&e<=t.bottom,Q4=(e,t)=>e.top<t.bottom&&e.bottom>t.top,J4=(e,t)=>{let n=_T(e,t)/Math.min(e.height,t.height);return Q4(e,t)&&n>.5},eq=(e,t)=>{let n=se(e,s=>Z4(t,s));return kT(n).fold(()=>[[],e],s=>{let{pass:o,fail:r}=_o(e,a=>J4(a,s));return[o,r]})},tq=(e,t)=>({node:e.node,position:Y4(e,t)<X4(e,t)?Xa.Before:Xa.After}),nq=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),$m=(e,t,n,s)=>{let o=f=>wn(f.node)?m.some(f):q(f.node)?$m(Mt(f.node.childNodes),t,n,!1):m.none(),r=(f,d,g)=>o(d).filter(h=>Math.abs(g(f,t,n)-g(h,t,n))<2&&F(h.node)),a=(f,d)=>{let g=Hs(f,(h,p)=>d(h,t,n)-d(p,t,n));return Ao(g,o).map(h=>s&&!F(h.node)&&g.length>1?r(h,g[1],d).getOr(h):h)},[i,l]=eq(r0(e),n),{pass:c,fail:u}=_o(l,f=>f.top<n);return a(i,nq).orThunk(()=>a(u,Fh)).orThunk(()=>a(c,Fh))},sq=(e,t,n,s)=>{let o=(r,a)=>{let i=c=>q(c)&&c.classList.contains("mce-drag-container"),l=se(r.dom.childNodes,wr(i));return a.fold(()=>$m(l,n,s,!0),c=>{let u=se(l,f=>f!==c.dom);return $m(u,n,s,!0)}).orThunk(()=>(Se(r,e)?m.none():zr(r)).bind(u=>o(u,m.some(r))))};return o(t,m.none())},oq=(e,t,n)=>{let s=C.fromDom(e),o=hs(s),a=C.fromPoint(o,t,n).filter(i=>yn(s,i)).getOr(s);return sq(s,a,t,n)},Lk=(e,t,n)=>oq(e,t,n).filter(s=>ma(s.node)).map(s=>tq(s,t)),$k=e=>{var t,n;let s=e.getBoundingClientRect(),o=e.ownerDocument,r=o.documentElement,a=o.defaultView;return{top:s.top+((t=a?.scrollY)!==null&&t!==void 0?t:0)-r.clientTop,left:s.left+((n=a?.scrollX)!==null&&n!==void 0?n:0)-r.clientLeft}},rq=e=>e.inline?$k(e.getBody()):{left:0,top:0},aq=e=>{let t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},iq=e=>{let t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},lq=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){let n=$k(e.getContentAreaContainer()),s=iq(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},cq=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),uq=(e,t)=>cq(rq(e),aq(e),lq(e,t)),Mk=e=>({target:e,srcElement:e}),fq=(e,t,n,s)=>Q(we(Q({},t),{dataTransfer:s,type:e}),Mk(n)),dq=(e,t,n)=>{let s=ug("Function not supported on simulated event.");return Q({bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:s,initEvent:s,preventDefault:ce,stopImmediatePropagation:ce,stopPropagation:ce,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,layerX:0,layerY:0,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:s,initMouseEvent:s,getModifierState:s,dataTransfer:n},Mk(t))},mq=(e,t)=>{let n=PV(e);return t==="dragstart"?(ew(n),nw(n)):t==="drop"?(wV(n),hm(n)):(kV(n),NV(n)),n},gq=(e,t,n,s)=>{let o=mq(n,e);return rt(s)?dq(e,t,o):fq(e,s,t,o)},ac=32,pq=100,ic=8,lc=16,Uk=Re,hq=NT(Uk,cn),bq=(e,t,n)=>Uk(n)&&n!==t&&e.isEditable(n.parentElement),Cq=(e,t,n)=>qe(t)||t===n||e.dom.isChildOf(t,n)?!1:e.dom.isEditable(t),yq=(e,t,n,s)=>{let o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);let a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},vq=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},cc=(e,t)=>n=>()=>{let s=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:s+t,behavior:"smooth"})},zk=cc("left",-ac),Hk=cc("left",ac),Wk=cc("top",-ac),Vk=cc("top",ac),Eq=(e,t,n,s,o,r,a,i,l,c,u,f)=>{let d=0,g=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(d=t.pageX+n-o),t.pageY+s>r&&(g=t.pageY+s-r),e.style.width=n-d+"px",e.style.height=s-g+"px";let h=l.clientHeight,p=l.clientWidth,b=a+l.getBoundingClientRect().top,y=i+l.getBoundingClientRect().left;u.on(v=>{v.intervalId.clear(),v.dragging&&f&&(a+ic>=h?v.intervalId.set(Vk(c)):a-ic<=0?v.intervalId.set(Wk(c)):i+ic>=p?v.intervalId.set(Hk(c)):i-ic<=0?v.intervalId.set(zk(c)):b+lc>=window.innerHeight?v.intervalId.set(Vk(window)):b-lc<=0?v.intervalId.set(Wk(window)):y+lc>=window.innerWidth?v.intervalId.set(Hk(window)):y-lc<=0&&v.intervalId.set(zk(window)))})},jk=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},Sq=(e,t)=>{let n=e.getParent(t.parentNode,e.isBlock);jk(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&ks(C.fromDom(n))},wq=e=>e.button===0,kq=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),_q=(e,t)=>n=>{if(wq(n)){let s=Ze(t.dom.getParents(n.target),hq).getOr(null);if(U(s)&&bq(t.dom,t.getBody(),s)){let o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dataTransfer:bm(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:yq(t,s,s.offsetWidth,s.offsetHeight),intervalId:kA(pq)})}}},Aq=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),Lk(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),s=>{let o=e._selectionOverrides.showCaret(1,s.node,s.position===Xa.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,n)})},Za=(e,t,n,s,o)=>{t==="dragstart"&&rw(s,e.dom.getOuterHTML(n));let r=gq(t,n,s,o);return e.dispatch(t,r)},xq=(e,t)=>{let n=gi((o,r)=>Aq(t,o,r),0);t.on("remove",n.cancel);let s=e;return o=>e.on(r=>{let a=Math.max(Math.abs(o.screenX-r.screenX),Math.abs(o.screenY-r.screenY));if(!r.dragging&&a>10){let i=Za(t,"dragstart",r.element,r.dataTransfer,o);if(U(i.dataTransfer)&&(r.dataTransfer=i.dataTransfer),i.isDefaultPrevented())return;r.dragging=!0,t.focus()}if(r.dragging){let i=o.currentTarget===t.getDoc().documentElement,l=kq(r,uq(t,o));vq(r.ghost,t.getBody()),Eq(r.ghost,l,r.width,r.height,r.maxX,r.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),s,i),n.throttle(o.clientX,o.clientY)}})},Nq=e=>{let t=e.getSel();if(U(t)){let s=t.getRangeAt(0).startContainer;return F(s)?s.parentNode:s}else return null},Rq=(e,t)=>n=>{e.on(s=>{var o;if(s.intervalId.clear(),s.dragging){if(Cq(t,Nq(t.selection),s.element)){let r=(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))!==null&&o!==void 0?o:t.getBody();Za(t,"drop",r,s.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{Sq(t.dom,s.element),BV(s.dataTransfer).each(i=>t.insertContent(i)),t._selectionOverrides.hideFakeCaret()})}Za(t,"dragend",t.getBody(),s.dataTransfer,n)}}),Kk(e)},qk=(e,t,n)=>{e.on(s=>{s.intervalId.clear(),s.dragging&&n.fold(()=>Za(t,"dragend",s.element,s.dataTransfer),o=>Za(t,"dragend",s.element,s.dataTransfer,o))}),Kk(e)},Tq=(e,t)=>n=>qk(e,t,m.some(n)),Kk=e=>{e.on(t=>{t.intervalId.clear(),jk(t.ghost)}),e.clear()},Dq=e=>{let t=Jn(),n=xe.DOM,s=document,o=_q(t,e),r=xq(t,e),a=Rq(t,e),i=Tq(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===j.ESC&&qk(t,e,m.none())})},Pq=e=>{let t=o=>{if(!o.isDefaultPrevented()){let r=o.dataTransfer;r&&(ke(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&Pl(e,"Dropped file type is not supported"))}},n=o=>{rl(e,o.target)&&t(o)},s=()=>{let o=xe.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),l=["drop","dragover"];D(l,c=>{o.bind(a,c,n),r.bind(i,c,t)}),e.on("remove",()=>{D(l,c=>{o.unbind(a,c,n),r.unbind(i,c,t)})})};e.on("init",()=>{tn.setEditorTimeout(e,s,0)})},Bq=e=>{Dq(e),SP(e)&&Pq(e)},Oq=e=>{let t=gi(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){let n=e.selection.getRng();if(n.collapsed){let s=qd(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},Iq=e=>{e.on("init",()=>{e.on("focusin",t=>{let n=t.target;if(Un(n)){let s=po(e.getBody(),n),o=Re(s)?s:n;e.selection.getNode()!==o&&Ma(e,o).each(r=>e.selection.setRng(r))}})})},Qa=Re,Gk=(e,t)=>po(e.getBody(),t),Fq=e=>{let t=e.selection,n=e.dom,s=e.getBody(),o=hB(e,s,n.isBlock,()=>sr(e)),r="sel-"+n.uniqueId(),a="data-mce-selected",i,l=H=>U(H)&&n.hasClass(H,"mce-offscreen-selection"),c=H=>H!==s&&(Qa(H)||Un(H))&&n.isChildOf(H,s)&&n.isEditable(H.parentNode),u=H=>{H&&t.setRng(H)},f=(H,x,_,P=!0)=>e.dispatch("ShowCaret",{target:x,direction:H,before:_}).isDefaultPrevented()?null:(P&&t.scrollIntoView(x,H===-1),o.show(_,x)),d=H=>{H.hasAttribute("data-mce-caret")&&(Iu(H),t.scrollIntoView(H))},g=()=>{e.on("click",x=>{n.isEditable(x.target)||(x.preventDefault(),e.focus())}),e.on("blur NewBlock",w),e.on("ResizeWindow FullscreenStateChanged",o.reposition),e.on("tap",x=>{let _=x.target,P=Gk(e,_);Qa(P)?(x.preventDefault(),Ma(e,P).each(E)):c(_)&&Ma(e,_).each(E)},!0),e.on("mousedown",x=>{let _=x.target;if(_!==s&&_.nodeName!=="HTML"&&!n.isChildOf(_,s)||!wz(e,x.clientX,x.clientY))return;w(),B();let P=Gk(e,_);Qa(P)?(x.preventDefault(),Ma(e,P).each(E)):Lk(s,x.clientX,x.clientY).each(z=>{x.preventDefault();let X=f(1,z.node,z.position===Xa.Before,!1);u(X),$n(P)?P.focus():e.getBody().focus()})}),e.on("keypress",x=>{j.modifierPressed(x)||Qa(t.getNode())&&x.preventDefault()}),e.on("GetSelectionRange",x=>{let _=x.range;if(i){if(!i.parentNode){i=null;return}_=_.cloneRange(),_.selectNode(i),x.range=_}}),e.on("focusin",x=>{if(o.isShowing()&&e.getBody().contains(x.target)&&x.target!==e.getBody()&&!e.dom.isEditable(x.target.parentNode)){o.hide(),x.target.contains(e.selection.getNode())||(e.selection.select(x.target,!0),e.selection.collapse(!0));let _=E(e.selection.getRng(),!0);_&&e.selection.setRng(_)}}),e.on("SetSelectionRange",x=>{x.range=b(x.range);let _=E(x.range,x.forward);_&&(x.range=_)});let H=x=>q(x)&&x.id==="mcepastebin";e.on("AfterSetSelectionRange",x=>{let _=x.range,P=_.startContainer.parentElement;!p(_)&&!H(P)&&B(),l(P)||w()}),Bq(e),Oq(e),Iq(e)},h=H=>Xt(H)||$i(H)||Mi(H),p=H=>h(H.startContainer)||h(H.endContainer),b=H=>{let x=e.schema.getVoidElements(),_=n.createRng(),P=H.startContainer,z=H.startOffset,X=H.endContainer,re=H.endOffset;return oe(x,P.nodeName.toLowerCase())?z===0?_.setStartBefore(P):_.setStartAfter(P):_.setStart(P,z),oe(x,X.nodeName.toLowerCase())?re===0?_.setEndBefore(X):_.setEndAfter(X):_.setEnd(X,re),_},y=(H,x)=>{let _=C.fromDom(e.getBody()),P=e.getDoc(),z=wi(_,"#"+r).getOrThunk(()=>{let ie=C.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',P);return at(ie,"id",r),Ke(_,ie),ie}),X=n.createRng();Po(z),js(z,[C.fromText(Je,P),C.fromDom(x),C.fromText(Je,P)]),X.setStart(z.dom.firstChild,1),X.setEnd(z.dom.lastChild,0),vi(z,{top:n.getPos(H,e.getBody()).y+"px"}),gp(z);let re=t.getSel();return re&&(re.removeAllRanges(),re.addRange(X)),X},v=H=>{let x=H.cloneNode(!0),_=e.dispatch("ObjectSelected",{target:H,targetClone:x});if(_.isDefaultPrevented())return null;let P=y(H,_.targetClone),z=C.fromDom(H);return D(mt(C.fromDom(e.getBody()),`*[${a}]`),X=>{Se(z,X)||it(X,a)}),n.getAttrib(H,a)||H.setAttribute(a,"1"),i=H,B(),P},E=(H,x)=>{if(!H)return null;if(H.collapsed){if(!p(H)){let X=x?1:-1,re=ba(X,s,H),ie=re.getNode(!x);if(U(ie)){if(ma(ie))return f(X,ie,x?!re.isAtEnd():!1,!1);if(_s(ie)&&Re(ie.nextSibling)){let Ee=n.createRng();return Ee.setStart(ie,0),Ee.setEnd(ie,0),Ee}}let pe=re.getNode(x);if(U(pe)){if(ma(pe))return f(X,pe,x?!1:!re.isAtEnd(),!1);if(_s(pe)&&Re(pe.previousSibling)){let Ee=n.createRng();return Ee.setStart(pe,1),Ee.setEnd(pe,1),Ee}}}return null}let _=H.startContainer,P=H.startOffset,z=H.endOffset;if(F(_)&&P===0&&Qa(_.parentNode)&&(_=_.parentNode,P=n.nodeIndex(_),_=_.parentNode),!q(_))return null;if(z===P+1&&_===H.endContainer){let X=_.childNodes[P];if(c(X))return v(X)}return null},w=()=>{i&&i.removeAttribute(a),wi(C.fromDom(e.getBody()),"#"+r).each(Te),i=null},T=()=>{o.destroy(),i=null},B=()=>{o.hide()};return qn(e)||g(),{showCaret:f,showBlockCaretContainer:d,hideFakeCaret:B,destroy:T}},Lq=(e,t)=>{let n=t;for(let s=e.previousSibling;F(s);s=s.previousSibling)n+=s.data.length;return n},Yk=(e,t,n,s,o)=>{if(F(n)&&(s<0||s>n.data.length))return[];let r=o&&F(n)?[Lq(n,s)]:[s],a=n;for(;a!==t&&a.parentNode;)r.push(e.nodeIndex(a,o)),a=a.parentNode;return a===t?r.reverse():[]},Mm=(e,t,n,s,o,r,a=!1)=>{let i=Yk(e,t,n,s,a),l=Yk(e,t,o,r,a);return{start:i,end:l}},Xk=(e,t)=>{let n=t.slice(),s=n.pop();return ln(s)?Pt(n,(r,a)=>r.bind(i=>m.from(i.childNodes[a])),m.some(e)).bind(r=>F(r)&&(s<0||s>r.data.length)?m.none():m.some({node:r,offset:s})):m.none()},Zk=(e,t)=>Xk(e,t.start).bind(({node:n,offset:s})=>Xk(e,t.end).map(({node:o,offset:r})=>{let a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),$q=(e,t,n,s=!1)=>Mm(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,s),mr=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){let s=t.parentNode;e.remove(t,F(t.firstChild)&&$o(t.firstChild.data)),mr(e,s,n)}},uc=(e,t,n,s=!0)=>{let o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(F(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),F(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),mr(e,o,n),o!==r&&mr(e,r,n))},fc=(e,t)=>m.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),Um=(e,t,n)=>{let s=e.dynamicPatternsLookup({text:n,block:t});return we(Q({},e),{blockPatterns:ab(s).concat(e.blockPatterns),inlinePatterns:ib(s).concat(e.inlinePatterns)})},zm=(e,t,n,s)=>{let o=e.createRng();return o.setStart(t,0),o.setEnd(n,s),o.toString()},Qk=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),dc=(e,t)=>{let n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},Jk=(e,t,n)=>{let s=Zk(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset),l=i.parentNode,c=a.parentNode;return{prefix:t,end:c.insertBefore(Qk(e,t+"-end"),a),start:l.insertBefore(Qk(e,t+"-start"),i)}},e_=(e,t,n)=>{mr(e,e.get(t.prefix+"-end"),n),mr(e,e.get(t.prefix+"-start"),n)},Hm=e=>e.start.length===0,Mq=e=>(t,n)=>{let o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},t_=(e,t,n,s)=>{let o=t.start;return Em(e,s.container,s.offset,Mq(o),n).bind(a=>{var i,l;let c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(o))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+o.length){let f=e.createRng();return f.setStart(a.container,a.offset-o.length),f.setEnd(a.container,a.offset),m.some(f)}else{let f=a.offset-o.length;return vm(a.container,f,n).map(d=>{let g=e.createRng();return g.setStart(d.container,d.offset),g.setEnd(a.container,a.offset),g}).filter(d=>d.toString()===o).orThunk(()=>t_(e,t,n,An(a.container,0)))}})},Uq=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){let a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),m.some(a)}return ym(n,s,o).bind(a=>t_(e,t,o,a).bind(l=>{var c;if(r){if(l.endContainer===a.container&&l.endOffset===a.offset)return m.none();if(a.offset===0&&((c=l.endContainer.textContent)===null||c===void 0?void 0:c.length)===l.endOffset)return m.none()}return m.some(l)}))},zq=(e,t,n,s)=>{let o=e.dom,r=o.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return vm(i,l-n.pattern.end.length,t).bind(c=>{let u=Mm(o,r,c.container,c.offset,i,l,s);if(Hm(a))return m.some({matches:[{pattern:a,startRng:u,endRng:u}],position:c});{let f=mc(e,n.remainingPatterns,c.container,c.offset,t,s),d=f.getOr({matches:[],position:c}),g=d.position;return Uq(o,a,g.container,g.offset,t,f.isNone()).map(p=>{let b=$q(o,r,p,s);return{matches:d.matches.concat([{pattern:a,startRng:b,endRng:u}]),position:An(p.startContainer,p.startOffset)}})}})},mc=(e,t,n,s,o,r)=>{let a=e.dom;return ym(n,s,a.getRoot()).bind(i=>{let l=zm(a,o,n,s);for(let c=0;c<t.length;c++){let u=t[c];if(!Dc(l,u.end))continue;let f=t.slice();f.splice(c,1);let d=zq(e,o,{pattern:u,remainingPatterns:f,position:i},r);if(d.isNone()&&s>0)return mc(e,t,n,s-1,o,r);if(d.isSome())return d}return m.none()})},n_=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?D(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},Hq=(e,t,n,s)=>{let o=dc(e.dom,n);uc(e.dom,o,s),n_(e,t,o)},Wq=(e,t,n,s,o)=>{let r=e.dom,a=dc(r,s),i=dc(r,n);uc(r,i,o),uc(r,a,o);let l={prefix:n.prefix,start:n.end,end:s.start},c=dc(r,l);n_(e,t,c)},Vq=(e,t)=>{let n=Tr("mce_textpattern"),s=_r(t,(o,r)=>{let a=Jk(e,n+`_end${o.length}`,r.endRng);return o.concat([we(Q({},r),{endMarker:a})])},[]);return _r(s,(o,r)=>{let a=s.length-o.length-1,i=Hm(r.pattern)?r.endMarker:Jk(e,n+`_start${a}`,r.startRng);return o.concat([we(Q({},r),{startMarker:i})])},[])},jq=e=>Hs(e,(t,n)=>n.end.length-t.end.length),qq=(e,t)=>{let n=Qn(e,s=>Ie(t,o=>s.pattern.start===o.pattern.start&&s.pattern.end===o.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},s_=(e,t,n,s,o,r)=>{let a=mc(e,o.inlinePatterns,n,s,t,r).fold(()=>[],l=>l.matches),i=mc(e,jq(o.inlinePatterns),n,s,t,r).fold(()=>[],l=>l.matches);return qq(a,i)},o_=(e,t)=>{if(t.length===0)return;let n=e.dom,s=e.selection.getBookmark(),o=Vq(n,t);D(o,r=>{let a=n.getParent(r.startMarker.start,n.isBlock),i=l=>l===a;Hm(r.pattern)?Hq(e,r.pattern,r.endMarker,i):Wq(e,r.pattern,r.startMarker,r.endMarker,i),e_(n,r.endMarker,i),e_(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},r_=(e,t,n)=>c3(t,0,t).map(s=>{let o=s.container;return hw(o,n.start.length,t).each(r=>{let a=e.createRng();a.setStart(o,0),a.setEnd(r.container,r.offset),uc(e,a,i=>i===t)}),o}),a_=e=>(t,n)=>{let s=t.dom,o=n.pattern,r=Zk(s.getRoot(),n.range).getOrDie("Unable to resolve path range"),a=(i,l)=>{let c=l.get(i);return Be(c)&&xt(c).exists(u=>oe(u,"block"))};return fc(t,r).each(i=>{o.type==="block-format"?a(o.format,t.formatter)&&t.undoManager.transact(()=>{e(t.dom,i,o),t.formatter.apply(o.format)}):o.type==="block-command"&&t.undoManager.transact(()=>{e(t.dom,i,o),t.execCommand(o.cmd,!1,o.value)})}),!0},Kq=e=>Hs(e,(t,n)=>n.start.length-t.start.length),i_=e=>(t,n)=>{let s=Kq(t),o=n.replace(Je," ");return Ze(s,r=>e(r,n,o))},l_=(e,t)=>(n,s,o,r,a)=>{var i;a===void 0&&(a=(i=s.textContent)!==null&&i!==void 0?i:"");let l=n.dom,c=pt(n);return l.is(s,c)?e(o.blockPatterns,a).map(u=>t&&L.trim(a).length===u.start.length?[]:[{pattern:u,range:Mm(l,l.getRoot(),s,0,s,0,r)}]).getOr([]):[]},Gq=e=>/^\s[^\s]/.test(e),Yq=a_((e,t,n)=>{r_(e,t,n).each(s=>{let o=C.fromDom(s),r=jr(o);Gq(r)&&Rp(o,r.slice(1))})}),Xq=i_((e,t,n)=>t.indexOf(e.start)===0||n.indexOf(e.start)===0),Zq=l_(Xq,!0),Qq=(e,t)=>{let n=e.selection.getRng();return fc(e,n).map(s=>{var o;let r=Math.max(0,n.startOffset),a=Um(t,s,(o=s.textContent)!==null&&o!==void 0?o:""),i=s_(e,s,n.startContainer,r,a,!0),l=Zq(e,s,a,!0);return{inlineMatches:i,blockMatches:l}}).filter(({inlineMatches:s,blockMatches:o})=>o.length>0||s.length>0)},Jq=(e,t)=>{if(t.length===0)return;let n=e.selection.getBookmark();D(t,s=>Yq(e,s)),e.selection.moveToBookmark(n)},e9=a_(r_),t9=i_((e,t,n)=>t===e.start||n===e.start),n9=l_(t9,!1),s9=(e,t)=>{let n=e.selection.getRng();return fc(e,n).map(s=>{let o=Math.max(0,n.startOffset),r=zm(e.dom,s,n.startContainer,o),a=Um(t,s,r);return n9(e,s,a,!1,r)}).filter(s=>s.length>0)},o9=(e,t)=>{D(t,n=>e9(e,n))},r9=(e,t)=>Qq(e,t).fold(Oe,({inlineMatches:n,blockMatches:s})=>(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{bT(e),o_(e,n),Jq(e,s);let o=e.selection.getRng(),r=ym(o.startContainer,o.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),r.each(a=>{let i=a.container;i.data.charAt(a.offset-1)===Pr&&(i.deleteData(a.offset-1,1),mr(e.dom,i.parentNode,l=>l===e.dom.getRoot()))})}),!0)),a9=(e,t)=>{let n=e.selection.getRng();fc(e,n).map(s=>{let o=Math.max(0,n.startOffset-1),r=zm(e.dom,s,n.startContainer,o),a=Um(t,s,r),i=s_(e,s,n.startContainer,o,a,!1);i.length>0&&e.undoManager.transact(()=>{o_(e,i)})})},i9=(e,t)=>s9(e,t).fold(Oe,n=>(e.undoManager.transact(()=>{o9(e,n)}),!0)),c_=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},l9=(e,t)=>c_(e,t,(n,s)=>n===s.keyCode&&!j.modifierPressed(s)),c9=(e,t)=>c_(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),u9=e=>{let t=[",",".",";",":","!","?"],n=[32],s=()=>cD(HP(e).filter(a=>a.type==="inline-command"||a.type==="block-command"?e.queryCommandSupported(a.cmd):!0),WP(e)),o=()=>YP(e);e.on("keydown",a=>{if(a.keyCode===13&&!j.modifierPressed(a)&&e.selection.isCollapsed()&&e.selection.isEditable()){let i=ju(s(),"enter");(i.inlinePatterns.length>0||i.blockPatterns.length>0||o())&&r9(e,i)&&a.preventDefault()}},!0),e.on("keydown",a=>{if(a.keyCode===32&&e.selection.isCollapsed()&&e.selection.isEditable()){let i=ju(s(),"space");(i.blockPatterns.length>0||o())&&i9(e,i)&&a.preventDefault()}},!0);let r=()=>{if(e.selection.isCollapsed()&&e.selection.isEditable()){let a=ju(s(),"space");(a.inlinePatterns.length>0||o())&&a9(e,a)}};e.on("keyup",a=>{l9(n,a)&&r()}),e.on("keypress",a=>{c9(t,a)&&tn.setEditorTimeout(e,r)})},f9=e=>{u9(e)},d9=e=>{let t=L.each,n=j.BACKSPACE,s=j.DELETE,o=e.dom,r=e.selection,a=e.parser,i=ye.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),u=ye.deviceType.isiPhone()||ye.deviceType.isiPad(),f=ye.os.isMacOS()||ye.os.isiOS(),d=(R,O)=>{try{e.getDoc().execCommand(R,!1,String(O))}catch{}},g=R=>R.isDefaultPrevented(),h=()=>{let R=K=>{let le=o.create("body"),ue=K.cloneContents();return le.appendChild(ue),r.serializer.serialize(le,{format:"html"})},O=K=>{let le=R(K),ue=o.createRng();ue.selectNode(e.getBody());let ve=R(ue);return le===ve};e.on("keydown",K=>{let le=K.keyCode;if(!g(K)&&(le===s||le===n)&&e.selection.isEditable()){let ue=e.selection.isCollapsed(),ve=e.getBody();if(ue&&!as(e.schema,ve)||!ue&&!O(e.selection.getRng()))return;K.preventDefault(),e.setContent(""),ve.firstChild&&o.isBlock(ve.firstChild)?e.selection.setCursorLocation(ve.firstChild,0):e.selection.setCursorLocation(ve,0),e.nodeChanged()}})},p=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},b=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",R=>{let O;if(R.target===e.getDoc().documentElement)if(O=r.getRng(),e.getBody().focus(),R.type==="mousedown"){if(Xt(O.startContainer))return;r.placeCaretAt(R.clientX,R.clientY)}else r.setRng(O)})},y=()=>{e.on("keydown",R=>{if(!g(R)&&R.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){let O=r.getNode(),K=O.previousSibling;if(O.nodeName==="HR"){o.remove(O),R.preventDefault();return}K&&K.nodeName&&K.nodeName.toLowerCase()==="hr"&&(o.remove(K),R.preventDefault())}}})},v=()=>{Range.prototype.getClientRects||e.on("mousedown",R=>{if(!g(R)&&R.target.nodeName==="HTML"){let O=e.getBody();O.blur(),tn.setEditorTimeout(e,()=>{O.focus()})}})},E=()=>{let R=Rb(e);e.on("click",O=>{let K=O.target;/^(IMG|HR)$/.test(K.nodeName)&&o.isEditable(K)&&(O.preventDefault(),e.selection.select(K),e.nodeChanged()),K.nodeName==="A"&&o.hasClass(K,R)&&K.childNodes.length===0&&o.isEditable(K.parentNode)&&(O.preventDefault(),r.select(K))})},w=()=>{let R=O=>O.nodeName==="IMG"&&e.dom.isEditable(O);e.on("mousedown",O=>{ct(m.from(O.clientX),m.from(O.clientY),(K,le)=>{let ue=e.getDoc().caretPositionFromPoint(K,le);if(ue&&R(ue.offsetNode)){let ve=ue.offsetNode.getBoundingClientRect();O.preventDefault(),e.hasFocus()||e.focus(),e.selection.select(ue.offsetNode),O.clientX<ve.left||O.clientY<ve.top?e.selection.collapse(!0):(O.clientX>ve.right||O.clientY>ve.bottom)&&e.selection.collapse(!1)}})})},T=()=>{let R=()=>{let K=o.getAttribs(r.getStart().cloneNode(!1));return()=>{let le=r.getStart();le!==e.getBody()&&(o.setAttrib(le,"style",null),t(K,ue=>{le.setAttributeNode(ue.cloneNode(!0))}))}},O=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",K=>{let le;return!g(K)&&(K.keyCode===8||K.keyCode===46)&&O()?(le=R(),e.getDoc().execCommand("delete",!1),le(),K.preventDefault(),!1):!0}),o.bind(e.getDoc(),"cut",K=>{if(!g(K)&&O()){let le=R();tn.setEditorTimeout(e,()=>{le()})}})},B=()=>{e.on("keydown",R=>{if(!g(R)&&R.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){let O=r.getNode().previousSibling;if(O&&O.nodeName&&O.nodeName.toLowerCase()==="table")return R.preventDefault(),!1}return!0})},H=()=>{e.on("keydown",R=>{if(g(R)||R.keyCode!==j.BACKSPACE)return;let O=r.getRng(),K=O.startContainer,le=O.startOffset,ue=o.getRoot(),ve=K;if(!(!O.collapsed||le!==0)){for(;ve.parentNode&&ve.parentNode.firstChild===ve&&ve.parentNode!==ue;)ve=ve.parentNode;ve.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,ve),O=o.createRng(),O.setStart(K,0),O.setEnd(K,0),r.setRng(O))}})},x=()=>{let R=()=>{d("StyleWithCSS",!1),d("enableInlineTableEditing",!1),_b(e)||d("enableObjectResizing",!1)};xb(e)||e.on("BeforeExecCommand mousedown",R)},_=()=>{let R=()=>{t(o.select("a:not([data-mce-block])"),O=>{var K;let le=O.parentNode,ue=o.getRoot();if(le?.lastChild===O){for(;le&&!o.isBlock(le);){if(((K=le.parentNode)===null||K===void 0?void 0:K.lastChild)!==le||le===ue)return;le=le.parentNode}o.add(le,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",O=>{(O.type==="setcontent"||O.command==="mceInsertLink")&&R()})},P=()=>{e.on("init",()=>{d("DefaultParagraphSeparator",pt(e))})},z=R=>{let O=R.getBody(),K=R.selection.getRng();return K.startContainer===K.endContainer&&K.startContainer===O&&K.startOffset===0&&K.endOffset===O.childNodes.length},X=()=>{e.on("keyup focusin mouseup",R=>{!j.modifierPressed(R)&&!z(e)&&r.normalize()},!0)},re=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},ie=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},pe=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",R=>{let O;R.target.nodeName==="HTML"&&(O=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(O),e.selection.normalize(),e.nodeChanged())}))},Ee=()=>{f&&e.on("keydown",R=>{j.metaKeyPressed(R)&&!R.shiftKey&&(R.keyCode===37||R.keyCode===39)&&(R.preventDefault(),e.selection.getSel().modify("move",R.keyCode===37?"backward":"forward","lineboundary"))})},Ue=()=>{e.on("click",R=>{let O=R.target;do if(O.tagName==="A"){R.preventDefault();return}while(O=O.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},We=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",R=>{R.preventDefault()})})},Ye=()=>{a.addNodeFilter("br",R=>{let O=R.length;for(;O--;)R[O].attr("class")==="Apple-interchange-newline"&&R[O].remove()})},M=ce,Y=()=>{if(!l||e.removed)return!1;let R=e.selection.getSel();return!R||!R.rangeCount||R.rangeCount===0},ge=()=>{c&&(b(),E(),We(),p(),u&&(ie(),pe(),Ue())),l&&(v(),x(),re(),Ee())},he=()=>{H(),h(),ye.windowsPhone||X(),c&&(b(),E(),P(),We(),B(),Ye(),u?(ie(),pe(),Ue()):p()),l&&(w(),y(),v(),T(),x(),_(),re(),Ee(),B())};return qn(e)?ge():he(),{refreshContentEditable:M,isHidden:Y}},m9=e=>e.toLowerCase()==="gpl",g9=e=>e.length>=64&&e.length<=255,p9=e=>m9(e)||g9(e)?"VALID":"INVALID",h9=e=>{let t=sB(e);!ee(oB(e))&&(rt(t)||p9(t)==="INVALID")&&console.warn("TinyMCE is running in evaluation mode. Provide a valid license key or add license_key: 'gpl' to the init config to agree to the open source license terms. Read more at https://www.tiny.cloud/license-key/")},Wm=xe.DOM,b9=(e,t)=>{let n=C.fromDom(e.getBody()),s=jc(Cs(n)),o=C.fromTag("style");at(o,"type","text/css"),Ke(o,C.fromText(t)),Ke(s,o),e.on("remove",()=>{Te(o)})},C9=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,Vm=e=>Rr(e,t=>rt(t)===!1),u_=e=>{let t=e.options.get,n=e.editorUpload.blobCache;return Vm({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_mathml_annotation_encodings:t("allow_mathml_annotation_encodings"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_unsafe_embeds:t("convert_unsafe_embeds"),convert_fonts_to_spans:t("convert_fonts_to_spans"),extended_mathml_attributes:t("extended_mathml_attributes"),extended_mathml_elements:t("extended_mathml_elements"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:C9(e),sandbox_iframes:t("sandbox_iframes"),sandbox_iframes_exclusions:Zu(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},f_=e=>{let t=e.options.get;return Vm({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},y9=e=>{let t=e.options.get;return Q(Q(Q({},u_(e)),f_(e)),Vm({remove_trailing_brs:t("remove_trailing_brs"),pad_empty_with_br:t("pad_empty_with_br"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")}))},v9=e=>{let t=rr(u_(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{let o=e.dom,r="data-mce-"+s,a=n.length;for(;a--;){let i=n[a],l=i.attr(s);if(l&&!i.attr(r)){if(l.indexOf("data:")===0||l.indexOf("blob:")===0)continue;s==="style"?(l=o.serializeStyle(o.parseStyle(l),i.name),l.length||(l=null),i.attr(r,l),i.attr(s,l)):s==="tabindex"?(i.attr(r,l),i.attr(s,null)):i.attr(r,e.convertURL(l,s,i.name))}}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){let o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),qP(e)&&t.addNodeFilter("#cdata",n=>{var s;let o=n.length;for(;o--;){let r=n[o];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode((s=r.value)!==null&&s!==void 0?s:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length,o=e.schema.getNonEmptyElements();for(;s--;){let r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new Et("br",1))}}),t},E9=e=>{let t=NP(e);t&&tn.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},S9=e=>{let t=e.dom.getRoot();!e.inline&&(!el(e)||e.selection.getStart(!0)===t)&&ht(t).each(n=>{let s=n.getNode(),o=Mn(s)?ht(s).getOr(n):n;e.selection.setRng(o.toRange())})},w9=e=>{e.bindPendingEventDelegates(),e.initialized=!0,vD(e),e.focus(!0),S9(e),e.nodeChanged({initial:!0});let t=AP(e);_e(t)&&t.call(e,e),E9(e),cs(e)&&cS(e,!0)},jm=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,k9=(e,t,n)=>{let{pass:s,fail:o}=_o(t,i=>tinymce.Resource.has(zd(i))),a=[...s.map(i=>{let l=tinymce.Resource.get(zd(i));return ee(l)?Promise.resolve(jm(e).loadRawCss(i,l)):Promise.resolve()}),jm(e).loadAll(o)];return e.inline?a:a.concat([e.ui.styleSheetLoader.loadAll(n)])},d_=e=>{let t=jm(e),n=kb(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let l="";L.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}let a=Promise.all(k9(e,s,n)).then(r).catch(r),i=tP(e);return i&&b9(e,i),a},_9=e=>{let t=e.getDoc(),n=e.getBody();CD(e),RP(e)||(t.body.spellcheck=!1,Wm.setAttrib(n,"spellcheck","false")),e.quirks=d9(e),yD(e);let s=nP(e);s!==void 0&&(n.dir=s);let o=TP(e);o&&e.on("BeforeSetContent",r=>{L.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},A9=e=>{qn(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},qm=e=>{e.removed!==!0&&(A9(e),w9(e))},x9=e=>{let t=!1,n=setTimeout(()=>{t||e.setProgressState(!0)},500);return()=>{clearTimeout(n),t=!0,e.setProgressState(!1)}},m_=e=>{let t=e.getElement(),n=e.getDoc();e.inline&&(Wm.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);let s=e.getBody();s.disabled=!0,e.readonly=xb(e),e._editableRoot=vP(e),!Ki(e)&&e.hasEditableRoot()&&(e.inline&&Wm.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=cH(e),e.schema=ws(f_(e)),e.dom=xe(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:ZD(e),referrerPolicy:Gu(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=v9(e),e.serializer=ZE(y9(e),e),e.selection=XE(e.dom,e.getWin(),e.serializer,e),e.annotator=xC(e),e.formatter=bS(e),e.undoManager=yS(e),e._nodeChangeDispatcher=new Fj(e),e._selectionOverrides=Fq(e),FW(e),z4(e),jW(e),qn(e)||(G4(e),f9(e));let o=Ij(e);BW(e,o),zW(e),kH(e),$4(e);let r=eU(e);_9(e),h9(e),r.fold(()=>{let a=x9(e);d_(e).then(()=>{qm(e),a()})},a=>{e.setProgressState(!0),d_(e).then(()=>{a().then(i=>{e.setProgressState(!1),qm(e),jE(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),qm(e),jE(e)})})})},Km=xe.DOM,N9=(e,t,n,s)=>{let o=C.fromTag("iframe");return s.each(r=>at(o,"tabindex",r)),ns(o,n),ns(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),Fo(o,"tox-edit-area__iframe"),o},R9=e=>{let t=FD(e)+"<html><head>";bb(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';let n=LD(e),s=$D(e),o=e.translate(Tb(e));return Cb(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+Cb(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},T9=(e,t)=>{let n=ye.browser.isFirefox()?Tb(e):"Rich Text Area",s=e.translate(n),o=ss(C.fromDom(e.getElement()),"tabindex").bind(mi),r=N9(e.id,s,ID(e),o).dom;r.onload=()=>{r.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=R9(e),Km.add(t.iframeContainer,r)},D9=e=>{let t=e.iframeElement,n=()=>{e.contentDocument=t.contentDocument,m_(e)};if(GP(e)||ye.browser.isFirefox()){let s=e.getDoc();s.open(),s.write(e.iframeHTML),s.close(),n()}else{let s=Tx(C.fromDom(t),"load",()=>{s.unbind(),n()});t.srcdoc=e.iframeHTML}},P9=(e,t)=>{T9(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=Km.isHidden(t.editorContainer)),e.getElement().style.display="none",Km.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,D9(e)},g_=xe.DOM,B9=(e,t,n)=>{let s=ir.get(n),o=ir.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=L.trim(n),s&&L.inArray(t,n)===-1){if(e.plugins[n])return;try{let r=s(e,o)||{};e.plugins[n]=r,_e(r.init)&&(r.init(e,o),t.push(n))}catch(r){Oz(e,n,r)}}},O9=e=>e.replace(/^\-/,""),I9=e=>{let t=[];D(ji(e),n=>{B9(e,t,O9(n))})},F9=e=>{let t=L.trim(Eb(e)),n=e.ui.registry.getAll().icons,s=Q(Q({},Dl.get("default").icons),Dl.get(t).icons);Ne(s,(o,r)=>{oe(n,r)||e.ui.registry.addIcon(r,o)})},L9=e=>{let t=Go(e);if(ee(t)){let n=Co.get(t);e.theme=n(e,Co.urls[t])||{},_e(e.theme.init)&&e.theme.init(e,Co.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},$9=e=>{let t=Yu(e),n=ar.get(t);e.model=n(e,ar.urls[t])},M9=e=>{let t=e.theme.renderUI;return t?t():h_(e)},U9=e=>{let t=e.getElement(),s=Go(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},p_=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),z9=e=>{let t=g_.create("div");return g_.insertAfter(t,e),p_(t,t)},h_=e=>{let t=e.getElement();return e.inline?p_(null):z9(t)},H9=e=>{let t=e.getElement();return e.orgDisplay=t.style.display,ee(Go(e))?M9(e):_e(Go(e))?U9(e):h_(e)},W9=(e,t)=>{let n={show:m.from(t.show).getOr(ce),hide:m.from(t.hide).getOr(ce),isEnabled:m.from(t.isEnabled).getOr(He),setEnabled:s=>{s&&(e.mode.get()==="readonly"||cs(e))||m.from(t.setEnabled).each(r=>r(s))}};e.ui=Q(Q({},e.ui),n)},V9=e=>J_(this,null,function*(){e.dispatch("ScriptsLoaded"),F9(e),L9(e),$9(e),I9(e);let t=yield H9(e);W9(e,m.from(t.api).getOr({})),e.editorContainer=t.editorContainer,Qz(e),e.inline?m_(e):P9(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})}),Eo=xe.DOM,b_=e=>e.charAt(0)==="-",j9=(e,t)=>{let n=Sb(t),s=QD(t);if(!Sn.hasCode(n)&&n!=="en"){let o=Pn(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{Dz(t,o,n)})}},q9=(e,t)=>{let n=Go(e);if(ee(n)&&!b_(n)&&!oe(Co.urls,n)){let s=iP(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;Co.load(n,o).catch(()=>{Pz(e,o,n)})}},K9=(e,t)=>{let n=Yu(e);if(n!=="plugin"&&!oe(ar.urls,n)){let s=lP(e),o=ee(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;ar.load(n,o).catch(()=>{Bz(e,o,n)})}},G9=e=>m.from(qD(e)).filter(Pn).map(t=>({url:t,name:m.none()})),C_=(e,t,n)=>m.from(t).filter(s=>Pn(s)&&!Dl.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:m.some(s)})),Y9=(e,t,n)=>{let s=C_(t,"default",n),o=G9(t).orThunk(()=>C_(t,Eb(t),""));D(yA([s,o]),r=>{e.add(r.url).catch(()=>{Tz(t,r.url,r.name.getOrUndefined())})})},X9=(e,t)=>{let n=(s,o)=>{ir.load(s,o).catch(()=>{Rz(e,o,s)})};Ne(EP(e),(s,o)=>{n(o,s),e.options.set("plugins",ji(e).concat(o))}),D(ji(e),s=>{s=L.trim(s),s&&!ir.urls[s]&&!b_(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},Z9=e=>{let t=Go(e);return!ee(t)||U(Co.get(t))},Q9=e=>{let t=Yu(e);return U(ar.get(t))},J9=(e,t)=>{let n=is.ScriptLoader,s=()=>{!e.removed&&Z9(e)&&Q9(e)&&V9(e)};q9(e,t),K9(e,t),j9(n,e),Y9(n,e,t),X9(e,t),n.loadQueue().then(s,s)},e6=(e,t)=>th.forElement(e,{contentCssCors:Nb(t),referrerPolicy:Gu(t)}),t6=e=>{let t=e.id;Sn.setCode(Sb(e));let n=()=>{Eo.unbind(window,"ready",n),e.render()};if(!Js.Event.domLoaded){Eo.bind(window,"ready",n);return}if(!e.getElement())return;let s=C.fromDom(e.getElement()),o=Cp(s);e.on("remove",()=>{dg(s.dom.attributes,a=>it(s,a.name)),ns(s,o)}),e.ui.styleSheetLoader=e6(s,e),Xu(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");let r=e.getElement().form||Eo.getParent(t,"form");r&&(e.formElement=r,gP(e)&&!iu(e.getElement())&&(Eo.insertAfter(Eo.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},Eo.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),pP(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=oS(e),e.notificationManager=sS(e),QP(e)&&e.on("GetContent",a=>{a.save&&(a.content=Eo.encode(a.content))}),hP(e)&&e.on("submit",()=>{e.initialized&&e.save()}),bP(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),J9(e,e.suffix)},n6=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,cs(e)||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),RD(e,t))},s6=e=>e._editableRoot,o6=(e,t)=>({sections:W(e),options:W(t)}),y_=bn().deviceType,v_=y_.isPhone(),r6=y_.isTablet(),Ja=e=>{if(qe(e))return[];{let t=Be(e)?e:e.split(/[ ,]/),n=be(t,To);return se(n,Pn)}},a6=(e,t)=>{let n=mA(t,(s,o)=>ke(e,o));return o6(n.t,n.f)},i6=(e,t,n={})=>{let s=e.sections(),o=Fe(s,t).getOr({});return L.extend({},n,o)},Gm=(e,t)=>oe(e.sections(),t),l6=(e,t)=>Gm(e,t)?e.sections()[t]:{},c6=(e,t)=>{let n={table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Fe(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},s={menubar:!1};return Q(Q({},n),t?s:{})},u6=(e,t)=>{var n;let s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?L.extend({},e.external_plugins,s):s},f6=(e,t)=>[...Ja(e),...Ja(t)],d6=(e,t,n,s)=>e&&Gm(t,"mobile")?s:n,m6=(e,t,n,s)=>{let o=Ja(n.forced_plugins),r=Ja(s.plugins),a=l6(t,"mobile"),i=a.plugins?Ja(a.plugins):r,l=d6(e,t,r,i),c=f6(o,l);return L.extend(s,{forced_plugins:o,plugins:c})},g6=(e,t)=>e&&Gm(t,"mobile"),p6=(e,t,n,s,o)=>{var r;let a=e?{mobile:c6((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=a6(["mobile"],di(a,o)),l=L.extend(n,s,i.options(),g6(e,i)?i6(i,"mobile"):{},{external_plugins:u6(s,i.options())});return m6(e,i,s,l)},h6=(e,t)=>{let n=Sg(t);return p6(v_||r6,v_,n,e,n)},b6=(e,t)=>_U(e,t),C6=e=>{let t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{D("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},y6=e=>{let t=n=>()=>{let s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return Ie(o,r=>U(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},v6=e=>{C6(e),y6(e)},E6=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{let n=e.getDoc(),s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(ye.os.isMacOS()||ye.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"\u2318+")),e.notificationManager.open({text:o,type:"error"})}}})},S6=(e,t,n,s)=>{let o=C.fromDom(e.getRoot());return _a(o,N.fromRangeStart(t),s)?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),Aa(o,N.fromRangeEnd(t),s)?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},w6=e=>{if(typeof e!="string"){let t=L.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},k6=(e,t)=>{let n=e.selection,s=e.dom;return/^ | $/.test(t)?S6(s,n.getRng(),t,e.schema):t},gc=(e,t)=>{if(e.selection.isEditable()){let{content:n,details:s}=w6(t);Rd(e,we(Q({},s),{content:k6(e,n),format:"html",set:!1,selection:!0})).each(o=>{let r=wU(e,o.content,s);Td(e,r,o),e.addVisual()})}},_6=e=>{e.editorCommands.addCommands({mceCleanup:()=>{let t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{gc(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{gc(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{gc(e,s)},mceInsertContent:(t,n,s)=>{gc(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(OP(e))}})},A6={"font-size":"size","font-family":"face"},x6=Mr("font"),N6=(e,t,n)=>{let s=r=>Ei(r,e).orThunk(()=>x6(r)?Fe(A6,e).bind(a=>ss(r,a)):m.none()),o=r=>Se(C.fromDom(t),r);return ou(C.fromDom(n),r=>s(r),o)},R6=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),T6=(e,t)=>m.from(xe.DOM.getStyle(t,e,!0)),E_=e=>(t,n)=>m.from(n).map(C.fromDom).filter(Ht).bind(s=>N6(e,t,s.dom).or(T6(e,s.dom))).getOr(""),D6=E_("font-size"),P6=Tn(R6,E_("font-family")),B6=e=>ht(e.getBody()).bind(t=>{let n=t.container();return m.from(F(n)?n.parentNode:n)}),O6=e=>m.from(e.selection.getRng()).bind(t=>{let n=e.getBody();return t.startContainer===n&&t.startOffset===0?m.none():m.from(e.selection.getStart(!0))}),I6=(e,t)=>O6(e).orThunk(G(B6,e)).map(C.fromDom).filter(Ht).bind(t),Ym=(e,t)=>I6(e,lg(m.some,t)),S_=(e,t)=>{if(/^[0-9.]+$/.test(t)){let n=parseInt(t,10);if(n>=1&&n<=7){let s=XP(e),o=ZP(e);return o.length>0?o[n-1]||t:s[n-1]||t}else return t}else return t},F6=e=>{let t=e.split(/\s*,\s*/);return be(t,n=>n.indexOf(" ")!==-1&&!(Qe(n,'"')||Qe(n,"'"))?`'${n}'`:n).join(",")},L6=(e,t)=>{let n=S_(e,t);e.formatter.toggle("fontname",{value:F6(n)}),e.nodeChanged()},$6=e=>Ym(e,t=>P6(e.getBody(),t.dom)).getOr(""),M6=(e,t)=>{e.formatter.toggle("fontsize",{value:S_(e,t)}),e.nodeChanged()},U6=e=>Ym(e,t=>D6(e.getBody(),t.dom)).getOr(""),z6=e=>Ym(e,t=>{let n=C.fromDom(e.getBody()),s=ou(t,r=>Ei(r,"line-height"),G(Se,n)),o=()=>{let r=parseFloat(Ln(t,"line-height")),a=parseFloat(Ln(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),H6=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},W6=e=>{let t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{L6(e,o)},FontSize:(n,s,o)=>{M6(e,o)},LineHeight:(n,s,o)=>{H6(e,o)},Lang:(n,s,o)=>{var r;t(n,{value:o.code,customValue:(r=o.customCode)!==null&&r!==void 0?r:null})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(ee(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},V6=e=>{let t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>$6(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>U6(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>z6(e))},j6=e=>{W6(e),V6(e)},q6=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},K6=e=>{e.editorCommands.addCommands({Indent:()=>{TW(e)},Outdent:()=>{N0(e)}}),e.editorCommands.addCommands({Outdent:()=>k0(e)},"state")},G6=e=>{let t=(n,s,o)=>{if(e.mode.isReadOnly())return;let r=ee(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");ot(r)&&ee(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){let n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")}},mceInsertLink:t,createLink:t})},Y6=(e,t,n,s)=>{let o=e.dom,r=i=>o.isBlock(i)&&i.parentElement===n,a=r(t)?t:o.getParent(s,r,n);return m.from(a).map(C.fromDom)},w_=(e,t)=>{if(e.mode.isReadOnly())return;let n=e.dom,s=e.selection.getRng(),o=t?e.selection.getStart():e.selection.getEnd(),r=t?s.startContainer:s.endContainer,a=Ka(n,r);if(!a||!a.isContentEditable)return;let i=t?Bt:ts,l=pt(e);Y6(e,o,a,r).each(c=>{let u=Kw(e,r,c.dom,a,!1,l);i(c,C.fromDom(u)),e.selection.setCursorLocation(u,0),e.dispatch("NewBlock",{newBlock:u}),qa(e,"insertParagraph")})},X6=e=>w_(e,!0),Z6=e=>w_(e,!1),Q6=e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{X6(e)},InsertNewBlockAfter:()=>{Z6(e)}})},J6=e=>{e.editorCommands.addCommands({insertParagraph:()=>{sc(Zw,e)},mceInsertNewLine:(t,n,s)=>{ok(e,s)},InsertLineBreak:(t,n,s)=>{sc(ek,e)}})},e5=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>q(r)&&o++===s?(e.selection.select(r),!1):!0,e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{let t=e.dom.getParent(e.selection.getStart(),cn);if(t){let n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},t5=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{let o=s??e.selection.getNode();if(o!==e.getBody()){let r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{G1(e,s===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},n5=e=>{v6(e),E6(e),q6(e),e5(e),_6(e),G6(e),K6(e),Q6(e),J6(e),j6(e),t5(e)},s5=["toggleview"],k_=e=>ke(s5,e.toLowerCase());class __{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,s,o){let r=this.editor,a=t.toLowerCase(),i=o?.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():_1(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;let c=this.commands.exec[a];return _e(c)?(c(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(!k_(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;let n=t.toLowerCase(),s=this.commands.state[n];return _e(s)?s(n):!1}queryCommandValue(t){if(!k_(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";let n=t.toLowerCase(),s=this.commands.value[n];return _e(s)?s(n):""}addCommands(t,n="exec"){let s=this.commands;Ne(t,(o,r)=>{D(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){let o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s??this.editor,a,i)}queryCommandSupported(t){let n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s??this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s??this.editor)}}let o5=L.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class Xm{static isNative(t){return!!o5[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||Oe}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){let s=t.toLowerCase(),o=xu(s,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);let r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){let l=r[a];if(!l.removed){if(l.once&&this.off(s,l.func),o.isImmediatePropagationStopped())return o;if(l.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=Oe),n){let r={func:n,removed:!1};o&&L.extend(r,o);let a=t.toLowerCase().split(" "),i=a.length;for(;i--;){let l=a[i],c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),s?c=[r,...c]:c=[...c,r],this.bindings[l]=c}}return this}off(t,n){if(t){let s=t.toLowerCase().split(" "),o=s.length;for(;o--;){let r=s[o],a=this.bindings[r];if(!r)return Ne(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(!n)a.length=0;else{let i=_o(a,l=>l.func===n);a=i.fail,this.bindings[r]=a,D(i.pass,l=>{l.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Ne(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){t=t.toLowerCase();let n=this.bindings[t];return!(!n||n.length===0)}}let ei=e=>(e._eventDispatcher||(e._eventDispatcher=new Xm({scope:e,toggleEvent:(t,n)=>{Xm.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),Zm={fire(e,t,n){return console.warn('The "fire" event api has been deprecated and will be removed in TinyMCE 9. Use "dispatch" instead.',new Error().stack),this.dispatch(e,t,n)},dispatch(e,t,n){let s=this;if(s.removed&&e!=="remove"&&e!=="detach")return xu(e.toLowerCase(),t??{},s);let o=ei(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent?r.parent():void 0}return o},on(e,t,n){return ei(this).on(e,t,n)},off(e,t){return ei(this).off(e,t)},once(e,t){return ei(this).once(e,t)},hasEventListeners(e){return ei(this).has(e)}},pc=xe.DOM,So,hc=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;let n=Ab(e);return n?(e.eventRoot||(e.eventRoot=pc.select(n)[0]),e.eventRoot):e.getBody()},r5=e=>!e.hidden&&!cs(e),A_=(e,t,n)=>{r5(e)?e.dispatch(t,n):cs(e)&&jz(e,n)},x_=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;let n=hc(e,t);if(Ab(e)){if(So||(So={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||So&&(Ne(So,(o,r)=>{e.dom.unbind(hc(e,r))}),So=null)})),So[t])return;let s=o=>{let r=o.target,a=e.editorManager.get(),i=a.length;for(;i--;){let l=a[i].getBody();(l===r||pc.isChildOf(r,l))&&A_(a[i],t,o)}};So[t]=s,pc.bind(n,t,s)}else{let s=o=>{A_(e,t,o)};pc.bind(n,t,s),e.delegates[t]=s}},N_=we(Q({},Zm),{bindPendingEventDelegates(){let e=this;L.each(e._pendingNativeEvents,t=>{x_(e,t)})},toggleNativeEvent(e,t){let n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?x_(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(hc(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){let e=this,t=e.getBody(),n=e.dom;e.delegates&&(Ne(e.delegates,(s,o)=>{e.dom.unbind(hc(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),a5=e=>ee(e)?{value:e.split(/[ ,]/),valid:!0}:zs(e,ee)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},i5=e=>{let t=(()=>{switch(e){case"array":return Be;case"boolean":return Rn;case"function":return _e;case"number":return ln;case"object":return ot;case"string":return ee;case"string[]":return a5;case"object[]":return n=>zs(n,ot);case"regexp":return n=>ii(n,RegExp);default:return He}})();return n=>Qm(n,t,`The value must be a ${e}.`)},l5=e=>ee(e.processor),R_=(e,t)=>{let n=Dr(t.message)?"":`. ${t.message}`;return e+n},T_=e=>e.valid,Qm=(e,t,n="")=>{let s=t(e);return Rn(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},c5=(e,t,n)=>{if(!rt(t)){let s=Qm(t,n);if(T_(s))return s.value;console.error(R_(`Invalid default value passed for the "${e}" option`,s))}},u5=(e,t,n=t)=>{let s={},o={},r=(g,h,p)=>{let b=Qm(h,p);return T_(b)?(o[g]=b.value,!0):(console.warn(R_(`Invalid value passed for the ${g} option`,b)),!1)},a=(g,h)=>{let p=l5(h)?i5(h.processor):h.processor,b=c5(g,h.default,p);s[g]=we(Q({},h),{default:b,processor:p}),Fe(o,g).orThunk(()=>Fe(t,g)).each(v=>r(g,v,p))},i=g=>oe(s,g);return{register:a,isRegistered:i,get:g=>Fe(o,g).orThunk(()=>Fe(s,g).map(h=>h.default)).getOrUndefined(),set:(g,h)=>{if(i(g)){let p=s[g];return p.immutable?(console.error(`"${g}" is an immutable option and cannot be updated`),!1):r(g,h,p.processor)}else return console.warn(`"${g}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:g=>{let h=i(g);return h&&delete o[g],h},isSet:g=>oe(o,g),debug:()=>{try{console.log(JSON.parse(JSON.stringify(n,(g,h)=>Rn(h)||ln(h)||ee(h)||yt(h)||Be(h)||li(h)?h:Object.prototype.toString.call(h))))}catch(g){console.error(g)}}}},f5=(e,t)=>{e.dom.contentEditable=t?"true":"false"},d5=(e,t)=>{let n=C.fromDom(e.getBody());t?(e.readonly=!0,e.hasEditableRoot()&&f5(n,!0),iS(e)):(e.readonly=!1,lS(e))},gr=e=>e.readonly,m5=e=>{let t=e.undoManager.add();U(t)&&(e.undoManager.undo(),e.undoManager.reset())},g5=e=>Ie(e,t=>t.type==="characterData"||t.type==="childList"),p5=e=>{let t=s=>{gr(e)&&g5(s)&&m5(e)},n=new MutationObserver(t);e.on("beforeinput paste cut dragend dragover draggesture dragdrop drop drag",s=>{gr(e)&&s.preventDefault()}),e.on("BeforeExecCommand",s=>{(s.command==="Undo"||s.command==="Redo")&&gr(e)&&s.preventDefault()}),e.on("compositionstart",()=>{gr(e)&&n.observe(e.getBody(),{characterData:!0,childList:!0,subtree:!0})}),e.on("compositionend",()=>{if(gr(e)){let s=n.takeRecords();t(s)}n.disconnect()})},h5=["design","readonly"],D_=(e,t,n,s)=>{let o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&d5(e,r.editorReadOnly),t.set(s),pD(e,s)},b5=(e,t,n,s)=>{if(!(s===n.get()||e.initialized&&cs(e))){if(!oe(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?D_(e,n,t,s):e.on("init",()=>D_(e,n,t,s))}},C5=(e,t,n)=>{if(ke(h5,t))throw new Error(`Cannot override default mode ${t}`);return we(Q({},e),{[t]:we(Q({},n),{deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}})})},y5=e=>{let t=nt("design"),n=nt({design:{activate:ce,deactivate:ce,editorReadOnly:!1},readonly:{activate:ce,deactivate:ce,editorReadOnly:!0}});return p5(e),Kz(e),{isReadOnly:()=>gr(e),set:s=>b5(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(C5(n.get(),s,o))}}},Jm=L.each,eg=L.explode,v5={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},P_=L.makeMap("alt,ctrl,shift,meta,access"),E5=e=>e in P_,S5=e=>{let t={},n=ye.os.isMacOS()||ye.os.isiOS();Jm(eg(e.toLowerCase(),"+"),r=>{E5(r)?t[r]=!0:/^[0-9]{2,}$/.test(r)?t.keyCode=parseInt(r,10):(t.charCode=r.charCodeAt(0),t.keyCode=v5[r]||r.toUpperCase().charCodeAt(0))});let s=[t.keyCode],o;for(o in P_)t[o]?s.push(o):t[o]=!1;return t.id=s.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class B_{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;let n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(Jm(n.shortcuts,o=>{n.matchShortcut(s,o)&&(n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o))}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){let r=this,a=r.normalizeCommandFunc(s);return Jm(eg(L.trim(t)),i=>{let l=r.createShortcut(i,n,a,o);r.shortcuts[l.id]=l}),!0}remove(t){let n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){let n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:L.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){let r=L.map(eg(t,">"),S5);return r[r.length-1]=L.extend(r[r.length-1],{func:s,scope:o||this.editor}),L.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}let w5=()=>{let e=i8();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,addContext:e.addContext,getAll:e.getAll}},wo=xe.DOM,O_=L.extend,k5=L.each;class bc{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,O_(this,N_);let o=this;this.id=t,this.hidden=!1;let r=h6(s.defaultOptions,n);this.options=u5(o,r,n),OD(o);let a=this.options.get;a("deprecation_warnings")&&uz(n,r);let i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;let l=a("base_url");l&&s._setBaseUrl(l),this.baseUri=s.baseURI;let c=Gu(o);c&&(is.ScriptLoader._setReferrerPolicy(c),xe.DOM.styleSheetLoader._setReferrerPolicy(c));let u=Nb(o);U(u)&&xe.DOM.styleSheetLoader._setContentCssCors(u),vt.languageLoad=a("language_load"),vt.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new dn(bb(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Xu(o),this.hasVisual=wP(o),this.shortcuts=new B_(this),this.editorCommands=new __(this),n5(this);let f=a("cache_suffix");f&&(ye.cacheSuffix=f.replace(/^[\?\&]+/,"")),this.ui={registry:w5(),styleSheetLoader:void 0,show:ce,hide:ce,setEnabled:ce,isEnabled:He},this.mode=y5(o),s.dispatch("SetupEditor",{editor:this});let d=_P(o);_e(d)&&d.call(o,o)}render(){t6(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return sr(this)}translate(t){return Sn.translate(t)}getParam(t,n,s){let o=this.options;return o.isRegistered(t)||(U(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:He,default:n})),!o.isSet(t)&&!rt(n)?n:o.get(t)}hasPlugin(t,n){return ke(ji(this),t)?n?ir.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){let t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(wo.show(t.getContainer()),wo.hide(t.id)),t.load(),t.dispatch("show"))}hide(){let t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(wo.hide(t.getContainer()),wo.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){let n=this,s=n.getElement();if(n.removed)return"";if(s){let o=we(Q({},t),{load:!0}),r=iu(s)?s.value:s.innerHTML,a=n.setContent(r,o);return o.no_events||n.dispatch("LoadContent",we(Q({},o),{element:s})),a}else return""}save(t={}){let n=this,s=n.getElement();if(!s||!n.initialized||n.removed)return"";let o=we(Q({},t),{save:!0,element:s}),r=n.getContent(o),a=we(Q({},o),{content:r});if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),r=a.content,iu(s))s.value=r;else{(t.is_removing||!n.inline)&&(s.innerHTML=r);let i=wo.getParent(n.id,"form");i&&k5(i.elements,l=>l.name===n.id?(l.value=r,!1):!0)}return a.element=o.element=s=null,a.set_dirty!==!1&&n.setDirty(!1),r}setContent(t,n){return Md(this,t,n)}getContent(t){return ZU(this,t)}insertContent(t,n){n&&(t=O_({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?Md(this,this.startContent,{format:"raw"}):Md(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){let n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){let t=this;return t.container||(t.container=t.editorContainer||wo.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=wo.get(this.id)),this.targetElm}getWin(){let t=this;if(!t.contentWindow){let n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){let t=this;if(!t.contentDocument){let n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;let s=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:s?.body)!==null&&n!==void 0?n:null}convertURL(t,n,s){let o=this,r=o.options.get,a=xP(o);if(_e(a))return a.call(o,t,s,!0,n);if(!r("convert_urls")||s==="link"||ot(s)&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0)return t;let i=new dn(t);return i.protocol!=="http"&&i.protocol!=="https"&&i.protocol!==""?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){b6(this,t)}setEditableRoot(t){n6(this,t)}hasEditableRoot(){return s6(this)}remove(){gz(this)}destroy(t){pz(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}let pr=xe.DOM,Cc=L.each,I_=!1,yc,Tt=[],vc=e=>{let t=e.type;Cc(Ls.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},F_=e=>{if(e!==I_){let t=xe.DOM;e?(t.bind(window,"resize",vc),t.bind(window,"scroll",vc)):(t.unbind(window,"resize",vc),t.unbind(window,"scroll",vc)),I_=e}},L_=e=>{let t=Tt;return Tt=se(Tt,n=>e!==n),Ls.activeEditor===e&&(Ls.activeEditor=Tt.length>0?Tt[0]:null),Ls.focusedEditor===e&&(Ls.focusedEditor=null),t.length!==Tt.length},_5=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(L_(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},A5=document.compatMode!=="CSS1Compat",Ls=we(Q({},Zm),{baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"7",minorVersion:"9.1",releaseDate:"2025-05-29",i18n:Sn,activeEditor:null,focusedEditor:null,setup(){let e=this,t="",n="",s=dn.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/"));let o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,n=o.suffix;else{let r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){let i=r[a].src||"";if(i==="")continue;let l=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){l.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){let a=document.currentScript.src;a.indexOf(".min")!==-1&&(n=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new dn(s).toAbsolute(t),e.documentBaseURL=s,e.baseURI=new dn(e.baseURL),e.suffix=n,$1(e)},overrideDefaults(e){let t=e.base_url;t&&this._setBaseUrl(t);let n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;let s=e.plugin_base_urls;s!==void 0&&Ne(s,(o,r)=>{vt.PluginManager.urls[r]=o})},init(e){let t=this,n,s=L.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(u,f)=>u.inline&&f.tagName.toLowerCase()in s,r=u=>{let f=u.id;return f||(f=Fe(u,"name").filter(d=>!pr.get(d)).getOrThunk(pr.uniqueId),u.setAttribute("id",f)),f},a=u=>{let f=e[u];if(f)return f.apply(t,[])},i=u=>ye.browser.isIE()||ye.browser.isEdge()?(Bl("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/7/support/#supportedwebbrowsers"),[]):A5?(Bl("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):ee(u.selector)?pr.select(u.selector):U(u.target)?[u.target]:[],l=u=>{n=u},c=()=>{let u=0,f=[],d,g=(h,p,b)=>{let y=new bc(h,p,t);f.push(y),y.on("init",()=>{++u===d.length&&l(f)}),y.targetElm=y.targetElm||b,y.render()};pr.unbind(window,"ready",c),a("onpageload"),d=pg(i(e)),L.each(d,h=>{_5(t.get(h.id))}),d=L.grep(d,h=>!t.get(h.id)),d.length===0?l([]):Cc(d,h=>{o(e,h)?Bl("Could not initialize inline editor on invalid inline target element",h):g(r(h),e,h)})};return pr.bind(window,"ready",c),new Promise(u=>{n?u(n):l=f=>{u(f)}})},get(e){return arguments.length===0?Tt.slice(0):ee(e)?Ze(Tt,t=>t.id===e).getOr(null):ln(e)&&Tt[e]?Tt[e]:null},add(e){let t=this,n=t.get(e.id);return n===e||(n===null&&Tt.push(e),F_(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),yc||(yc=s=>{let o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",yc))),e},createEditor(e,t){return this.add(new bc(e,t,this))},remove(e){let t=this,n;if(!e){for(let s=Tt.length-1;s>=0;s--)t.remove(Tt[s]);return}if(ee(e)){Cc(pr.select(e),s=>{n=t.get(s.id),n&&t.remove(n)});return}return n=e,yt(t.get(n.id))?null:(L_(n)&&t.dispatch("RemoveEditor",{editor:n}),Tt.length===0&&window.removeEventListener("beforeunload",yc),n.remove(),F_(Tt.length>0),n)},execCommand(e,t,n){var s;let o=this,r=ot(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){let a=n.options;new bc(r,a,o).render()}return!0}case"mceRemoveEditor":{let a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{let a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{Cc(Tt,e=>{e.save()})},addI18n:(e,t)=>{Sn.add(e,t)},translate:e=>Sn.translate(e),setActive(e){let t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new dn(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new dn(this.baseURL)}});Ls.setup();let x5=(()=>{let e=Jn(),t=r=>({items:r,types:Ut(r),getType:a=>Fe(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),$_=Math.min,hr=Math.max,Ec=Math.round,M_=(e,t,n)=>{let s=t.x,o=t.y,r=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(o+=l),c[1]==="r"&&(s+=i),c[0]==="c"&&(o+=Ec(l/2)),c[1]==="c"&&(s+=Ec(i/2)),c[3]==="b"&&(o-=a),c[4]==="r"&&(s-=r),c[3]==="c"&&(o-=Ec(a/2)),c[4]==="c"&&(s-=Ec(r/2)),br(s,o,r,a)},N5=(e,t,n,s)=>{for(let o=0;o<s.length;o++){let r=M_(e,t,s[o]);if(r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return s[o]}return null},R5=(e,t,n)=>br(e.x-t,e.y-n,e.w+t*2,e.h+n*2),T5=(e,t)=>{let n=hr(e.x,t.x),s=hr(e.y,t.y),o=$_(e.x+e.w,t.x+t.w),r=$_(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:br(n,s,o-n,r-s)},D5=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h,i=t.x+t.w,l=t.y+t.h,c=hr(0,t.x-s),u=hr(0,t.y-o),f=hr(0,r-i),d=hr(0,a-l);return s+=c,o+=u,n&&(r+=c,a+=u,s-=f,o-=d),r-=f,a-=d,br(s,o,r-s,a-o)},br=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),P5={inflate:R5,relativePosition:M_,findBestRelativePosition:N5,intersect:T5,clamp:D5,create:br,fromClientRect:e=>br(e.left,e.top,e.width,e.height)},B5=(e,t,n=1e3)=>{let s=!1,o=null,r=c=>(...u)=>{s||(s=!0,o!==null&&(window.clearTimeout(o),o=null),c.apply(null,u))},a=r(e),i=r(t);return{start:(...c)=>{!s&&o===null&&(o=window.setTimeout(()=>i.apply(null,c),n))},resolve:a,reject:i}},O5=(()=>{let e={},t={},n={};return{load:(l,c)=>{let u=`Script at URL "${c}" failed to load`,f=`Script at URL "${c}" did not call \`tinymce.Resource.add('${l}', data)\` within 1 second`;if(e[l]!==void 0)return e[l];{let d=new Promise((g,h)=>{let p=B5(g,h);t[l]=p.resolve,is.ScriptLoader.loadScript(c).then(()=>p.start(f),()=>p.reject(u))});return e[l]=d,d}},add:(l,c)=>{t[l]!==void 0&&(t[l](c),delete t[l]),e[l]=Promise.resolve(c),n[l]=c},has:l=>l in n,get:l=>n[l],unload:l=>{delete e[l],delete n[l]}}})(),I5=()=>(()=>{let e={},t=[],n={getItem:s=>{let o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})(),ti;try{let e="__storage_test__";ti=window.localStorage,ti.setItem(e,e),ti.removeItem(e)}catch{ti=I5()}var F5=ti;let L5={geom:{Rect:P5},util:{Delay:tn,Tools:L,VK:j,URI:dn,EventDispatcher:Xm,Observable:Zm,I18n:Sn,LocalStorage:F5,ImageUploader:aH},dom:{EventUtils:Js,TreeWalker:st,TextSeeker:to,DOMUtils:xe,ScriptLoader:is,RangeUtils:fo,Serializer:ZE,StyleSheetLoader:eh,ControlSelection:LC,BookmarkManager:Ea,Selection:XE,Event:Js.Event},html:{Styles:Au,Entities:Qs,Node:Et,Schema:ws,DomParser:rr,Writer:uy,Serializer:Ts},Env:ye,AddOnManager:vt,Annotator:xC,Formatter:bS,UndoManager:yS,EditorCommands:__,WindowManager:oS,NotificationManager:sS,EditorObservable:N_,Shortcuts:B_,Editor:bc,FocusManager:PC,EditorManager:Ls,DOM:xe.DOM,ScriptLoader:is.ScriptLoader,PluginManager:ir,ThemeManager:Co,ModelManager:ar,IconManager:Dl,Resource:O5,FakeClipboard:x5,trim:L.trim,isArray:L.isArray,is:L.is,toArray:L.toArray,makeMap:L.makeMap,each:L.each,map:L.map,grep:L.grep,inArray:L.inArray,extend:L.extend,walk:L.walk,resolve:L.resolve,explode:L.explode,_addCacheSuffix:L._addCacheSuffix},U_=L.extend(Ls,L5),$5=e=>{if(typeof ng=="object")try{ng.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(U_),$5(U_)})()});export default H5();
